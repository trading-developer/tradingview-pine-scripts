Script Name: X48 - Strategy - BreakOut & Consecutive (11in1) + Alert - V.1.2
Author: X4815162342
Description: ================== Read This First Before Use This Strategy ==============
 *********** Please be aware that this strategy is not a guarantee of success and may lead to losses.
*********** Trading involves risk and you should always do your own research before making any decisions.

 ================= Thanks Source Script and Explain This Strategy...
PineScript code:

Pine Script‚Ñ¢ strategy
X48 - Strategy | BreakOut & Consecutive (11in1) + Alert | V.1.2
//  This  source  code  is  subject  to  the  terms  of  the  Mozilla  Public  License  2.0  at  https://mozilla.org/MPL/2.0/
//  ¬©  X4815162342
//==================  Read  This  First  Before  Use  This  Strategy  ==============
//  ***********  Please  be  aware  that  this  strategy  is  not  a  guarantee  of  success  and  may  lead  to  losses.
//  ***********  Trading  involves  risk  and  you  should  always  do  your  own  research  before  making  any  decisions.
//  =================  Thanks  Source  Script  and  Explain  This  Strategy  ===================
//  This  Strategy  Are  Combine  [5]  Strategy  and  [8]  Indicators  [1]  Alert  Function  For  Systematric  Trading  User.
//  [3]  Strategy  List,  Thanks  For  Original  Source  Script  [1],[2]  From  Tradingview  Build-in  Script  [3]  From  fmzquant  Github
//  [3.1]  Channel  BreakOut  Strategy  :  Calculate  BreakOut  Zone  For  Buy  and  Sell.
//  [3.2]  Consecutive  Bars  UP/Down  Strategy  :  The  consecutive  bars  up/down  strategy  is  a  trading  strategy  used  to  identify  potential  buy  and  sell  signals  in  the  stock  market.  This  strategy  involves  looking  for  a  series  of  bars  (or  candles)  that  are  either  all  increasing  or  all  decreasing  in  price.  If  the  bars  are  all  increasing,  it  can  be  a  signal  to  buy,  and  if  the  bars  are  all  decreasing,  it  can  be  a  signal  to  sell.  This  strategy  can  be  used  on  any  timeframe,  from  a  daily  chart  to  an  intraday  chart.
//  [3.3]  15m  Range  Length  SD  :  Range  Of  High  and  Low  Candle  Price  and  Lookback  For  Calculate  Buy  and  Sell.
//  [3.4]  MA  Type  CrossOver  and  CrossUnder
//  [3.5]  MACD  CrossOver  and  CrossUnder
//  [8]  Indicators  Are  Simple  Source  Script  (Almost  I'm  Chating  With  CHAT-GPT  and  Convert  pinescript  V4  to  V5  again  for  complete  almost  script  and  combine  after)
//  [8.1]  SwingHigh  and  SwingLow  Plot  For  SL  (StopLoss  by  Last  Swing).
//  [8.2]  Engulfing  and  3  Candle  Engulfing  Plot.
//  [8.3]  Stochastic  RSI  for  Plot  and  Fill  Background  Paint  and  Plot  TEXT  For  BULL  and  BEAR  TREND.
//  [8.4]  MA  TYPE  MODE  are  plot  2  line  of  MA  Type  (EMA,  SMA,  HMA,  WMA,  VWMA)  for  Crossover  and  Crossunder.
//  [8.5]  Donchian  Fans  MODE  are  Plot  Dot  Line  With  Triangle  Degree  Bull  Trend  is  Green  Plot  and  Bear  Trend  is  Red  Plot.
//  [8.6]  Ichimoku  Cloud  Are  Plot  Cloud  A-B  For  Bull  and  Bear  Trend.
//  [8.7]  RSI  OB  and  OS  for  TEXT  PLOT  'OB'  ,  'OS'  you  will  know  after  OB  and  OS,  you  can  combo  with  other  indicators  that's  make  you  know  what's  the  similar  trend  look  like?
//  [8.8]  MACD  for  Plot  Diamond  when  MACD  >  0  and  MACD  <  0,  you  can  combo  with  other  indicators  that's  make  you  know  what's  the  similar  trend  look  like?
//  [1]  Alert  Can  Alert  Sent  When  Buy  and  Sell  or  TP  and  SL,  you  can  adjust  text  to  alert  sent  by  your  self  or  use  default  setting.
//  ==========  Let'e  Me  Explain  How  To  Use  This  Strategy  =============
//  ==========  Properties  Setting  ==========
//  Capital  :  Default  :  500  USDT  For  Alot  Of  People  Are  Beginner  Investor  =  It's  Capital  Your  Cash  For  Invertment
//  Ordersize  :  Default  Are  Setting  5%  /  Order  [It's  Mean  5%  From  1,000]  We  Call  Compounded
//  ==========  INPUT  Setting  ==========
//  First  Part  Use  Must  Choose  Checkbox  For  Use  [1]  of  [3]  Strategy  and  Choose  TP/SL  by  Swing  or  %  (can  chosoe  both)
//  In  Detail  Of  Setting  Are  Not  Too  Much,  Please  Read  The  Header  Of  Setting  Before  Change  The  Value
//  For  The  Indicator  In  List  You  Want  To  Add  Just  Check  ‚úÖ  From  MODE  Setting,  It's  Show  On  Your  Chart
//  You  Can  Custom  TP/SL  %  You  Want
//  ==========  #####  No  trading  strategy  is  guaranteed  to  be  100%  successful.  ######  =========
//  For  Example  In  My  Systematic  Trading
//  Select  1/3  Strategy  Setting  TP/SL  %  Match  With  Timeframe  TP  Long  Are  Not  Set  It's  Can  161.8  -  423.6%  but  Short  Position  Are  Not  Than  100%  Just  Fine  From  Your  Aset
//  Choose  Indicators  For  Make  Sure  Trend  and  Strategy  are  the  same  way  like  Strategy  are  Long  Position  but  MACD  and  Sto  background  is  bear.  that's  mean  this  time  not  open  position.
//  Donchian  Fans  is  Simple  Support  and  Ressistant  If  You  Don't  Know  How  To  Plot  That's,  This  indicator  plot  a  simple  for  you  ><.
//  Make  Sure  With  Engulfing  and  3  Candle  Engulfing  If  You  Don't  Know,  What's  The  Engulfing,  This  Indicator  are  plot  for  you  too  ><.
//  For  a  Big  Trend  You  can  use  Ichimoku  Cloud  For  Check  Trend,  Candle  Upper  Than  Cloud  or  Lower  Than  Cloud  for  Bull  and  Bear  Trend.
/////////notes////////////////////////////////////////
//  This  is  based  on  the  ATR  trailing  stop  indicator  //
//  width  addition  of  two  levels  of  stops  and                //
//  different  interpretation.                                                //
//  This  is  a  fast-reacting  system  and  is  better          //
//  suited  for  higher  volatility  markets                          //
//////////////////////////////////////////////////////
//  ==========  Confirm  Setting  ==========
//  1.  Confirm  by  MACD  >  0  and  <  0
//  2.  Confirm  by  Stochastic  RSI  Cross
//  3.  Confirm  by  MA  Type  Fast  >  Slow  or  <
//  4.  Confirm  by  Ichimoku  Tenkan  >  Kijun  or  <
//  ==========  TP/SL  Setting  ==========
//  1.  By  Swing  High  /  Low
//  2.  By  ATR  Trailing  Stop
//  3.  By  Callback  [%]  From  Last  H/L
//  4.  By  FIX  [%]  TP/SL
//  For  Forex  Setting  (For  Free  Swap  And  Commission  0  Only)
//  Capital  =  50$
//  Order  Size  =  1  Contract
//  Commission  =  0
//  Slippage  =  Average  Your  Spread  Broker
//  TP  =  0.0055%  -  0.0057%  (For  Forex  Use  Lot  For  Easy  TP  by  PNL  7-11  pip)
//  For  Cryptocurrency  Setting
//  Capital  =  100$
//  Order  Size  =  16.333  USDT
//  Commission  =  0.1  or  0.04
//@version=5
strategy("X48  -  Strategy  |  Channel  BreakOut  &  Consecutive  (17in1)  +  TL/TP/SL  |  V.2.10",  overlay=true,  calc_on_order_fills  =  true,  initial_capital  =  500,default_qty_type  =  strategy.percent_of_equity,  default_qty_value  =  5,  commission_type  =  strategy.commission.percent,  commission_value  =  0.1,  currency  =  currency.USDT,  slippage  =  1)
//================  SPOT  MODE  ==============
GRSPT  =  "===  üçÄüçÄüçÄ  SPOT  MODE  üçÄüçÄüçÄ  ==="
Spot_MODE  =  input.bool(defval  =  false,  title  =  "üçÄ  SPOT  MODE",  group  =  GRSPT)
//================  CHANNEL  BREAKOUT  SETTING  ===============
GRS  =  "==1Ô∏è‚É£2Ô∏è‚É£3Ô∏è‚É£4Ô∏è‚É£5Ô∏è‚É£  SELECT  [X]  STRATEGY  +  TAKE  PROFIT  &  STOP  LOSS  ?  +  CONFIRM  MODE  ?  5Ô∏è‚É£4Ô∏è‚É£3Ô∏è‚É£2Ô∏è‚É£1Ô∏è‚É£=="
GR1  =  "=====  1Ô∏è‚É£1Ô∏è‚É£1Ô∏è‚É£  CHANNEL  BREAKOUT  STRATEGY  1Ô∏è‚É£1Ô∏è‚É£1Ô∏è‚É£====="
BreakOut_MODE  =  input.bool(defval  =  true,  title  =  "1Ô∏è‚É£  CHANNEL  BREAKOUT  MODE",  group  =  GRS,  inline  =  "MainHEAD",  tooltip  =  "Use  Channel  BreakOut  Strategy")
GRCON  =  "=====üÖ∞Ô∏èüÖ±Ô∏è  CONFIRM  MODE  üÖ±Ô∏èüÖ∞Ô∏è====="
MACDConfirm_MODE  =  input.bool(defval  =  false,  title  =  "üÖ∞Ô∏è  MACD  CONFIRM  MODE",  group  =  GRCON,  tooltip  =  "Use  MACD  For  Confirm  Signal")
//StoConfirm_MODE  =  input.bool(defval  =  false,  title  =  "üÖ±Ô∏è  STOCHASTIC  CONFIRM  MODE",  group  =  GRCON,  tooltip  =  "Use  Stochastic  For  Confirm  Signal")
RSIConfirm_MODE  =  input.bool(defval  =  false,  title  =  "üâê  RSI  CONFIRM  MODE",  group  =  GRCON,  tooltip  =  "Use  Stochastic  For  Confirm  Signal")
MACross_MODE  =  input.bool(defval  =  false,  title  =  "üíØ  MA  CROSS  X  CONFIRM  MODE",  group  =  GRCON,  tooltip  =  "Use  MA  Type  Cross  For  Confirm  Signal")
IchiConfirm_MODE  =  input.bool(defval  =  false,  title  =  "üíÆ  ICHIMOKU  TENKAN&KIJUN  CROSS  X  CONFIRM  MODE",  group  =  GRCON,  tooltip  =  "Use  Ichimoku  Tenkan  &  Kijun  Cross  For  Confirm  Signal")
GRSUB  =  "=====üÜéüÜëüÖæÔ∏èüÜò  TP  &  SL  SELECT  MODE  üÜòüÖæÔ∏èüÜëüÜé====="
Swing_STOP  =  input.bool(title="üÜé  STOP  LOSS  BY  SWING  MODE",  defval=false,  group  =  GRSUB,  tooltip  =  'If  Mode  On  =  Use  Stop  Loss  By  Last  Swing',  inline  =  "SubMAIN")
plotcolor  =  input.bool(defval  =  false,  title  =  'üÜë  ATR  Trailing  Stop',  group  =  GRSUB)
BOTrail_MODE  =  input.bool(defval  =  false,  title  =  "üÖæÔ∏è  CALLBACK  Trailing  Stop  [Low  Profit  But  More  TP]",  group  =  GRSUB,  tooltip  =  "BreakOut  Length  For  Who's  Want  Fast  Trailing  But  ThisLowProfitButMoreTimeForTP\nIt'sCanComboWithBreakoutand15m")
GRATR="‚≠ê‚≠êVoltyForex&AdaptiveATRVolumeSetting‚≠ê‚≠ê"
Forex_mode=input.bool(defval=false,title="üíµüíïVoltyForexModeOnly&Commission=0Only",tooltip="ForexMode&Commission=0Only&IntitialCap=10,000&OrderSize=100%",group=GRATR)
volty_mode=input.bool(defval=false,title="‚≠êAdaptiveATRVoltyMODEForCryptoCurrency",tooltip="ForForexLotPumpCommission=0,CryptoCommission=0.1",group=GRATR)
Repeat_mode=input.bool(defval=false,title="üìåRepeatSignalAfterTP/SL‚ùåCan'tUseWithConfirmMODE‚ùå",tooltip="RepeatNewPositionAfterTPandSL",group=GRATR)
volty_conse=input.bool(defval=false,title="üéØConsecutiveBarsFilterForRepeatSignal",tooltip="ConsecutiveBarsFilterForSignalRepeatNewPositionAfterTPandSL",group=GRATR)
length=input.int(defval=5,title="AdaptiveATRCandleLength",minval=1,group=GRATR)
numATRs=input.float(defval=0.75,title="AdaptiveATRMultiply",minval=0.1,group=GRATR)
FastEMATR=input.int(defval=8,title="FASTAdaptiveATRLINE-AfterCalculate",minval=1,group=GRATR)
SlowEMATR=input.int(defval=32,title="SLOWAdaptiveATRLINE-AfterCalculate",minval=1,group=GRATR)
atrs=ta.sma(ta.tr,length)*numATRs
buycon=close+atrs
sellcon=close-atrs
newcon=(buycon-sellcon)+close
buysig=ta.ema(buycon,12)
sellsig=ta.ema(sellcon,12)
newsig=ta.ema(newcon,FastEMATR)
newsig2=ta.ema(newcon,SlowEMATR)
ATRLCondition=ta.crossover(newsig,newsig2)
ATRSCondition=ta.crossunder(newsig,newsig2)
L_Consecutive=close>close[1]andclose[1]>close[2]andclose[2]>close[3]
S_Consecutive=close<close[1]andclose[1]<close[2]andclose[2]<close[3]
LongRepeat=newsig>newsig2
ShortRepeat=newsig<newsig2
plot(volty_mode?newsig:na,"newsig",color=color.white,linewidth=1,style=plot.style_line)
plot(volty_mode?newsig2:na,"newsig2",color=color.blue,linewidth=1,style=plot.style_line)
plotshape(volty_mode?ATRLCondition:na,title="LongSig",style=shape.labelup,location=location.belowbar,color=color.lime,text="Buy",textcolor=color.blue)
plotshape(volty_mode?ATRSCondition:na,title="ShortSig",style=shape.labeldown,location=location.abovebar,color=color.red,text="Sell")
/////////////////////////////////////////////////////////////////////////////////////////////////////
Text_Alert_Future='{{strategy.order.alert_message}}'
copy_Fu=input(defval=Text_Alert_Future,title="AlertMessageforBOT",inline='00',group='‚ïêBotSetting‚ïê\n>>IfYouDontUseBotJustPassIt',tooltip='AlertForX48-BOT>CopyandPasteToAlertFunction')
passphrase=input.string(defval='1234',title='BotPass',group='‚ïêBotSetting‚ïê\n>>IfYouDontUseBotJustPassIt',tooltip='PassphraseMustBeSameasX48-BOT')
leveragex=input.int(125,title='leverage',group='‚ïêBotSetting‚ïê\n>>IfYouDontUseBotJustPassIt',tooltip='"NOTHING"todowithPositionsizeForCommandToX48-BOTOnly',minval=1)
longcommand=input.string(defval='AutoLong',title='BotLongCommand',group='‚ïêBotSetting‚ïê\n>>IfYouDontUseBotJustPassIt',tooltip='1.OpenLong\n2.AutoLong\n***IfAutoLong=Close(100%)First>OpenLongPositionAuto')
shortcommand=input.string(defval='AutoShort',title='BotShortCommand',group='‚ïêBotSetting‚ïê\n>>IfYouDontUseBotJustPassIt',tooltip='1.OpenShort\n2.AutoShort\n***IfAutoShort=Close(100%)First>OpenShortPositionAuto')
markettype=input.string(defval='bnfuture',title='Future/SpotCommand',group='‚ïêBotSetting‚ïê\n>>IfYouDontUseBotJustPassIt',tooltip='1.bnfuture=FUTUREMODE\n2.bnspot=SPOTMODE\n3.bncombo=EZ2in1Order')
////////////////StrategyAlertForX4815162342BOT//////////////////////
////////ForUseBotCanChangeThisCommandByYourSelf/////////////////////
stringAlert_OpenLong='{"ex":"'+markettype+'","side":"'+longcommand+'","amount":"@{{strategy.order.contracts}}","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'","tp":"25","sl":"0","tl":"0","callback":"0"}'
stringAlert_OpenShort='{"ex":"'+markettype+'","side":"'+shortcommand+'","amount":"@{{strategy.order.contracts}}","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'","tp":"25","sl":"0","tl":"0","callback":"0"}'
//stringAlert_LongTP='{"ex":"bnfuture","side":"CloseLong","amount":"@{{strategy.order.contracts}}","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//stringAlert_ShortTP='{"ex":"bnfuture","side":"CloseShort","amount":"@{{strategy.order.contracts}}","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//varmessage_closelong='{"ex":"bnfuture","side":"CloseLong","amount":"%100","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
//varmessage_closeshort='{"ex":"bnfuture","side":"CloseShort","amount":"%100","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'"}'
stringAlert_StopLosslong='{"ex":"'+markettype+'","side":"CloseLong","amount":"%100","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'","tp":"0","sl":"0","tl":"0","callback":"0"}'
stringAlert_StopLossshort='{"ex":"'+markettype+'","side":"CloseShort","amount":"%100","symbol":"{{ticker}}","passphrase":"'+passphrase+'","leverage":"'+str.tostring(leveragex)+'","tp":"0","sl":"0","tl":"0","callback":"0"}'
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////
PLOTBO_MODE=input.bool(title="[PLOT]BreakOutLINE[PLOT]",defval=false,group=GR1)
lengthBO=input.int(title="1Ô∏è‚É£LengthBreakOut",minval=1,maxval=1000,defval=5,group=GR1)
triling_BO=input.float(title="üÖæÔ∏èBreakOutTrailingCALLBACK[%]",defval=25,minval=0.01,maxval=999.99,group=GR1,tooltip="BinanceCallback=5%,NowYouCanCustomizeYourCallback><")
upBound=ta.highest(high,lengthBO)
downBound=ta.lowest(low,lengthBO)
SL_LongBO=(close<(upBound-((upBound*triling_BO)/100)))
SL_ShortBO=(close>(downBound+((downBound*triling_BO)/100)))
pvthi_BO=upBound
pvtlo_BO=downBound
ShuntBO=1//Waitforclosebeforeprintingpivot?1fortrue0forflase
maxLvlLenBO=0//MaximumExtensionLength
pvthiBO=pvthi_BO[ShuntBO]
pvtloBO=pvtlo_BO[ShuntBO]
//CountHowmanycandlesforcurrentPivotLevel,Ifnewreset.
counthiBO=ta.barssince(notna(pvthiBO))
countloBO=ta.barssince(notna(pvtloBO))
pvthisBO=fixnan(pvthiBO)
pvtlosBO=fixnan(pvtloBO)
hipcBO=ta.change(pvthisBO)!=0?na:color.lime
lopcBO=ta.change(pvtlosBO)!=0?na:color.red
//DisplayPivotlines
plot(PLOTBO_MODE?maxLvlLenBO==0orcounthiBO<maxLvlLenBO?pvthisBO:na:na,color=hipcBO,linewidth=2,title='TopLevelsBO')
plot(PLOTBO_MODE?maxLvlLenBO==0orcountloBO<maxLvlLenBO?pvtlosBO:na:na,color=lopcBO,linewidth=2,title='BottomLevelsBO')
ifBOTrail_MODE==true
ifSpot_MODE==false
ifSL_LongBOandstrategy.position_size>0
strategy.close("Long",qty_percent=100,comment="‚ùáÔ∏èCALLBACK‚ùáÔ∏è")
ifSL_ShortBOandstrategy.position_size<0
strategy.close("Short",qty_percent=100,comment="‚ùáÔ∏èCALLBACK‚ùáÔ∏è")
ifSpot_MODE==true
ifSL_LongBOandstrategy.position_size>0
strategy.close("Long",qty_percent=100,comment="‚ùáÔ∏èCALLBACK‚ùáÔ∏è")
//================ConsecutiveUP/Down===============
GR2="=====2Ô∏è‚É£2Ô∏è‚É£2Ô∏è‚É£ConsecutiveUp/DownStrategy2Ô∏è‚É£2Ô∏è‚É£2Ô∏è‚É£====="
Consecutive_MODE=input.bool(defval=false,title="2Ô∏è‚É£CONSECUTIVEBarsUP/DOWNMODE",group=GRS,tooltip="UseConsecutiveStrategy")
consecutiveBarsUp=input.int(defval=3,title='2Ô∏è‚É£ConsecutiveBarsUp',minval=1,group=GR2)
consecutiveBarsDown=input.int(defval=3,title='2Ô∏è‚É£ConsecutiveBarsDown',minval=1,group=GR2)
price=close
ups=0.0
ups:=price>price[1]?nz(ups[1])+1:0
dns=0.0
dns:=price<price[1]?nz(dns[1])+1:0
//=============15mBREAKRANGEGOLDANDCRYPTO===============
GR3="=====3Ô∏è‚É£3Ô∏è‚É£3Ô∏è‚É£15mBREAKRANGESTRATEGY3Ô∏è‚É£3Ô∏è‚É£3Ô∏è‚É£====="
hlrang_mode=input.bool(defval=false,title="3Ô∏è‚É£15mHigh/LowRangeBreakMODE[BUYONLY]",group=GRS)
hlrang_plot=input.bool(defval=false,title="[PLOT]15mHigh/LowRangeBreak[PLOT]",group=GR3)
rrange=high-low
lookback=input.int(2,minval=1,title="3Ô∏è‚É£15m-Lookback",group=GR3)
xr=input.int(10,minval=1,title="3Ô∏è‚É£15m-RangeLength",group=GR3)
mult=input.float(2.0,minval=0.001,maxval=50,title="15m-SD",group=GR3)
computation=mult*ta.stdev(rrange,xr)+ta.sma(rrange,xr)
cond1=rrange>computation
plot(hlrang_plot?rrange:na,title="RangeH-L",style=plot.style_columns)
plot(hlrang_plot?computation:na,title="H-LSD",style=plot.style_line,color=color.orange)
plot(hlrang_plot?close-close[lookback]:na,title="CloseDirection",color=close>close[lookback]?color.green:color.red,style=plot.style_histogram)
longCondition15=hlrang_mode?cond1andclose>close[lookback]:na
shortCondition15=hlrang_mode?cond1andclose<close[lookback]:na
//==============SwingHighandLowMode===============
//SwingPlot
//Swing_MODE=input.bool(title="PLOTSWINGMODE",defval=true,group='=SWINGSETTING=',tooltip='IfModeOn=PlotSwingHighandSwingLow')
pvtLenL=input.int(3,minval=1,title='üÜéPivotLengthLeftHandSide',group='==üÜéüÜéüÜéTP/SLSWINGSETTINGüÜéüÜéüÜé==')
pvtLenR=input.int(3,minval=1,title='üÜéPivotLengthRightHandSide',group='==üÜéüÜéüÜéTP/SLSWINGSETTINGüÜéüÜéüÜé==')
//GetHighandLowPivotPoints
pvthi_=ta.pivothigh(high,pvtLenL,pvtLenR)
pvtlo_=ta.pivotlow(low,pvtLenL,pvtLenR)
//ForcePivotcompletionbeforeplotting.
Shunt=1//Waitforclosebeforeprintingpivot?1fortrue0forflase
maxLvlLen=0//MaximumExtensionLength
pvthi=pvthi_[Shunt]
pvtlo=pvtlo_[Shunt]
//CountHowmanycandlesforcurrentPivotLevel,Ifnewreset.
counthi=ta.barssince(notna(pvthi))
countlo=ta.barssince(notna(pvtlo))
pvthis=fixnan(pvthi)
pvtlos=fixnan(pvtlo)
hipc=ta.change(pvthis)!=0?na:color.maroon
lopc=ta.change(pvtlos)!=0?na:color.green
//DisplayPivotlines
plot(Swing_STOP?maxLvlLen==0orcounthi<maxLvlLen?pvthis:na:na,color=hipc,linewidth=1,offset=-pvtLenR-Shunt,title='TopLevels')
plot(Swing_STOP?maxLvlLen==0orcountlo<maxLvlLen?pvtlos:na:na,color=lopc,linewidth=1,offset=-pvtLenR-Shunt,title='BottomLevels')
plot(Swing_STOP?maxLvlLen==0orcounthi<maxLvlLen?pvthis:na:na,color=hipc,linewidth=1,offset=0,title='TopLevels2')
plot(Swing_STOP?maxLvlLen==0orcountlo<maxLvlLen?pvtlos:na:na,color=lopc,linewidth=1,offset=0,title='BottomLevels2')
stopswinglow=ta.crossunder(close,pvtlos)
stopswinghigh=ta.crossover(close,pvthis)
ifSwing_STOP==true
ifSpot_MODE==false
if(close<pvtlos)
strategy.close("Long",qty_percent=100,comment="StopLongüè≥Ô∏èSwLow",alert_message=Alert_StopLosslong)
if(close>pvthis)
strategy.close("Short",qty_percent=100,comment="StopShortüè≥Ô∏èSwHi",alert_message=Alert_StopLossshort)
ifSpot_MODE==true
if(close<pvtlos)
strategy.close("Long",qty_percent=100,comment="StopLongüè≥Ô∏èSwLow",alert_message=Alert_StopLosslong)
engulfing_mode=input.bool(title="NormalEngulfingSignal",defval=false,group="==ENGULFINGSIGNAL==",inline='9')
threeengulfing_mode=input.bool(title="3CandleEngulfingSignal",defval=false,group="==ENGULFINGSIGNAL==",inline='9')
//bullishengulfing(Bueng)
Bueng=open[3]>close[3]andopen[2]>close[2]andopen[1]>close[1]andclose>openand(close>=open[1]orclose[1]>=open)andclose-open>open[1]-close[1]
plotshape(threeengulfing_mode?Bueng:na,style=shape.diamond,location=location.belowbar,color=color.new(#00e926,0),size=size.small,text="3Engulfing",textcolor=color.new(#4eff64,0))
//bearishengulfing(Beeng)
Beeng=open[3]<close[3]andopen[2]<close[2]andclose[1]>open[1]andopen>closeand(open>=close[1]oropen[1]>=close)andopen-close>close[1]-open[1]
plotshape(threeengulfing_mode?Beeng:na,style=shape.diamond,location=location.abovebar,color=color.new(#ff571b,0),size=size.small,text="3Engulfing",textcolor=color.new(#ff5a9b,0))
//bullishengulfing(Bueng)
Bueng2=open[3]>close[3]?open[2]>close[2]?open[1]>close[1]?close>open?close>=open[1]?close[1]>=open?close-open>open[1]-close[1]?color.blue:na:na:na:na:na:na:na
barcolor(threeengulfing_mode?Bueng2:na)
//bearishengulfing(Beeng)
Beeng2=open[3]<close[3]?open[2]<close[2]?close[1]>open[1]?open>close?open>=close[1]?open[1]>=close?open-close>close[1]-open[1]?color.white:na:na:na:na:na:na:na
barcolor(threeengulfing_mode?Beeng2:na)
///////////////////////////////////////////////////////////////////////////////////
//GRSTO="==üÖ±Ô∏èüÖ±Ô∏èüÖ±Ô∏èSTOCHASTICRSISETTING[BG/Confirm]üÖ±Ô∏èüÖ±Ô∏èüÖ±Ô∏è=="
//stobg_mode=input.bool(title="StochasticRSIBackgroundPaint",defval=false,group=GRSTO)
//stobg_plot=input.bool(title="STO-TEXT",defval=false,group=GRSTO,inline='STOT1')
//stobull_text=input.color(title='BULL',defval=color.white,group=GRSTO,inline='STOT1')
//stobear_text=input.color(title='BEAR',defval=color.orange,group=GRSTO,inline='STOT1')
//lengthMACD=input(title='üÖ±Ô∏èLength',defval=21,group=GRSTO,inline='15')
//offsetMACD=input(title='üÖ±Ô∏èOffset',defval=0,group=GRSTO,inline='15')
//srcMACD=input(close,title='üÖ±Ô∏èSource',group=GRSTO,inline='16')
//length2MACD=input(title='üÖ±Ô∏èTriggerLength',defval=6,group=GRSTO,inline='16')
//bullstobg=input.color(title='BullBGColor',defval=color.green,group=GRSTO,inline='STOBG1')
//bearstobg=input.color(title='BearBGColor',defval=color.red,group=GRSTO,inline='STOBG1')
//transstobg=input.int(defval=75,title='Trans',minval=0,maxval=100,group=GRSTO,inline='STOBG1')
//
//lsma=ta.linreg(srcMACD,lengthMACD,offsetMACD)
//lsma2=ta.linreg(lsma,lengthMACD,offsetMACD)
//b=lsma-lsma2
//zlsma2=lsma+b
//trig2=ta.sma(zlsma2,length2MACD)
//
//c1=zlsma2>trig2?bullstobg:bearstobg
//stobull=ta.crossover(zlsma2,trig2)
//stobear=ta.crossunder(zlsma2,trig2)
//stobullplus=zlsma2>trig2
//stobearplus=zlsma2<trig2
//plotshape(stobg_plot?stobull:na,title='STO-BULL',text='STO-BULL',location=location.belowbar,textcolor=stobull_text,size=size.tiny)
//plotshape(stobg_plot?stobear:na,title='STO-BULL',text='STO-BEAR',location=location.abovebar,textcolor=stobear_text,size=size.tiny)
//
//p1=plot(stobg_mode?zlsma2:na,color=c1,linewidth=0)
//p2=plot(stobg_mode?trig2:na,color=c1,linewidth=0)
//fill(p1,p2,color=color.new(c1,transp=transstobg))
//bullishengulfing
bullishEngulfing=open[1]>close[1]?close>open?close>=open[1]?close[1]>=open?close-open>open[1]-close[1]?color.purple:na:na:na:na:na
barcolor(engulfing_mode?bullishEngulfing:na)
//bearishengulfing
bearishEngulfing=close[1]>open[1]?open>close?open>=close[1]?open[1]>=close?open-close>close[1]-open[1]?color.yellow:na:na:na:na:na
barcolor(engulfing_mode?bearishEngulfing:na)
bullishEngulfing2=(open[1]>close[1]andclose>openandclose>=open[1]andclose[1]>=openandclose-open>open[1]-close[1])
bearishEngulfing2=(close[1]>open[1]andopen>closeandopen>=close[1]andopen[1]>=closeandopen-close>close[1]-open[1])
plotshape(engulfing_mode?bullishEngulfing2:na,style=shape.labelup,location=location.belowbar,color=color.yellow,size=size.auto,text='‚ÜóÔ∏è')
plotshape(engulfing_mode?bearishEngulfing2:na,style=shape.labeldown,location=location.abovebar,color=color.white,size=size.auto,text='‚ÜòÔ∏è')
////////////////////////////////////////////////////////////////////////////////////
GRMAC='===üíØüíØüíØ4Ô∏è‚É£MultiMASETTING4Ô∏è‚É£üíØüíØüíØ==='
MAStrategy_MODE=input.bool(title='4Ô∏è‚É£MACROSSXSTRATEGYMODE',defval=false,group=GRS)
MARepeat_Mode=input.bool(title='4Ô∏è‚É£üéØMACROSSXREPEATMODE',defval=false,group=GRS,tooltip="RepeatModeAfterTP/SLOpenPositionWithTrendFast>,<SlowAgain")
///////////NormalSetting////////////////
srcstrategy=input(close,title='üíØ4Ô∏è‚É£SourceMultiMA',group=GRMAC,tooltip='NormalLine=Close\nSmoothLine=ohlc4')
/////////////EMA/SMASETTING/////////////
pricestrategy=request.security(syminfo.tickerid,timeframe.period,srcstrategy)
fastSW=input.bool(title='ShowFastMALine',defval=false,group=GRMAC,inline='11')
fastcolor=input.color(color.new(color.red,0),group=GRMAC,inline='110',title='FastMAColor')
slowSW=input.bool(title='ShowSlowMALine',defval=false,group=GRMAC,inline='11')
slowcolor=input.color(color.new(color.yellow,0),group=GRMAC,inline='110',title='SlowMAColor')
ma1strategy=input(12,title='üíØ4Ô∏è‚É£FastMALength',group=GRMAC,inline='12')
type1strategy=input.string('EMA','FastMAType',options=['SMA','EMA','WMA','HMA','RMA','VWMA'],group=GRMAC,tooltip='SMA/EMA/WMA/HMA/RMA/VWMA',inline='12')
ma3strategy=input(26,title='üíØ4Ô∏è‚É£SlowMALength',group=GRMAC,inline='13')
type3strategy=input.string('EMA','SlowMAType',options=['SMA','EMA','WMA','HMA','RMA','VWMA'],group=GRMAC,tooltip='SMA/EMA/WMA/HMA/RMA/VWMA',inline='13')
price1strategy=switchtype1strategy
"EMA"=>ta.ema(pricestrategy,ma1strategy)
"SMA"=>ta.sma(pricestrategy,ma1strategy)
"WMA"=>ta.wma(pricestrategy,ma1strategy)
"HMA"=>ta.hma(pricestrategy,ma1strategy)
"RMA"=>ta.rma(pricestrategy,ma1strategy)
"VWMA"=>ta.vwma(pricestrategy,ma1strategy)

price3strategy=switchtype3strategy
"EMA"=>ta.ema(pricestrategy,ma3strategy)
"SMA"=>ta.sma(pricestrategy,ma3strategy)
"WMA"=>ta.wma(pricestrategy,ma3strategy)
"HMA"=>ta.hma(pricestrategy,ma3strategy)
"RMA"=>ta.rma(pricestrategy,ma3strategy)
"VWMA"=>ta.vwma(pricestrategy,ma3strategy)
FastL=plot(fastSW?price1strategy:na,'FastMA',color=fastcolor,style=plot.style_line,linewidth=2)
SlowL=plot(slowSW?price3strategy:na,'SlowMA',color=slowcolor,style=plot.style_line,linewidth=2)
BullMACross=ta.crossover(price1strategy,price3strategy)
BearMACross=ta.crossunder(price1strategy,price3strategy)
BullMAPlus=price1strategy>price3strategy
BearMAPlus=price1strategy<price3strategy
//*********BackgroundPaint***********************
prefillFast=plot(fastSW?price1strategy:na,'FastMA',color=color.new(color.red,100),style=plot.style_line,linewidth=2)
prefillSlow=plot(slowSW?price3strategy:na,'FastMA',color=color.new(color.yellow,100),style=plot.style_line,linewidth=2)
fcolor=price1strategy>price3strategy?color.new(color.lime,70):color.new(color.red,70)
fill(prefillFast,prefillSlow,color=fcolor,title='BACKGROUNDPAINT')
//**********************************************
//====================DONCHIANFANSMODE=====================
Donchian_MODE=input.bool(defval=false,title="DONCHIANFANSMODE",group="==DONCHIANFANSMODE==")
Donchian_Bollinger=input.bool(defval=false,title="DONCHIANBOLLINGERLINE",group="==DONCHIANFANSMODE==")
//Initiatebars:
varintbd=-1
bd+=1
//----------------------------------------------------------------------------------
//Requiredfunctions:
f_highest_bar(_source,_bars,_length)=>
float_h_value=_source
int_h_bar=_bars
for_i=0tomath.max(_length-1,0)by1
bool_isSourceOver=_source[_i]>_h_value
if_isSourceOver
_h_value:=_source[_i]
_h_bar:=_bars[_i]
_h_bar
[_h_value,_h_bar]
f_lowest_bar(_source,_bars,_length)=>
float_l_value=_source
int_l_bar=_bars
for_i=0tomath.max(_length-1,0)by1
bool_isSourceUnder=_source[_i]<_l_value
if_isSourceUnder
_l_value:=_source[_i]
_l_bar:=_bars[_i]
_l_bar
[_l_value,_l_bar]
f_line(_x1,_y1,_r,_color)=>
varline_li=na
line.delete(id=_li)
_li:=line.new(x1=_x1-1,y1=_y1-_r,x2=_x1,y2=_y1,xloc=xloc.bar_index,extend=extend.right,color=_color,style=line.style_dashed,width=1)
_li
//----------------------------------------------------------------------------------
intFANSlength=input.int(defval=100,title='FANSlength:',minval=1,group="==DONCHIANFANSMODE==")
[h_price,h_bar]=f_highest_bar(high,bd,FANSlength)
[l_price,l_bar]=f_lowest_bar(low,bd,FANSlength)
floatmid=(h_price+l_price)/2
plot(Donchian_Bollinger?h_price:na,title='H',color=color.new(color.white,20),linewidth=1,style=plot.style_line)
plot(Donchian_Bollinger?mid:na,title='M',color=color.new(color.white,20),linewidth=1,style=plot.style_line)
plot(Donchian_Bollinger?l_price:na,title='L',color=color.new(color.white,20),linewidth=1,style=plot.style_line)
varfloatr=ta.atr(FANSlength)
ifta.change(mid)!=0
r:=ta.atr(FANSlength)
r
varlineh_1_04=na
varlineh_1_08=na
varlineh_1_16=na
varlineh_1_32=na
varlineh_1_64=na
varlinel_1_04=na
varlinel_1_08=na
varlinel_1_16=na
varlinel_1_32=na
varlinel_1_64=na
boolis_new_h=h_price>h_price[1]
boolis_new_l=l_price<l_price[1]
vhb=ta.valuewhen(high>=h_price,h_bar,0)
vhp=ta.valuewhen(high>=h_price,h_price,0)
vlb=ta.valuewhen(low<=l_price,l_bar,0)
vlp=ta.valuewhen(low<=l_price,l_price,0)
ifis_new_landDonchian_MODE==true
h_1_04:=f_line(vhb,vhp,-r*(1./04.),color.red)
h_1_08:=f_line(vhb,vhp,-r*(1./08.),color.red)
h_1_16:=f_line(vhb,vhp,-r*(1./16.),color.red)
h_1_32:=f_line(vhb,vhp,-r*(1./32.),color.red)
h_1_64:=f_line(vhb,vhp,-r*(1./64.),color.red)
h_1_64
ifis_new_handDonchian_MODE==true
l_1_04:=f_line(vlb,vlp,r*(1./04.),color.lime)
l_1_08:=f_line(vlb,vlp,r*(1./08.),color.lime)
l_1_16:=f_line(vlb,vlp,r*(1./16.),color.lime)
l_1_32:=f_line(vlb,vlp,r*(1./32.),color.lime)
l_1_64:=f_line(vlb,vlp,r*(1./64.),color.lime)
l_1_64
//**********************************************
GRIC='===üíÆüíÆüíÆICHIMOKUSETTINGüíÆüíÆüíÆ==='
Ichi_Mode=input.bool(title="ICHIMOKUPLOTMODE",defval=false,group=GRIC)
tenkan_len=input(9,'üíÆTenkan‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ',inline='tenkan',group=GRIC,tooltip='TENKAN=FASTSIGNAL')
tenkan_mult=input(2.,'',inline='tenkan',group=GRIC)
kijun_len=input(26,'üíÆKijun‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ‚ÄÑ',inline='kijun',group=GRIC,tooltip='KIJUN=SLOWSIGNAL')
kijun_mult=input(4.,'',inline='kijun',group=GRIC)
spanB_len=input(52,'SenkouSpanA/B‚ÄÑ',inline='span',group=GRIC,tooltip='SENKOU=CLOUDSIGNAL')
spanB_mult=input(6.,'',inline='span',group=GRIC)
cloudacolor=input.color(defval=color.new(color.orange,20),title='CLOUD-A',inline='span1',group=GRIC)
cloudbcolor=input.color(defval=color.new(color.purple,20),title='CLOUD-B',inline='span1',group=GRIC)
chi_color=input.color(defval=color.new(#73ecff,0),title="Chikou-Color",group=GRIC,inline='CHIKOU')
offset=input(26,'Chikou',group=GRIC,tooltip='CHIKOU=CANDLELOOKBACKDEFAULT=26',inline='CHIKOU')
//------------------------------------------------------------------------------
avg(src,length,mult)=>
atr=ta.atr(length)*mult
up=hl2+atr
dn=hl2-atr
upper=0.,lower=0.
upper:=src[1]<upper[1]?math.min(up,upper[1]):up
lower:=src[1]>lower[1]?math.max(dn,lower[1]):dn

os=0,max=0.,min=0.
os:=src>upper?1:src<lower?0:os[1]
spt=os==1?lower:upper
max:=ta.cross(src,spt)?math.max(src,max[1]):os==1?math.max(src,max[1]):spt
min:=ta.cross(src,spt)?math.min(src,min[1]):os==0?math.min(src,min[1]):spt
math.avg(max,min)
//------------------------------------------------------------------------------
tenkan=avg(close,tenkan_len,tenkan_mult)
kijun=avg(close,kijun_len,kijun_mult)
senkouA=math.avg(kijun,tenkan)
senkouB=avg(close,spanB_len,spanB_mult)
//------------------------------------------------------------------------------
tenkan_css=color.white
kijun_css=#ff5d00
cloud_a=cloudacolor
cloud_b=cloudbcolor
chikou_css=color.new(#73ecff,20)
plot(Ichi_Mode?tenkan:na,'Tenkan-Sen',tenkan_css,style=plot.style_stepline,linewidth=2)
plot(Ichi_Mode?kijun:na,'Kijun-Sen',kijun_css,style=plot.style_stepline,linewidth=2)
plot(Ichi_Mode?ta.crossover(tenkan,kijun)?kijun:na:na,'Crossover',#2157f3,3,plot.style_circles)
plot(Ichi_Mode?ta.crossunder(tenkan,kijun)?kijun:na:na,'Crossunder',#ff5d00,3,plot.style_circles)
A=plot(Ichi_Mode?senkouA:na,'SenkouSpanA',na,offset=offset-1)
B=plot(Ichi_Mode?senkouB:na,'SenkouSpanB',na,offset=offset-1)
fill(A,B,senkouA>senkouB?cloud_a:cloud_b)
ichi_bull=ta.crossover(tenkan,kijun)
ichi_bear=ta.crossunder(tenkan,kijun)
ichi_bullplus=tenkan>kijun
ichi_bearplus=tenkan<kijun
plot(Ichi_Mode?close:na,'Chikou',chi_color,offset=-offset+1,linewidth=2)
////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////
GRCMA='==üÖ∞Ô∏èüÖ∞Ô∏è5Ô∏è‚É£5Ô∏è‚É£MACDSETTING[PLOT/Confirm]5Ô∏è‚É£5Ô∏è‚É£üÖ∞Ô∏èüÖ∞Ô∏è=='
MACDStrategy_MODE=input.bool(title='5Ô∏è‚É£MACDCROSS[0]STRATEGYMODE',defval=false,group=GRS)
MACDStrategy_Repeat=input.bool(title='5Ô∏è‚É£üéØMACDCROSS[0]REPEATMODE',defval=false,group=GRS,tooltip="RepeatModeAfterTP/SLOpenPositionWithTrendFast>,<SlowAgain")
MACD_MODE_SIG=input.bool(title="MACDMODE=MACDCrossSignal",defval=false,group=GRCMA,tooltip='IfModeOn=UseMACDStrategyforSignalWhenCrossUpandCrossDown')
//ifMACD_MODE_SIG==true
MACDfastLength=input(12,title='üÖ∞Ô∏è5Ô∏è‚É£MACDFast',group=GRCMA,inline='MACDSIG1')
MACDslowlength=input(26,title='üÖ∞Ô∏è5Ô∏è‚É£MACDSlow',group=GRCMA,inline='MACDSIG1')
MACDLength=input(18,title='üÖ∞Ô∏è5Ô∏è‚É£MACDLength',group=GRCMA)
macdupcolor=input.color(defval=color.new(color.green,0),title='CROSS-UP',inline='MACDCO',group=GRCMA)
macddowncolor=input.color(defval=color.new(color.red,0),title='CROSS-DOWN',inline='MACDCO',group=GRCMA)
MACD=ta.ema(close,MACDfastLength)-ta.ema(close,MACDslowlength)
aMACD=ta.ema(MACD,MACDLength)
delta=MACD-aMACD
macdTPl=(ta.crossover(delta,0))
macdTPs=(ta.crossunder(delta,0))
MACDBull=delta>0
MACDBear=delta<0
plotshape(MACD_MODE_SIG?macdTPl:na,title='macdTPl',text='üíé',color=macdupcolor,style=shape.circle,location=location.belowbar,size=size.auto)//plotforbuyicon
plotshape(MACD_MODE_SIG?macdTPs:na,title='macdTPs',text='üíé',color=macddowncolor,style=shape.circle,location=location.abovebar,size=size.auto)//plotforbuyicon
//===============TAKEPROFITandSTOPLOSSby%=================
tpsl(percent)=>
strategy.position_avg_price*percent/100/syminfo.mintick
GR4="=====üÜòüÜòüÜòTAKEPROFIT&STOPLOSSBY[%]üÜòüÜòüÜò====="
mode=input.bool(title="üÜòTakeProfit&StopLossByPercent(%)",defval=false,group=GRSUB,tooltip="TakeProfit&StopLossby%Change")
tp_l=tpsl(input.float(99999,title='üÜòTP[LONG]%',group=GR4))
tp_s=tpsl(input.float(33.3,title='üÜòTP[SHORT]%',group=GR4))
sl=tpsl(input.float(0,title='üÜòStopLoss%',group=GR4))
calcStopLossPrice(OffsetPts)=>
ifstrategy.position_size>0
strategy.position_avg_price-OffsetPts*syminfo.mintick
elseifstrategy.position_size<0
strategy.position_avg_price+OffsetPts*syminfo.mintick
else
na
calcStopLossL_AlertPrice(OffsetPts)=>
strategy.position_avg_price-OffsetPts*syminfo.mintick
calcStopLossS_AlertPrice(OffsetPts)=>
strategy.position_avg_price+OffsetPts*syminfo.mintick
calcTakeProfitPrice(OffsetPts)=>
ifstrategy.position_size>0
strategy.position_avg_price+OffsetPts*syminfo.mintick
elseifstrategy.position_size<0
strategy.position_avg_price-OffsetPts*syminfo.mintick
else
na
calcTakeProfitL_AlertPrice(OffsetPts)=>
strategy.position_avg_price+OffsetPts*syminfo.mintick
calcTakeProfitS_AlertPrice(OffsetPts)=>
strategy.position_avg_price-OffsetPts*syminfo.mintick
varstoploss=0.
varstoploss_l=0.
varstoploss_s=0.
vartakeprofit=0.
vartakeprofit_l=0.
vartakeprofit_s=0.
vartakeprofit_ll=0.
vartakeprofit_ss=0.
GRT="=====üÜëüÜëüÜëATRTRAILINGSTOPüÜëüÜëüÜë====="
/////////notes////////////////////////////////////////
//ThisisbasedontheATRtrailingstopindicator//
//widthadditionoftwolevelsofstopsand//
//differentinterpretation.//
//Thisisafast-reactingsystemandisbetter//
//suitedforhighervolatilitymarkets//
//////////////////////////////////////////////////////

//FastTrail//
AP1=input.int(5,'üÜëFastATRperiod',group=GRT)//ATRPeriod
AF1=input.float(0.5,'üÜëFastATRmultiplier',group=GRT)//ATRFactor
SL1=AF1*ta.atr(AP1)//StopLoss
Trail1=0.0
iff_1=close>nz(Trail1[1],0)?close-SL1:close+SL1
iff_2=close<nz(Trail1[1],0)andclose[1]<nz(Trail1[1],0)?math.min(nz(Trail1[1],0),close+SL1):iff_1
Trail1:=close>nz(Trail1[1],0)andclose[1]>nz(Trail1[1],0)?math.max(nz(Trail1[1],0),close-SL1):iff_2
//SlowTrail//
AP2=input.int(10,'üÜëSlowATRperiod',group=GRT)//ATRPeriod
AF2=input.float(2,'üÜëSlowATRmultiplier',group=GRT)//ATRFactor
SL2=AF2*ta.atr(AP2)//StopLoss
Trail2=0.0
iff_3=close>nz(Trail2[1],0)?close-SL2:close+SL2
iff_4=close<nz(Trail2[1],0)andclose[1]<nz(Trail2[1],0)?math.min(nz(Trail2[1],0),close+SL2):iff_3
Trail2:=close>nz(Trail2[1],0)andclose[1]>nz(Trail2[1],0)?math.max(nz(Trail2[1],0),close-SL2):iff_4
BuyLong=ta.crossover(Trail1,Trail2)
SellShort=ta.crossunder(Trail1,Trail2)
TS1=plot(plotcolor?Trail1:na,'FastTrail',style=plot.style_line,color=Trail1>Trail2?color.blue:color.yellow,linewidth=3,display=display.none)
TS2=plot(plotcolor?Trail2:na,'SlowTrail',style=plot.style_line,color=Trail1>Trail2?color.lime:color.blue,linewidth=3)
ifplotcolor==true
ifBuyLongandstrategy.position_size<0
strategy.close('Short',qty_percent=100,alert_message=Alert_StopLossshort,comment="üö®ATRTLüö®")
ifSellShortandstrategy.position_size>0
strategy.close('Long',qty_percent=100,alert_message=Alert_StopLosslong,comment="üö®ATRTLüö®")
GRARO="===üç©üç©üç©AROONSETTINGüç©üç©üç©==="
//#########TRENDLOCKCONFIRM(MACD>0andMAFAST>SLOW)########
AroonConfirm_MODE=input.bool(defval=false,title="üç©AROON100%&-100%CONFIRM",group=GRCON)
lengthAroon=input.int(14,minval=1,title="AROONLENGTH",group=GRARO)
AroonUpper=100*(ta.highestbars(high,lengthAroon)+lengthAroon)/lengthAroon
AroonLower=100*(ta.lowestbars(low,lengthAroon)+lengthAroon)/lengthAroon
AroonCrossUp=ta.crossover(AroonUpper,AroonLower)
AroonCrossDown=ta.crossunder(AroonUpper,AroonLower)
AroonHitUp=AroonUpper>AroonLower
AroonHitDown=AroonUpper<AroonLower
GRRSI="üâê===RSIMODE==="
RSI_PLOT=input.bool(defval=false,title="üâê===RSILINE===",group=GRRSI)
RSI_OB=input.int(defval=50,title="üâêRSIOverBought",minval=1,maxval=100,tooltip="RSIOB",group=GRRSI)
RSI_OS=input.int(defval=50,title="üâêRSIOverSold",minval=1,maxval=100,tooltip="RSIOS",group=GRRSI)
RSI_LENGTH=input.int(defval=14,title="RSILENGTH",minval=1,maxval=999,tooltip="RSILENGTH",group=GRRSI)
RSI_SMA=input.int(defval=50,title="RSISMALENGTH",minval=1,maxval=999,tooltip="RSISMALENGTHFORPREDICTTREND",group=GRRSI)
RSI_COL=input.color(defval=color.white,title="RSILINE",group=GRRSI,inline="RSI1")
RSI_SIZE=input.int(defval=2,title="SIZE",minval=0,maxval=4,tooltip="Width0-4",inline="RSI1",group=GRRSI)
RSI_TRANS=input.int(defval=0,title="TRNS",minval=0,maxval=100,tooltip="Transparency0-100",inline="RSI1",group=GRRSI)
RSIMA_COL1=input.color(defval=color.blue,title="RSIMALINE",group=GRRSI,inline="RSI2")
RSIMA_COL2=input.color(defval=color.teal,title="",group=GRRSI,inline="RSI2")
RSIMA_SIZE=input.int(defval=3,title="SIZE",minval=0,maxval=4,tooltip="Width0-4",inline="RSI2",group=GRRSI)
RSIMA_TRANS=input.int(defval=0,title="TRNS",minval=0,maxval=100,tooltip="Transparency0-100",inline="RSI2",group=GRRSI)
up=ta.rma(math.max(ta.change(close),0),RSI_LENGTH)
down=ta.rma(-math.min(ta.change(close),0),RSI_LENGTH)
rsi=down==0?100:up==0?0:100-(100/(1+up/down))
vrsi=ta.rsi(close,RSI_LENGTH)
RSIUP=ta.crossover(vrsi,RSI_OB)
RSIDOWN=ta.crossunder(vrsi,RSI_OS)
rsiMA=ta.sma(rsi,RSI_SMA)
RSIBULL=ta.crossover(rsi,rsiMA)
RSIBEAR=ta.crossunder(rsi,rsiMA)
BULLRSI=rsi<=RSI_OB
BEARRSI=rsi>=RSI_OS
RSIc1=rsi>rsiMA?color.new(RSIMA_COL1,RSIMA_TRANS):color.new(RSIMA_COL2,RSIMA_TRANS)
plotshape(RSI_PLOT?RSIUP:na,title='RSIUP',text='OB',color=color.new(color.yellow,100),style=shape.circle,location=location.belowbar,size=size.auto)//plotforbuyicon
plotshape(RSI_PLOT?RSIDOWN:na,title='RSIDOWN',text='OS',color=color.new(color.red,100),style=shape.circle,location=location.abovebar,size=size.auto)//plotforbuyicon
plot(RSI_PLOT?rsi:na,title="RSI",color=color.new(RSI_COL,RSI_TRANS),linewidth=RSI_SIZE,style=plot.style_line)
plot(RSI_PLOT?rsiMA:na,title="RSI-basedMA",color=RSIc1,linewidth=RSIMA_SIZE,style=plot.style_line)
Disable_Confirm=MACDConfirm_MODE==falseandRSIConfirm_MODE==falseandMACross_MODE==falseandIchiConfirm_MODE==falseandAroonConfirm_MODE==false
////////////INPUTBACKTESTRANGE////////////////////////////////////////////////////
varstringBTR1='‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïêINPUTBACKTESTTIMERANGE‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê'
i_startTime=input.time(defval=timestamp("01Jan194500:00+0000"),title="Start",inline="timestart",group=BTR1,tooltip='StartBacktestYYYY/MM/DD')
i_endTime=input.time(defval=timestamp("01Jan207423:59+0000"),title="End",inline="timeend",group=BTR1,tooltip='EndBacktestYYYY/MM/DD')
iftime>=i_startTimeandtime<=i_endTime
//#####BreakOutStrategy######
ifSpot_MODE==false
ifMACDConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andMACDBull
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôMACD",alert_message=Alert_OpenLong)
ifMACDBear
strategy.entry("Short",strategy.short,stop=downBound-syminfo.mintick,comment="BreaküëªMACD",alert_message=Alert_OpenShort)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andMACDBull
strategy.entry("Long",strategy.long,comment="UpüåôMACD",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andMACDBear
strategy.entry("Short",strategy.short,comment="DownüëªMACD",alert_message=Alert_OpenShort)
//#####15mStrategy######
if(longCondition15)andMACDBull
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôMACD")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andMACDBear
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandMACDBull
strategy.entry("Long",strategy.long,comment="XüåôMACD",alert_message=Alert_OpenLong)
ifBearMACrossandMACDBear
strategy.entry("Short",strategy.short,comment="XüëªMACD",alert_message=Alert_OpenShort)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandMACDBull
strategy.entry("Long",strategy.long,comment="X-ReüåôMACD",alert_message=Alert_OpenLong)
ifBearMAPlusandMACDBear
strategy.entry("Short",strategy.short,comment="X-ReüëªMACD",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPl
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPs
strategy.entry("Short",strategy.short,comment="MACDüëªX",alert_message=Alert_OpenShort)
if(MACDStrategy_MODE==trueandMACDStrategy_Repeat==true)
ifMACDBullormacdTPl
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifMACDBearormacdTPs
strategy.entry("Short",strategy.short,comment="MACDüëªX",alert_message=Alert_OpenShort)
if(MACDStrategy_MODE==falseandMACDStrategy_Repeat==true)
ifMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifMACDBear
strategy.entry("Short",strategy.short,comment="MACDüëªX",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandMACDBull
strategy.entry("Long",strategy.long,comment="ATRüåôMACD",alert_message=Alert_OpenLong)
ifATRSConditionandMACDBear
strategy.entry("Short",strategy.short,comment="ATRüëªMACD",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandMACDBull
strategy.entry("Long",strategy.long,comment="ATRRüåôMACD",alert_message=Alert_OpenLong)
ifShortRepeatandMACDBear
strategy.entry("Short",strategy.short,comment="ATRRüëªMACD",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandMACDBullandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôMACD",alert_message=Alert_OpenLong)
ifShortRepeatandMACDBearandS_Consecutive
strategy.entry("Short",strategy.short,comment="ATRRüëªMACD",alert_message=Alert_OpenShort)
ifForex_mode==true
ifMACDBull
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôMACD",alert_message=Alert_OpenLong)
ifMACDBear
strategy.entry("Short",strategy.short,stop=close-atrs,comment="FXüëªMACD",alert_message=Alert_OpenShort)
ifRSIConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andBULLRSI
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôRSI",alert_message=Alert_OpenLong)
ifBEARRSI
strategy.entry("Short",strategy.short,stop=downBound-syminfo.mintick,comment="BreaküëªRSI",alert_message=Alert_OpenShort)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andBULLRSI
strategy.entry("Long",strategy.long,comment="UpüåôRSI",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andBEARRSI
strategy.entry("Short",strategy.short,comment="DownüëªRSI",alert_message=Alert_OpenShort)
//#####15mStrategy######
if(longCondition15)andBULLRSI
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôRSI")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andBEARRSI
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMAPlusandBULLRSI
strategy.entry("Long",strategy.long,comment="XüåôRSI",alert_message=Alert_OpenLong)
ifBearMAPlusandBEARRSI
strategy.entry("Short",strategy.short,comment="XüëªRSI",alert_message=Alert_OpenShort)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandBULLRSI
strategy.entry("Long",strategy.long,comment="X-ReüåôRSI",alert_message=Alert_OpenLong)
ifBearMAPlusandBEARRSI
strategy.entry("Short",strategy.short,comment="X-ReüëªRSI",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPlandBULLRSI
strategy.entry("Long",strategy.long,comment="MACDüåôRSI",alert_message=Alert_OpenLong)
ifmacdTPsandBEARRSI
strategy.entry("Short",strategy.short,comment="MACDüëªRSI",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(MACDBullandBULLRSI)or(macdTPlandBULLRSI)
strategy.entry("Long",strategy.long,comment="MACDüåôRSI",alert_message=Alert_OpenLong)
if(MACDBearandBEARRSI)or(macdTPsandBEARRSI)
strategy.entry("Short",strategy.short,comment="MACDüëªRSI",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
ifMACDBullandBULLRSI
strategy.entry("Long",strategy.long,comment="MACDüåôRSI",alert_message=Alert_OpenLong)
ifMACDBearandBEARRSI
strategy.entry("Short",strategy.short,comment="MACDüëªRSI",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandBULLRSI
strategy.entry("Long",strategy.long,comment="ATRüåôRSI",alert_message=Alert_OpenLong)
ifATRSConditionandBEARRSI
strategy.entry("Short",strategy.short,comment="ATRüëªRSI",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandBULLRSI
strategy.entry("Long",strategy.long,comment="ATRRüåôRSI",alert_message=Alert_OpenLong)
ifShortRepeatandBEARRSI
strategy.entry("Short",strategy.short,comment="ATRRüëªRSI",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandBULLRSIandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôRSI",alert_message=Alert_OpenLong)
ifShortRepeatandBEARRSIandS_Consecutive
strategy.entry("Short",strategy.short,comment="ATRRüëªRSI",alert_message=Alert_OpenShort)
ifForex_mode==true
ifBULLRSI
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôRSI",alert_message=Alert_OpenLong)
ifBEARRSI
strategy.entry("Short",strategy.short,stop=close-atrs,comment="FXüëªRSI",alert_message=Alert_OpenShort)
ifMACross_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andBullMAPlus
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôMA",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.entry("Short",strategy.short,stop=downBound-syminfo.mintick,comment="BreaküëªMA",alert_message=Alert_OpenShort)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andBullMAPlus
strategy.entry("Long",strategy.long,comment="UpüåôMA",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andBearMAPlus
strategy.entry("Short",strategy.short,comment="DownüëªMA",alert_message=Alert_OpenShort)
//#####15mStrategy######
if(longCondition15)andBullMAPlus
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôMA")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andBearMAPlus
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandBullMAPlus)or(MACDBullandBullMAPlus)
strategy.entry("Long",strategy.long,comment="MACDüåôMA",alert_message=Alert_OpenLong)
if(macdTPsandBearMAPlus)or(MACDBearandBearMAPlus)
strategy.entry("Short",strategy.short,comment="MACDüëªMA",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
if(macdTPlandBullMAPlus)
strategy.entry("Long",strategy.long,comment="MACDüåôMA",alert_message=Alert_OpenLong)
if(macdTPsandBearMAPlus)
strategy.entry("Short",strategy.short,comment="MACDüëªMA",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandBullMAPlus)
strategy.entry("Long",strategy.long,comment="MACDüåôMA",alert_message=Alert_OpenLong)
if(MACDBearandBearMAPlus)
strategy.entry("Short",strategy.short,comment="MACDüëªMA",alert_message=Alert_OpenShort)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACross
strategy.entry("Long",strategy.long,comment="Xüåô",alert_message=Alert_OpenLong)
ifBearMACross
strategy.entry("Short",strategy.short,comment="Xüëª",alert_message=Alert_OpenShort)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlus
strategy.entry("Long",strategy.long,comment="X-Reüåô",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.entry("Short",strategy.short,comment="X-Reüëª",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandBullMAPlus
strategy.entry("Long",strategy.long,comment="ATRüåôMA",alert_message=Alert_OpenLong)
ifATRSConditionandBearMAPlus
strategy.entry("Short",strategy.short,comment="ATRüëªMA",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandBullMAPlus
strategy.entry("Long",strategy.long,comment="ATRRüåôMA",alert_message=Alert_OpenLong)
ifShortRepeatandBearMAPlus
strategy.entry("Short",strategy.short,comment="ATRRüëªMA",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandBullMAPlusandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôMA",alert_message=Alert_OpenLong)
ifShortRepeatandBearMAPlusandS_Consecutive
strategy.entry("Short",strategy.short,comment="ATRRüëªMA",alert_message=Alert_OpenShort)
ifForex_mode==true
ifBullMAPlus
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôMA",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.entry("Short",strategy.short,stop=close-atrs,comment="FXüëªMA",alert_message=Alert_OpenShort)
ifIchiConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andichi_bullplus
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôICHI",alert_message=Alert_OpenLong)
ifichi_bearplus
strategy.entry("Short",strategy.short,stop=downBound-syminfo.mintick,comment="BreaküëªICHI",alert_message=Alert_OpenShort)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andichi_bullplus
strategy.entry("Long",strategy.long,comment="UpüåôICHI",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andichi_bearplus
strategy.entry("Short",strategy.short,comment="DownüëªICHI",alert_message=Alert_OpenShort)
//#####15mStrategy######
if(longCondition15)andichi_bullplus
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôICHI")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andichi_bearplus
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandichi_bullplus
strategy.entry("Long",strategy.long,comment="XüåôICHI",alert_message=Alert_OpenLong)
ifBearMACrossandichi_bearplus
strategy.entry("Short",strategy.short,comment="XüëªICHI",alert_message=Alert_OpenShort)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandichi_bullplus
strategy.entry("Long",strategy.long,comment="X-ReüåôICHI",alert_message=Alert_OpenLong)
ifBearMAPlusandichi_bearplus
strategy.entry("Short",strategy.short,comment="X-ReüëªICHI",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandichi_bullplus)or(MACDBullandichi_bullplus)
strategy.entry("Long",strategy.long,comment="MACDüåôICHI",alert_message=Alert_OpenLong)
if(macdTPsandichi_bearplus)or(MACDBearandichi_bearplus)
strategy.entry("Short",strategy.short,comment="MACDüëªICHI",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
if(macdTPlandichi_bullplus)
strategy.entry("Long",strategy.long,comment="MACDüåôICHI",alert_message=Alert_OpenLong)
if(macdTPsandichi_bearplus)
strategy.entry("Short",strategy.short,comment="MACDüëªICHI",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandichi_bullplus)
strategy.entry("Long",strategy.long,comment="MACDüåôICHI",alert_message=Alert_OpenLong)
if(MACDBearandichi_bearplus)
strategy.entry("Short",strategy.short,comment="MACDüëªICHI",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandichi_bullplus
strategy.entry("Long",strategy.long,comment="ATRüåôICHI",alert_message=Alert_OpenLong)
ifATRSConditionandichi_bearplus
strategy.entry("Short",strategy.short,comment="ATRüëªICHI",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandichi_bullplus
strategy.entry("Long",strategy.long,comment="ATRRüåôICHI",alert_message=Alert_OpenLong)
ifShortRepeatandichi_bearplus
strategy.entry("Short",strategy.short,comment="ATRRüëªICHI",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandichi_bullplusandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôICHI",alert_message=Alert_OpenLong)
ifShortRepeatandichi_bearplusandS_Consecutive
strategy.entry("Short",strategy.short,comment="ATRRüëªICHI",alert_message=Alert_OpenShort)
ifForex_mode==true
ifichi_bullplus
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôICHI",alert_message=Alert_OpenLong)
ifichi_bearplus
strategy.entry("Short",strategy.short,stop=close-atrs,comment="FXüëªICHI",alert_message=Alert_OpenShort)
ifAroonConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andAroonHitUp
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôAR",alert_message=Alert_OpenLong)
ifAroonHitDown
strategy.entry("Short",strategy.short,stop=downBound-syminfo.mintick,comment="BreaküëªAR",alert_message=Alert_OpenShort)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andAroonHitUp
strategy.entry("Long",strategy.long,comment="UpüåôAR",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andAroonHitDown
strategy.entry("Short",strategy.short,comment="DownüëªAR",alert_message=Alert_OpenShort)
//#####15mStrategy######
if(longCondition15)andAroonHitUp
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôAR")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andAroonHitDown
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandAroonHitUp
strategy.entry("Long",strategy.long,comment="XüåôAR",alert_message=Alert_OpenLong)
ifBearMACrossandAroonHitDown
strategy.entry("Short",strategy.short,comment="XüëªAR",alert_message=Alert_OpenShort)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandAroonHitUp
strategy.entry("Long",strategy.long,comment="X-ReüåôAR",alert_message=Alert_OpenLong)
ifBearMAPlusandAroonHitDown
strategy.entry("Short",strategy.short,comment="X-ReüëªAR",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPlandAroonHitUp
strategy.entry("Long",strategy.long,comment="MACDüåôAR",alert_message=Alert_OpenLong)
ifmacdTPsandAroonHitDown
strategy.entry("Short",strategy.short,comment="MACDüëªAR",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandAroonHitUp)or(MACDBullandAroonHitUp)
strategy.entry("Long",strategy.long,comment="MACDüåôAR",alert_message=Alert_OpenLong)
if(macdTPsandAroonHitDown)or(MACDBearandAroonHitDown)
strategy.entry("Short",strategy.short,comment="MACDüëªAR",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandAroonHitUp)
strategy.entry("Long",strategy.long,comment="MACDüåôAR",alert_message=Alert_OpenLong)
if(MACDBearandAroonHitDown)
strategy.entry("Short",strategy.short,comment="MACDüëªAR",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandAroonHitUp
strategy.entry("Long",strategy.long,comment="ATRüåôAR",alert_message=Alert_OpenLong)
ifATRSConditionandAroonHitDown
strategy.entry("Short",strategy.short,comment="ATRüëªAR",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandAroonHitUp
strategy.entry("Long",strategy.long,comment="ATRRüåôAR",alert_message=Alert_OpenLong)
ifShortRepeatandAroonHitDown
strategy.entry("Short",strategy.short,comment="ATRRüëªAR",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandAroonHitUpandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôAR",alert_message=Alert_OpenLong)
ifShortRepeatandAroonHitDownandS_Consecutive
strategy.entry("Short",strategy.short,comment="ATRRüëªAR",alert_message=Alert_OpenShort)
ifForex_mode==true
ifAroonHitUp
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôAR",alert_message=Alert_OpenLong)
ifAroonHitDown
strategy.entry("Short",strategy.short,stop=close-atrs,comment="FXüëªAR",alert_message=Alert_OpenShort)
ifMACDConfirm_MODE==falseandRSIConfirm_MODE==falseandMACross_MODE==falseandIchiConfirm_MODE==falseandAroonConfirm_MODE==false
ifBreakOut_MODE==true
ifnotna(close[lengthBO])
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="Breaküåô",alert_message=Alert_OpenLong)
strategy.entry("Short",strategy.short,stop=downBound-syminfo.mintick,comment="Breaküëª",alert_message=Alert_OpenShort)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)
strategy.entry("Long",strategy.long,comment="Upüåô",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)
strategy.entry("Short",strategy.short,comment="Downüëª",alert_message=Alert_OpenShort)
//#####15mStrategy######
if(longCondition15)
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong)
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACross
strategy.entry("Long",strategy.long,comment="Xüåô",alert_message=Alert_OpenLong)
ifBearMACross
strategy.entry("Short",strategy.short,comment="Xüëª",alert_message=Alert_OpenShort)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlus
strategy.entry("Long",strategy.long,comment="X-Reüåô",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.entry("Short",strategy.short,comment="X-Reüëª",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPl
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPs
strategy.entry("Short",strategy.short,comment="MACDüëªX",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
ifmacdTPlorMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPsorMACDBear
strategy.entry("Short",strategy.short,comment="MACDüëªX",alert_message=Alert_OpenShort)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
ifMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifMACDBear
strategy.entry("Short",strategy.short,comment="MACDüëªX",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLCondition
strategy.entry("Long",strategy.long,comment="ATRüåô",alert_message=Alert_OpenLong)
ifATRSCondition
strategy.entry("Short",strategy.short,comment="ATRüëª",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeat
strategy.entry("Long",strategy.long,comment="ATRRüåô",alert_message=Alert_OpenLong)
ifShortRepeat
strategy.entry("Short",strategy.short,comment="ATRRüëª",alert_message=Alert_OpenShort)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåô",alert_message=Alert_OpenLong)
ifShortRepeatandS_Consecutive
strategy.entry("Short",strategy.short,comment="ATRRüëª",alert_message=Alert_OpenShort)
ifForex_mode==true
strategy.entry("Long",strategy.long,stop=close+atrs,comment="Voltyüåô",alert_message=Alert_OpenLong)
strategy.entry("Short",strategy.short,stop=close-atrs,comment="Voltyüëª",alert_message=Alert_OpenShort)
ifSpot_MODE==true
ifMACDConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andMACDBull
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôMACD",alert_message=Alert_OpenLong)
ifMACDBear
strategy.close_all(immediately=true,comment="BreaküëªMACD",alert_message=Alert_StopLosslong)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andMACDBull
strategy.entry("Long",strategy.long,comment="UpüåôMACD",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andMACDBear
strategy.close_all(immediately=true,comment="DownüëªMACD",alert_message=Alert_StopLosslong)
//#####15mStrategy######
if(longCondition15)andMACDBull
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôMACD")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andMACDBear
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandMACDBull
strategy.entry("Long",strategy.long,comment="XüåôMACD",alert_message=Alert_OpenLong)
ifBearMACrossandMACDBear
strategy.close_all(immediately=true,comment="XüëªMACD",alert_message=Alert_StopLosslong)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandMACDBull
strategy.entry("Long",strategy.long,comment="X-ReüåôMACD",alert_message=Alert_OpenLong)
ifBearMAPlusandMACDBear
strategy.close_all(immediately=true,comment="XüëªMACD",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPl
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPs
strategy.close_all(immediately=true,comment="MACDüëªX",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
ifmacdTPlorMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPsorMACDBear
strategy.close_all(immediately=true,comment="MACDüëªX",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
ifMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifMACDBear
strategy.close_all(immediately=true,comment="MACDüëªX",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandMACDBull
strategy.entry("Long",strategy.long,comment="ATRüåôMACD",alert_message=Alert_OpenLong)
ifATRSConditionandMACDBear
strategy.close_all(immediately=true,comment="ATRüëªMACD",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandMACDBull
strategy.entry("Long",strategy.long,comment="ATRRüåôMACD",alert_message=Alert_OpenLong)
ifShortRepeatandMACDBear
strategy.close_all(immediately=true,comment="ATRRüëªMACD",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandMACDBullandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôMACD",alert_message=Alert_OpenLong)
ifShortRepeatandMACDBearandS_Consecutive
strategy.close_all(immediately=true,comment="ATRRüëªMACD",alert_message=Alert_StopLosslong)
ifForex_mode==true
ifMACDBull
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôMACD",alert_message=Alert_OpenLong)
ifMACDBear
strategy.exit("Exit_LFX","Long",stop=close-atrs,comment="FXüëªMACD",alert_message=Alert_StopLosslong)
ifRSIConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andBULLRSI
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôRSI",alert_message=Alert_OpenLong)
ifBEARRSI
strategy.close_all(immediately=true,comment="BreaküëªRSI",alert_message=Alert_StopLosslong)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andBULLRSI
strategy.entry("Long",strategy.long,comment="UpüåôRSI",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andBEARRSI
strategy.close_all(immediately=true,comment="DownüëªRSI",alert_message=Alert_StopLosslong)
//#####15mStrategy######
if(longCondition15)andBULLRSI
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôRSI")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andBEARRSI
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandBULLRSI
strategy.entry("Long",strategy.long,comment="XüåôRSI",alert_message=Alert_OpenLong)
ifBearMACrossandBEARRSI
strategy.close_all(immediately=true,comment="XüëªRSI",alert_message=Alert_StopLosslong)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandBULLRSI
strategy.entry("Long",strategy.long,comment="X-ReüåôRSI",alert_message=Alert_OpenLong)
ifBearMAPlusandBEARRSI
strategy.close_all(immediately=true,comment="XüëªRSI",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPlandBULLRSI
strategy.entry("Long",strategy.long,comment="MACDüåôRSI",alert_message=Alert_OpenLong)
ifmacdTPsandBEARRSI
strategy.close_all(immediately=true,comment="MACDüëªRSI",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandBULLRSI)or(MACDBullandBULLRSI)
strategy.entry("Long",strategy.long,comment="MACDüåôRSI",alert_message=Alert_OpenLong)
if(macdTPsandBEARRSI)or(MACDBearandBEARRSI)
strategy.close_all(immediately=true,comment="MACDüëªRSI",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandBULLRSI)
strategy.entry("Long",strategy.long,comment="MACDüåôRSI",alert_message=Alert_OpenLong)
if(MACDBearandBEARRSI)
strategy.close_all(immediately=true,comment="MACDüëªRSI",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandBULLRSI
strategy.entry("Long",strategy.long,comment="ATRüåôRSI",alert_message=Alert_OpenLong)
ifATRSConditionandBEARRSI
strategy.close_all(immediately=true,comment="ATRüëªRSI",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandBULLRSI
strategy.entry("Long",strategy.long,comment="ATRRüåôRSI",alert_message=Alert_OpenLong)
ifShortRepeatandBEARRSI
strategy.close_all(immediately=true,comment="ATRRüëªRSI",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandBULLRSIandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôRSI",alert_message=Alert_OpenLong)
ifShortRepeatandBEARRSIandS_Consecutive
strategy.close_all(immediately=true,comment="ATRRüëªRSI",alert_message=Alert_StopLosslong)
ifForex_mode==true
ifBULLRSI
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôRSI",alert_message=Alert_OpenLong)
ifBEARRSI
strategy.exit("Exit_LFX","Long",stop=close-atrs,comment="FXüëªRSI",alert_message=Alert_StopLosslong)
ifMACross_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andBullMAPlus
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôMA",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.close_all(immediately=true,comment="BreaküëªMA",alert_message=Alert_StopLosslong)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andBullMAPlus
strategy.entry("Long",strategy.long,comment="UpüåôMA",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andBearMAPlus
strategy.close_all(immediately=true,comment="DownüëªMA",alert_message=Alert_StopLosslong)
//#####15mStrategy######
if(longCondition15)andBullMAPlus
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôMA")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andBearMAPlus
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPlandBullMAPlus
strategy.entry("Long",strategy.long,comment="MACDüåôMA",alert_message=Alert_OpenLong)
ifmacdTPsandBearMAPlus
strategy.close_all(immediately=true,comment="MACDüëªMA",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandBullMAPlus)or(MACDBullandBullMAPlus)
strategy.entry("Long",strategy.long,comment="MACDüåôMA",alert_message=Alert_OpenLong)
if(macdTPsandBearMAPlus)or(MACDBearandBearMAPlus)
strategy.close_all(immediately=true,comment="MACDüëªMA",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandBullMAPlus)
strategy.entry("Long",strategy.long,comment="MACDüåôMA",alert_message=Alert_OpenLong)
if(MACDBearandBearMAPlus)
strategy.close_all(immediately=true,comment="MACDüëªMA",alert_message=Alert_StopLosslong)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACross
strategy.entry("Long",strategy.long,comment="XüåôMA",alert_message=Alert_OpenLong)
ifBearMACross
strategy.close_all(immediately=true,comment="XüëªMA",alert_message=Alert_StopLosslong)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlus
strategy.entry("Long",strategy.long,comment="X-ReüåôMA",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.close_all(immediately=true,comment="XüëªMA",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandBullMAPlus
strategy.entry("Long",strategy.long,comment="ATRüåôMA",alert_message=Alert_OpenLong)
ifATRSConditionandBearMAPlus
strategy.close_all(immediately=true,comment="ATRüëªMA",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandBullMAPlus
strategy.entry("Long",strategy.long,comment="ATRRüåôMA",alert_message=Alert_OpenLong)
ifShortRepeatandBearMAPlus
strategy.close_all(immediately=true,comment="ATRRüëªMA",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandBullMAPlusandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôMA",alert_message=Alert_OpenLong)
ifShortRepeatandBearMAPlusandS_Consecutive
strategy.close_all(immediately=true,comment="ATRRüëªMA",alert_message=Alert_StopLosslong)
ifForex_mode==true
ifBullMAPlus
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôMA",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.exit("Exit_LFX","Long",stop=close-atrs,comment="FXüëªMA",alert_message=Alert_StopLosslong)
ifIchiConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andichi_bullplus
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôICHI",alert_message=Alert_OpenLong)
ifichi_bearplus
strategy.close_all(immediately=true,comment="BreaküëªICHI",alert_message=Alert_StopLosslong)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andichi_bullplus
strategy.entry("Long",strategy.long,comment="UpüåôICHI",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andichi_bearplus
strategy.close_all(immediately=true,comment="DownüëªICHI",alert_message=Alert_StopLosslong)
//#####15mStrategy######
if(longCondition15)andichi_bullplus
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôICHI")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andichi_bearplus
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandichi_bullplus
strategy.entry("Long",strategy.long,comment="XüåôICHI",alert_message=Alert_OpenLong)
ifBearMACrossandichi_bearplus
strategy.close_all(immediately=true,comment="XüëªICHI",alert_message=Alert_StopLosslong)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandichi_bullplus
strategy.entry("Long",strategy.long,comment="X-ReüåôICHI",alert_message=Alert_OpenLong)
ifBearMAPlusandichi_bearplus
strategy.close_all(immediately=true,comment="XüëªICHI",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPlandichi_bullplus
strategy.entry("Long",strategy.long,comment="MACDüåôICHI",alert_message=Alert_OpenLong)
ifmacdTPsandichi_bearplus
strategy.close_all(immediately=true,comment="MACDüëªICHI",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandichi_bullplus)or(MACDBullandichi_bullplus)
strategy.entry("Long",strategy.long,comment="MACDüåôICHI",alert_message=Alert_OpenLong)
if(macdTPsandichi_bearplus)or(MACDBearandichi_bearplus)
strategy.close_all(immediately=true,comment="MACDüëªICHI",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandichi_bullplus)
strategy.entry("Long",strategy.long,comment="MACDüåôICHI",alert_message=Alert_OpenLong)
if(MACDBearandichi_bearplus)
strategy.close_all(immediately=true,comment="MACDüëªICHI",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandichi_bullplus
strategy.entry("Long",strategy.long,comment="ATRüåôICHI",alert_message=Alert_OpenLong)
ifATRSConditionandichi_bearplus
strategy.close_all(immediately=true,comment="ATRüëªICHI",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandichi_bullplus
strategy.entry("Long",strategy.long,comment="ATRRüåôICHI",alert_message=Alert_OpenLong)
ifShortRepeatandichi_bearplus
strategy.close_all(immediately=true,comment="ATRRüëªICHI",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandichi_bullplusandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôICHI",alert_message=Alert_OpenLong)
ifShortRepeatandichi_bearplusandS_Consecutive
strategy.close_all(immediately=true,comment="ATRRüëªICHI",alert_message=Alert_StopLosslong)
ifForex_mode==true
ifichi_bullplus
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôICHI",alert_message=Alert_OpenLong)
ifichi_bearplus
strategy.exit("Exit_LFX","Long",stop=close-atrs,comment="FXüëªICHI",alert_message=Alert_StopLosslong)
ifAroonConfirm_MODE==true
ifBreakOut_MODE==true
ifnotna(close[lengthBO])andAroonHitUp
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="BreaküåôAR",alert_message=Alert_OpenLong)
ifAroonHitDown
strategy.close_all(immediately=true,comment="BreaküëªAR",alert_message=Alert_StopLosslong)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)andAroonHitUp
strategy.entry("Long",strategy.long,comment="UpüåôAR",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)andAroonHitDown
strategy.close_all(immediately=true,comment="DownüëªAR",alert_message=Alert_StopLosslong)
//#####15mStrategy######
if(longCondition15)andAroonHitUp
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong,comment="15müåôAR")
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)andAroonHitDown
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACrossandAroonHitUp
strategy.entry("Long",strategy.long,comment="XüåôAR",alert_message=Alert_OpenLong)
ifBearMACrossandAroonHitDown
strategy.close_all(immediately=true,comment="XüëªAR",alert_message=Alert_StopLosslong)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlusandAroonHitUp
strategy.entry("Long",strategy.long,comment="X-ReüåôAR",alert_message=Alert_OpenLong)
ifBearMAPlusandAroonHitDown
strategy.close_all(immediately=true,comment="XüëªAR",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPlandAroonHitUp
strategy.entry("Long",strategy.long,comment="MACDüåôAR",alert_message=Alert_OpenLong)
ifmacdTPsandAroonHitDown
strategy.close_all(immediately=true,comment="MACDüëªAR",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
if(macdTPlandAroonHitUp)or(MACDBullandAroonHitUp)
strategy.entry("Long",strategy.long,comment="MACDüåôAR",alert_message=Alert_OpenLong)
if(macdTPsandAroonHitDown)or(MACDBearandAroonHitDown)
strategy.close_all(immediately=true,comment="MACDüëªAR",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
if(MACDBullandAroonHitUp)
strategy.entry("Long",strategy.long,comment="MACDüåôAR",alert_message=Alert_OpenLong)
if(MACDBearandAroonHitDown)
strategy.close_all(immediately=true,comment="MACDüëªAR",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLConditionandAroonHitUp
strategy.entry("Long",strategy.long,comment="ATRüåôAR",alert_message=Alert_OpenLong)
ifATRSConditionandAroonHitDown
strategy.close_all(immediately=true,comment="ATRüëªAR",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeatandAroonHitUp
strategy.entry("Long",strategy.long,comment="ATRRüåôAR",alert_message=Alert_OpenLong)
ifShortRepeatandAroonHitDown
strategy.close_all(immediately=true,comment="ATRRüëªAR",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandAroonHitUpandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôAR",alert_message=Alert_OpenLong)
ifShortRepeatandAroonHitDownandS_Consecutive
strategy.close_all(immediately=true,comment="ATRRüëªAR",alert_message=Alert_StopLosslong)
ifForex_mode==true
ifAroonHitUp
strategy.entry("Long",strategy.long,stop=close+atrs,comment="FXüåôAR",alert_message=Alert_OpenLong)
ifAroonHitDown
strategy.exit("Exit_LFX","Long",stop=close-atrs,comment="FXüëªAR",alert_message=Alert_StopLosslong)
ifMACDConfirm_MODE==falseandRSIConfirm_MODE==falseandMACross_MODE==falseandIchiConfirm_MODE==falseandAroonConfirm_MODE==false
ifBreakOut_MODE==true
ifnotna(close[lengthBO])
strategy.entry("Long",strategy.long,stop=upBound+syminfo.mintick,comment="Breaküåô",alert_message=Alert_OpenLong)
strategy.exit("Long",qty_percent=100,stop=downBound-syminfo.mintick,comment="Breaküëª",alert_message=Alert_StopLosslong)
//#####ConsecutiveStrategy#######
if(Consecutive_MODE?ups>=consecutiveBarsUp:na)
strategy.entry("Long",strategy.long,comment="Upüåô",alert_message=Alert_OpenLong)
if(Consecutive_MODE?dns>=consecutiveBarsDown:na)
strategy.close_all(immediately=true,comment="Downüëª",alert_message=Alert_StopLosslong)
//#####15mStrategy######
if(longCondition15)
strategy.entry("Long",strategy.long,alert_message=Alert_OpenLong)
alert("15mBREAKUP",freq=alert.freq_once_per_bar_close)
if(shortCondition15)
strategy.close_all("15mBREAKDOWN",immediately=true,alert_message=Alert_StopLosslong)
alert("15mBREAKDOWN",freq=alert.freq_once_per_bar_close)
ifMAStrategy_MODE==trueandMARepeat_Mode==false
ifBullMACross
strategy.entry("Long",strategy.long,comment="Xüåô",alert_message=Alert_OpenLong)
ifBearMACross
strategy.close_all(immediately=true,comment="Xüëª",alert_message=Alert_StopLosslong)
if(MAStrategy_MODE==trueandMARepeat_Mode==true)or(MAStrategy_MODE==falseandMARepeat_Mode==true)
ifBullMAPlus
strategy.entry("Long",strategy.long,comment="X-Reüåô",alert_message=Alert_OpenLong)
ifBearMAPlus
strategy.close_all(immediately=true,comment="Xüëª",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==false
ifmacdTPl
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPs
strategy.close_all(immediately=true,comment="MACDüëªX",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==trueandMACDStrategy_Repeat==true
ifmacdTPlorMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifmacdTPsorMACDBear
strategy.close_all(immediately=true,comment="MACDüëªX",alert_message=Alert_StopLosslong)
ifMACDStrategy_MODE==falseandMACDStrategy_Repeat==true
ifMACDBull
strategy.entry("Long",strategy.long,comment="MACDüåôX",alert_message=Alert_OpenLong)
ifMACDBear
strategy.close_all(immediately=true,comment="MACDüëªX",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==falseandvolty_conse==falseandForex_mode==false
ifATRLCondition
strategy.entry("Long",strategy.long,comment="ATRüåôAR",alert_message=Alert_OpenLong)
ifATRSCondition
strategy.close_all(immediately=true,comment="ATRüëªAR",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==falseandForex_mode==false
ifLongRepeat
strategy.entry("Long",strategy.long,comment="ATRRüåôAR",alert_message=Alert_OpenLong)
ifShortRepeat
strategy.close_all(immediately=true,comment="ATRRüëªAR",alert_message=Alert_StopLosslong)
ifvolty_mode==trueandRepeat_mode==trueandvolty_conse==trueandForex_mode==false
ifLongRepeatandL_Consecutive
strategy.entry("Long",strategy.long,comment="ATRRüåôAR",alert_message=Alert_OpenLong)
ifShortRepeatandS_Consecutive
strategy.close_all(immediately=true,comment="ATRRüëªAR",alert_message=Alert_StopLosslong)
ifForex_mode==true
strategy.entry("Long",strategy.long,stop=close+atrs,comment="Voltyüåô",alert_message=Alert_OpenLong)
strategy.exit("Spot_ExitFX","Long",stop=close-atrs,comment="Voltyüëª",alert_message=Alert_OpenShort)
////////////////////////////////////////////////////////////////////////////////////////////////////////////////
ifmode==true
ifSpot_MODE==false
if(strategy.position_size>0)
ifsl>0
stoploss:=calcStopLossPrice(sl)
stoploss_l:=stoploss
elseifsl<=0
stoploss:=na
iftp_l>0
takeprofit:=tp_l
takeprofit_ll:=close+((close/100)*tp_l)
//takeprofit_s:=na
elseiftp_l<=0
takeprofit:=na
if(strategy.position_size<0)
ifsl>0
stoploss:=calcStopLossPrice(sl)
stoploss_s:=stoploss
elseifsl<=0
stoploss:=na
iftp_s>0
takeprofit:=tp_s
takeprofit_ss:=close-((close/100)*tp_s)
//takeprofit_l:=na
elseiftp_s<=0
takeprofit:=na
elseifstrategy.position_size==0
stoploss:=na
takeprofit:=na
ifSpot_MODE==true
if(strategy.position_size>0)
ifsl>0
stoploss:=calcStopLossPrice(sl)
stoploss_l:=stoploss
elseifsl<=0
stoploss:=na
iftp_l>0
takeprofit:=tp_l
takeprofit_ll:=close+((close/100)*tp_l)
//takeprofit_s:=na
elseiftp_l<=0
takeprofit:=na
elseifstrategy.position_size==0
stoploss:=na
takeprofit:=na
ifmode==true
ifSpot_MODE==false
ifstrategy.position_size>0
strategy.exit("Exit",'Long',qty_percent=100,profit=takeprofit,stop=stoploss,alert_message=Alert_StopLosslong,comment_profit="TPüíöL",comment_loss="SLüíöL")
ifstrategy.position_size<0
strategy.exit("Exit",'Short',qty_percent=100,profit=takeprofit,stop=stoploss,alert_message=Alert_StopLossshort,comment_profit="TP‚ù§Ô∏èÔ∏èS",comment_loss="SL‚ù§Ô∏èÔ∏èS")
ifSpot_MODE==true
ifstrategy.position_size>0
strategy.exit("Exit",'Long',qty_percent=100,profit=takeprofit,stop=stoploss,alert_message=Alert_StopLosslong,comment_profit="TPüíöL",comment_loss="SLüíöL")
//=====================‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâlibrary=========================
importX4815162342/X48_LibaryStrategyStatus/2asfuLi
//‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•Backtest
show_Net=input.bool(true,'MonitorProfit&Loss',inline='Lnet',group='=PNLMONITORSETTING=')
position_=input.string('bottom_center','Position',options=['top_right','middle_right','bottom_right','top_center','middle_center','bottom_center','middle_left','bottom_left'],inline='Lnet')
size_i=input.string('auto','size',options=['auto','tiny','small','normal'],inline='Lnet')
color_Net=input.color(color.blue,"",inline='Lnet')
fuLi.NetProfit_Show(show_Net,position_,size_i,color_Net)
Expand (1515 lines)
