Script Name: Strategy Execution Template - Master Pattern
Author: superNature
Description: This script is a template to execute your strategy with Stop Loss and Take Profit and showing Trades.

Then, you can write your strategy without taking care of Stop Loss and Take Profit method.
3x Fixed Percent Stop Loss, Trailing Percent Stop Loss, Trailing ATR Stop Loss, Tailing HHLL Stop Loss
3x Fixed Percent, Take Profit
PineScript code:

Pine Scriptâ„¢ strategy
Strategy Execution Template - Master Pattern
//  -----------------------------------------------------------------
//  (c)2022  superNature
//  @version=5
//  -----------------------------------------------------------------
strategy("Strategy  Execution  Template  -  Master  Pattern",    max_labels_count=500,  max_boxes_count=500,  overlay=true,calc_on_order_fills=true,  calc_on_every_tick=true,  default_qty_type=strategy.percent_of_equity,  default_qty_value=100,  initial_capital=1000,  currency='USD',  slippage=2,  commission_value=0.036  ,commission_type=strategy.commission.percent,  close_entries_rule  =  "ANY")
//  ==================================  //
//  --------->  User  Input  <-----------  //
//  ==================================  //
var  inputGroupBackSett            =  'â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”¸ðŸ”¸  ðŸ”  Backtest  settings  ðŸ”  ðŸ”¸ðŸ”¸ðŸ”¸â€ƒâ€ƒâ€ƒ'
startTimeEnable                          =  input.bool(group=inputGroupBackSett,  title='Start  Date',  defval=true,  inline='StartDate')
startTime                                      =  input.time(group=inputGroupBackSett,  title='',  defval=timestamp('04  Apr  2022  13:30  +0000'),  inline='StartDate')
endTimeEnable                              =  input.bool(group=inputGroupBackSett,  title='End  Date',  defval=false,  inline='EndDate')
endTime                                          =  input.time(group=inputGroupBackSett,  title='  ',defval=timestamp('01  Jan  2099  13:30  +0000'),  inline='EndDate')
var  inputGroupTradeSett          =  'â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”¸ðŸ”¸  ðŸ”§  Trade  setting  ðŸ”§  ðŸ”¸ðŸ”¸ðŸ”¸'
wayTradeType                                =  input.string(group=inputGroupTradeSett,  title='Way  Trade',  defval='Long',  options=['Long','Short'],  inline='Trade')
indicatorType                              =  input.string(group=inputGroupTradeSett,  title='Candle',  defval='Candles',  options=['Candles','Heikin'],  inline='Trade')
tradeConfirm                                =  input.bool(group=inputGroupTradeSett,  title='Wait  for  candle  confirmed',  defval=true)
dayMonTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Mond',  defval=true,  inline='days')
dayTueTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Tues',  defval=true,  inline='days')
dayWedTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Wedn',  defval=true,  inline='days')
dayThuTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Thur',  defval=true,  inline='days')
dayFriTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Frid',  defval=true,  inline='days')
daySatTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Satu',  defval=true,  inline='days')
daySunTrade                                  =  input.bool(group=inputGroupTradeSett,  title='Sund',  defval=true,  inline='days')
useSessionFilter                        =  input.bool(group=inputGroupTradeSett,  title='Sesssion  Filter',  defval=false)
hoursToFilter                              =  input.session(group=inputGroupTradeSett,  title='Hours',  defval='0000-0000')
var  inputGroupDrawSett            =  'â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”¸ðŸ”¸  ðŸ–Œ  Drawing  ðŸ–Œ  ðŸ”¸ðŸ”¸ðŸ”¸â€ƒâ€ƒâ€ƒ'
showWinOrder                                =  input.bool(group=inputGroupDrawSett,  title='Show  win  order',  defval=true,  inline='trade')
showLoosOrder                              =  input.bool(group=inputGroupDrawSett,  title='Show  loose  order',  defval=true,  inline='trade')
showTradeResult                          =  input.bool(group=inputGroupDrawSett,  title='Show  Trade',  defval=true,  inline='trade')
showTableResult                          =  input.bool(group=inputGroupDrawSett,  title='Show  Table  Result',  defval=true,  inline='table')
var  inputGroupSL1                      =  'â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸  ðŸ”´  â›”  Stop  loss  |  ðŸš©  1  -  FIRST  ðŸ”´  ðŸ”¸'
inputGroupSL1_When                      =  input.string(group=inputGroupSL1,  title='Trig',  defval='OFF',  options=['ON','OFF','TP1','TP1TS','TP2','TP2TS','TP3','TP3TS','TP4','TP4TS','TP5','TP5TS'],inline='SL-1')
inputGroupSL1_Type                    =  input.string(group=inputGroupSL1,  title='Type',  defval='Trailing',  options=['Fixed','Trailing'],inline='SL-1')
inputGroupSL1_QtyPer        =input.float(group=inputGroupSL1,title='Pos%',defval=33.33,inline='SL-1')
inputGroupSL1_Stick=input.string(group=inputGroupSL1,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='SL-1-GP')
inputGroupSL1_Src=input.string(group=inputGroupSL1,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='SL-1-GP')
inputGroupSL1_HL=input.bool(group=inputGroupSL1,title='',defval=false,inline='SL-1-GP')
inputGroupSL1_LB=input.int(group=inputGroupSL1,title='HL',defval=10,inline='SL-1-GP')
inputGroupSL1_Meth=input.string(group=inputGroupSL1,title='Met',defval='%',options=['%','PIPS','ATR'],inline='SL-1-DP')
inputGroupSL1_Val=input.float(group=inputGroupSL1,title='Val/x',defval=0.0,inline='SL-1-DP')
inputGroupSL1_Len=input.int(group=inputGroupSL1,title='Len',defval=10,inline='SL-1-DP')
varinputGroupSL2='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”´â›”Stoploss|ðŸš©2-SECONDðŸ”´ðŸ”¸'
inputGroupSL2_When=input.string(group=inputGroupSL2,title='Trig',defval='OFF',options=['ON','OFF','TP1','TP1TS','TP2','TP2TS','TP3','TP3TS','TP4','TP4TS','TP5','TP5TS'],inline='SL-2')
inputGroupSL2_Type=input.string(group=inputGroupSL2,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='SL-2')
inputGroupSL2_QtyPer=input.float(group=inputGroupSL2,title='Pos%',defval=33.33,inline='SL-2')
inputGroupSL2_Stick=input.string(group=inputGroupSL2,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='SL-2-GP')
inputGroupSL2_Src=input.string(group=inputGroupSL2,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='SL-2-GP')
inputGroupSL2_HL=input.bool(group=inputGroupSL2,title='',defval=false,inline='SL-2-GP')
inputGroupSL2_LB=input.int(group=inputGroupSL2,title='HL',defval=10,inline='SL-2-GP')
inputGroupSL2_Meth=input.string(group=inputGroupSL2,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='SL-2-DP')
inputGroupSL2_Val=input.float(group=inputGroupSL2,title='Val/x',defval=0.0,inline='SL-2-DP')
inputGroupSL2_Len=input.int(group=inputGroupSL2,title='Len',defval=10,inline='SL-2-DP')
varinputGroupSL3='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”´â›”Stoploss|ðŸš©3-THIRDðŸ”´ðŸ”¸'
inputGroupSL3_When=input.string(group=inputGroupSL3,title='Trig',defval='OFF',options=['ON','OFF','TP1','TP1TS','TP2','TP2TS','TP3','TP3TS','TP4','TP4TS','TP5','TP5TS'],inline='SL-3')
inputGroupSL3_Type=input.string(group=inputGroupSL3,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='SL-3')
inputGroupSL3_QtyPer=input.float(group=inputGroupSL3,title='Pos%',defval=33.33,inline='SL-3')
inputGroupSL3_Stick=input.string(group=inputGroupSL3,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='SL-3-GP')
inputGroupSL3_Src=input.string(group=inputGroupSL3,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='SL-3-GP')
inputGroupSL3_HL=input.bool(group=inputGroupSL3,title='',defval=false,inline='SL-3-GP')
inputGroupSL3_LB=input.int(group=inputGroupSL3,title='HL',defval=10,inline='SL-3-GP')
inputGroupSL3_Meth=input.string(group=inputGroupSL3,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='SL-3-DP')
inputGroupSL3_Val=input.float(group=inputGroupSL3,title='Val/x',defval=0.0,inline='SL-3-DP')
inputGroupSL3_Len=input.int(group=inputGroupSL3,title='Len',defval=10,inline='SL-3-DP')
varinputGroupSL4='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”´â›”Stoploss|ðŸš©4-FOURTHðŸ”´ðŸ”¸'
inputGroupSL4_When=input.string(group=inputGroupSL4,title='Trig',defval='OFF',options=['ON','OFF','TP1','TP1TS','TP2','TP2TS','TP3','TP3TS','TP4','TP4TS','TP5','TP5TS'],inline='SL-4')
inputGroupSL4_Type=input.string(group=inputGroupSL4,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='SL-4')
inputGroupSL4_QtyPer=input.float(group=inputGroupSL4,title='Pos%',defval=33.33,inline='SL-4')
inputGroupSL4_Stick=input.string(group=inputGroupSL4,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='SL-4-GP')
inputGroupSL4_Src=input.string(group=inputGroupSL4,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='SL-4-GP')
inputGroupSL4_HL=input.bool(group=inputGroupSL4,title='',defval=false,inline='SL-4-GP')
inputGroupSL4_LB=input.int(group=inputGroupSL4,title='HL',defval=10,inline='SL-4-GP')
inputGroupSL4_Meth=input.string(group=inputGroupSL4,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='SL-4-DP')
inputGroupSL4_Val=input.float(group=inputGroupSL4,title='Val/x',defval=0.0,inline='SL-4-DP')
inputGroupSL4_Len=input.int(group=inputGroupSL4,title='Len',defval=10,inline='SL-4-DP')
varinputGroupSL5='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸ”´â›”Stoploss|ðŸš©5-FIFTHðŸ”´ðŸ”¸'
inputGroupSL5_When=input.string(group=inputGroupSL5,title='Trig',defval='OFF',options=['ON','OFF','TP1','TP1TS','TP2','TP2TS','TP3','TP3TS','TP4','TP4TS','TP5','TP5TS'],inline='SL-5')
inputGroupSL5_Type=input.string(group=inputGroupSL5,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='SL-5')
inputGroupSL5_QtyPer=input.float(group=inputGroupSL5,title='Pos%',defval=33.33,inline='SL-5')
inputGroupSL5_Stick=input.string(group=inputGroupSL5,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='SL-5-GP')
inputGroupSL5_Src=input.string(group=inputGroupSL5,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='SL-5-GP')
inputGroupSL5_HL=input.bool(group=inputGroupSL5,title='',defval=false,inline='SL-5-GP')
inputGroupSL5_LB=input.int(group=inputGroupSL5,title='HL',defval=10,inline='SL-5-GP')
inputGroupSL5_Meth=input.string(group=inputGroupSL5,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='SL-5-DP')
inputGroupSL5_Val=input.float(group=inputGroupSL5,title='Val/x',defval=0.0,inline='SL-5-DP')
inputGroupSL5_Len=input.int(group=inputGroupSL5,title='Len',defval=10,inline='SL-5-DP')
varinputGroupTP1='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸŸ¢â›³TargetProfit|ðŸ1-FIRSTðŸŸ¢ðŸ”¸'
inputGroupTP1_When=input.string(group=inputGroupTP1,title='Trig',defval='OFF',options=['ON','OFF'],inline='TP-1')
inputGroupTP1_Type=input.string(group=inputGroupTP1,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='TP-1')
inputGroupTP1_QtyPer=input.float(group=inputGroupTP1,title='Pos%',defval=33.33,inline='TP-1')
inputGroupTP1_Stick=input.string(group=inputGroupTP1,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='TP-1-GP')
inputGroupTP1_Src=input.string(group=inputGroupTP1,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='TP-1-GP')
inputGroupTP1_HL=input.bool(group=inputGroupTP1,title='',defval=false,inline='TP-1-GP')
inputGroupTP1_LB=input.int(group=inputGroupTP1,title='HL',defval=10,inline='TP-1-GP')
inputGroupTP1_Meth=input.string(group=inputGroupTP1,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-1-DP')
inputGroupTP1_Val=input.float(group=inputGroupTP1,title='Val/x',defval=0.0,inline='TP-1-DP')
inputGroupTP1_Len=input.int(group=inputGroupTP1,title='Len',defval=10,inline='TP-1-DP')
inputGroupTP1_Trail=input.bool(group=inputGroupTP1,title='Trailingstop',defval=false,inline='TP-T-1-DP')
inputGroupTP1_TS_Meth=input.string(group=inputGroupTP1,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-1-T-DP')
inputGroupTP1_TS_Val=input.float(group=inputGroupTP1,title='Val/x',defval=0.0,inline='TP-1-T-DP')
inputGroupTP1_TS_Len=input.int(group=inputGroupTP1,title='Len',defval=10,inline='TP-1-T-DP')
varinputGroupTP2='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸŸ¢â›³TargetProfit|ðŸ2-SECONDðŸŸ¢ðŸ”¸'
inputGroupTP2_When=input.string(group=inputGroupTP2,title='Trig',defval='OFF',options=['ON','OFF'],inline='TP-2')
inputGroupTP2_Type=input.string(group=inputGroupTP2,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='TP-2')
inputGroupTP2_QtyPer=input.float(group=inputGroupTP2,title='Pos%',defval=33.33,inline='TP-2')
inputGroupTP2_Stick=input.string(group=inputGroupTP2,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='TP-2-GP')
inputGroupTP2_Src=input.string(group=inputGroupTP2,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='TP-2-GP')
inputGroupTP2_HL=input.bool(group=inputGroupTP2,title='',defval=false,inline='TP-2-GP')
inputGroupTP2_LB=input.int(group=inputGroupTP2,title='HL',defval=10,inline='TP-2-GP')
inputGroupTP2_Meth=input.string(group=inputGroupTP2,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-2-DP')
inputGroupTP2_Val=input.float(group=inputGroupTP2,title='Val/x',defval=0.0,inline='TP-2-DP')
inputGroupTP2_Len=input.int(group=inputGroupTP2,title='Len',defval=10,inline='TP-2-DP')
inputGroupTP2_Trail=input.bool(group=inputGroupTP2,title='Trailingstop',defval=false,inline='TP-T-2-DP')
inputGroupTP2_TS_Meth=input.string(group=inputGroupTP2,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-2-T-DP')
inputGroupTP2_TS_Val=input.float(group=inputGroupTP2,title='Val/x',defval=0.0,inline='TP-2-T-DP')
inputGroupTP2_TS_Len=input.int(group=inputGroupTP2,title='Len',defval=10,inline='TP-2-T-DP')
varinputGroupTP3='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸŸ¢â›³TargetProfit|ðŸ3-THIRDðŸŸ¢ðŸ”¸'
inputGroupTP3_When=input.string(group=inputGroupTP3,title='Trig',defval='OFF',options=['ON','OFF'],inline='TP-3')
inputGroupTP3_Type=input.string(group=inputGroupTP3,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='TP-3')
inputGroupTP3_QtyPer=input.float(group=inputGroupTP3,title='Pos%',defval=33.33,inline='TP-3')
inputGroupTP3_Stick=input.string(group=inputGroupTP3,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='TP-3-GP')
inputGroupTP3_Src=input.string(group=inputGroupTP3,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='TP-3-GP')
inputGroupTP3_HL=input.bool(group=inputGroupTP3,title='',defval=false,inline='TP-3-GP')
inputGroupTP3_LB=input.int(group=inputGroupTP3,title='HL',defval=10,inline='TP-3-GP')
inputGroupTP3_Meth=input.string(group=inputGroupTP3,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-3-DP')
inputGroupTP3_Val=input.float(group=inputGroupTP3,title='Val/x',defval=0.0,inline='TP-3-DP')
inputGroupTP3_Len=input.int(group=inputGroupTP3,title='Len',defval=10,inline='TP-3-DP')
inputGroupTP3_Trail=input.bool(group=inputGroupTP3,title='Trailingstop',defval=false,inline='TP-T-3-DP')
inputGroupTP3_TS_Meth=input.string(group=inputGroupTP3,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-3-T-DP')
inputGroupTP3_TS_Val=input.float(group=inputGroupTP3,title='Val/x',defval=0.0,inline='TP-3-T-DP')
inputGroupTP3_TS_Len=input.int(group=inputGroupTP3,title='Len',defval=10,inline='TP-3-T-DP')
varinputGroupTP4='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸŸ¢â›³TargetProfit|ðŸ4-FOURTHðŸŸ¢ðŸ”¸'
inputGroupTP4_When=input.string(group=inputGroupTP4,title='Trig',defval='OFF',options=['ON','OFF'],inline='TP-4')
inputGroupTP4_Type=input.string(group=inputGroupTP4,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='TP-4')
inputGroupTP4_QtyPer=input.float(group=inputGroupTP4,title='Pos%',defval=33.33,inline='TP-4')
inputGroupTP4_Stick=input.string(group=inputGroupTP4,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='TP-4-GP')
inputGroupTP4_Src=input.string(group=inputGroupTP4,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='TP-4-GP')
inputGroupTP4_HL=input.bool(group=inputGroupTP4,title='',defval=false,inline='TP-4-GP')
inputGroupTP4_LB=input.int(group=inputGroupTP4,title='HL',defval=10,inline='TP-4-GP')
inputGroupTP4_Meth=input.string(group=inputGroupTP4,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-4-DP')
inputGroupTP4_Val=input.float(group=inputGroupTP4,title='Val/x',defval=0.0,inline='TP-4-DP')
inputGroupTP4_Len=input.int(group=inputGroupTP4,title='Len',defval=10,inline='TP-4-DP')
inputGroupTP4_Trail=input.bool(group=inputGroupTP4,title='Trailingstop',defval=false,inline='TP-T-4-DP')
inputGroupTP4_TS_Meth=input.string(group=inputGroupTP4,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-4-T-DP')
inputGroupTP4_TS_Val=input.float(group=inputGroupTP4,title='Val/x',defval=0.0,inline='TP-4-T-DP')
inputGroupTP4_TS_Len=input.int(group=inputGroupTP4,title='Len',defval=10,inline='TP-4-T-DP')
varinputGroupTP5='â€ƒâ€ƒâ€ƒâ€ƒâ€ƒâ€ƒðŸ”¸ðŸŸ¢â›³TargetProfit|ðŸ5-FIFTHðŸŸ¢ðŸ”¸'
inputGroupTP5_When=input.string(group=inputGroupTP5,title='Trig',defval='OFF',options=['ON','OFF'],inline='TP-5')
inputGroupTP5_Type=input.string(group=inputGroupTP5,title='Type',defval='Trailing',options=['Fixed','Trailing'],inline='TP-5')
inputGroupTP5_QtyPer=input.float(group=inputGroupTP5,title='Pos%',defval=33.33,inline='TP-5')
inputGroupTP5_Stick=input.string(group=inputGroupTP5,title='Cdl',defval='Candle',options=['Candle','Heikin'],inline='TP-5-GP')
inputGroupTP5_Src=input.string(group=inputGroupTP5,title='Src',defval='close',options=['open','high','low','close','hl2','hlc3','ohlc4','hlcc4','HH','LL'],inline='TP-5-GP')
inputGroupTP5_HL=input.bool(group=inputGroupTP5,title='',defval=false,inline='TP-5-GP')
inputGroupTP5_LB=input.int(group=inputGroupTP5,title='HL',defval=10,inline='TP-5-GP')
inputGroupTP5_Meth=input.string(group=inputGroupTP5,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-5-DP')
inputGroupTP5_Val=input.float(group=inputGroupTP5,title='Val/x',defval=0.0,inline='TP-5-DP')
inputGroupTP5_Len=input.int(group=inputGroupTP5,title='Len',defval=10,inline='TP-5-DP')
inputGroupTP5_Trail=input.bool(group=inputGroupTP5,title='Trailingstop',defval=false,inline='TP-T-5-DP')
inputGroupTP5_TS_Meth=input.string(group=inputGroupTP5,title='Meth',defval='%',options=['%','PIPS','ATR'],inline='TP-5-T-DP')
inputGroupTP5_TS_Val=input.float(group=inputGroupTP5,title='Val/x',defval=0.0,inline='TP-5-T-DP')
inputGroupTP5_TS_Len=input.int(group=inputGroupTP5,title='Len',defval=10,inline='TP-5-T-DP')
//==================================//
//----->InvariableConstants<-----//
//==================================//
FLAT=strategy.position_size==0
LONG=strategy.position_size>0
SHORT=strategy.position_size<0
POSITION=strategy.position_size
CONFIRMED=(tradeConfirm?barstate.isconfirmed:true)
AVGPRICE=strategy.position_avg_price
ISLONGWAY=wayTradeType=='Short'?false:true
//==================================//
//------------>Variable<----------//
//==================================//
validOpenCondition=false
validCloseCondition=false
//==================================//
//----------->Functions<----------//
//==================================//
src(_isBelow,_source,_stick,_hl,_lookback)=>
isCandle=_stick=='Heikin'?false:true
Close=isCandle?close:ohlc4
Open=float(na)
Open:=isCandle?open:na(Open[1])?(open+close)/2:(nz(Open[1])+nz(Close[1]))/2
High=isCandle?high:math.max(high,math.max(Open,Close))
Low=isCandle?low:math.min(low,math.min(Open,Close))
HL2=isCandle?hl2:math.avg(High,Low)
HLC3=isCandle?hlc3:math.avg(High,Low,Close)
OHLC4=isCandle?ohlc4:math.avg(Open,High,Low,Close)
HH=ta.highest(High,_lookback<1?1:_lookback)
LL=ta.lowest(Low,_lookback<1?1:_lookback)
Price=_source=='close'?Close:_source=='open'?Open:_source=='high'?High:_source=='low'?Low:_source=='hl2'?+
HL2:_source=='hlc3'?HLC3:_source=='ohlc4'?OHLC4:na
if_hl
Price:=_isBelow?LL:HH
Source=math.round(Price/syminfo.mintick)*syminfo.mintick
getPrice(_isBelow,_src,_method,_value,_len)=>
switch_method
'%'=>_isBelow?_src*(1-_value*0.01):_src*(1+_value*0.01)
'PIPS'=>_isBelow?_src-_value:_src+_value
'ATR'=>_isBelow?_src-ta.atr(_len)*_value:_src+ta.atr(_len)*_value
getTargetPrice(_isBelow,_currentPrice,_previousPrice,_isFix,_openCondition)=>
_openCondition?_isFix?nz(_previousPrice,_currentPrice):_isBelow?math.max(_currentPrice,nz(_previousPrice,_currentPrice)):math.min(_currentPrice,nz(_previousPrice,_currentPrice)):na

isPriceTargetted(_isBelow,_price)=>
(_isBelowandlow<=_priceandnotna(_price))or(not_isBelowandhigh>=_priceandnotna(_price))
//====================================================================================================================//
//====================================================================================================================//
//====================================================================================================================//
//------------------------ðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“Œ>YOURSTRATEGYHERE<ðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“ŒðŸ“Œ----------------//
//-------------------------------JustsetEntryandExitdependingandtradingway---------------------------------//
//===================================================================================================================//
//====================================================================================================================//
//====================================================================================================================//
openCondition=ta.crossover(ta.sma(close,14),ta.sma(close,28))
closeCondition=false
//====================================================================================================================//
//====================================================================================================================//
//====================================================================================================================//
//===================================================================================================================//
//====================================================================================================================//
//=======================================================//
//------------------->StrategyLogic<-----------------//
//=======================================================//
varcanTrade=false
canTrade:=CONFIRMED
canTrade:=canTradeand(notstartTimeEnableortime>=startTime)and(notendTimeEnableortime<=endTime)
canTrade:=canTradeand((dayMonTradeanddayofweek==dayofweek.monday?true:false)or(dayTueTradeanddayofweek==dayofweek.tuesday?true:false)or(dayWedTradeanddayofweek==dayofweek.wednesday?true:false)or(dayThuTradeanddayofweek==dayofweek.thursday?true:false)or(dayFriTradeanddayofweek==dayofweek.friday?true:false)or(daySatTradeanddayofweek==dayofweek.saturday?true:false)or(daySunTradeanddayofweek==dayofweek.sunday?true:false))
canTrade:=canTradeand(useSessionFilter?time(timeframe.period,hoursToFilter):true)
validOpenCondition:=canTradeandopenConditionandFLAT
validCloseCondition:=CONFIRMEDandcloseConditionandnotFLAT
//=======================================================//
//------------------>DefineTAKEPRODIT<--------------//
//=======================================================//
//---TakeProfit1---
variptakeProfit1_id=0
stringtakeProfit1_Name='TakeProfit1-'+str.tostring(takeProfit1_id)
floattakeProfit1_Price=na
booltakeProfit1_Hit=false
takeProfit1_id:=(takeProfit1_Hit[1]andnotinputGroupTP1_Trail)or(strategy.position_size[1]!=0andFLAT)?nottakeProfit1_Hit[2]?takeProfit1_id+1:takeProfit1_id:takeProfit1_id
takeProfit1_Src=src(notISLONGWAY,inputGroupTP1_Src,inputGroupTP1_Stick,inputGroupTP1_HL,inputGroupTP1_LB)
takeProfit1_CurrentPrice=getPrice(notISLONGWAY,takeProfit1_Src,inputGroupTP1_Meth,inputGroupTP1_Val,inputGroupTP1_Len)
takeProfit1_ExecCondition=nottakeProfit1_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupTP1_When=="ON"))
takeProfit1_Price:=getTargetPrice(notISLONGWAY,takeProfit1_CurrentPrice,takeProfit1_Price[1],inputGroupTP1_Type=='Fixed',takeProfit1_ExecCondition)
takeProfit1_Hit:=inputGroupTP1_Trail?takeProfit1_Hit[1]andnotFLAT:(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit1_Name))ortakeProfit1_Hit[1])andnotFLAT
takeProfit1_ExecCondition:=takeProfit1_ExecConditionandnottakeProfit1_Hit
//---TakeProfit1-TrailingStop
if(ISLONGWAY?math.max(open,close,low,high)>=takeProfit1_Price[1]:math.min(open,close,low,high)<=takeProfit1_Price[1])andtakeProfit1_ExecCondition
takeProfit1_Hit:=true
variptakeProfit1TS_id=0
stringtakeProfit1TS_Name='TakeProfit1-TrailingStop-'+str.tostring(takeProfit1TS_id)
floattakeProfit1TS_Price=na
booltakeProfit1TS_Hit=false
takeProfit1TS_id:=takeProfit1TS_Hit[1]or(strategy.position_size[1]!=0andFLAT)?nottakeProfit1TS_Hit[2]?takeProfit1TS_id+1:takeProfit1TS_id:takeProfit1TS_id
takeProfit1TS_CurrentPrice=getPrice(ISLONGWAY,nz(takeProfit1_Price[1],close),inputGroupTP1_TS_Meth,inputGroupTP1_TS_Val,inputGroupTP1_TS_Len)
takeProfit1TS_ExecCondition=nottakeProfit1TS_Hit[1]and((notFLAT)andCONFIRMEDandinputGroupTP1_TrailandtakeProfit1_Hit)
takeProfit1TS_Price:=getTargetPrice(ISLONGWAY,takeProfit1TS_CurrentPrice,takeProfit1TS_Price[1],false,takeProfit1TS_ExecCondition)
takeProfit1TS_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit1TS_Name))ortakeProfit1TS_Hit[1])andnotFLAT
takeProfit1TS_ExecCondition:=takeProfit1TS_ExecConditionandnottakeProfit1TS_Hit
//---TakeProfit2---
variptakeProfit2_id=0
stringtakeProfit2_Name='TakeProfit2-'+str.tostring(takeProfit2_id)
floattakeProfit2_Price=na
booltakeProfit2_Hit=false
takeProfit2_id:=(takeProfit2_Hit[1]andnotinputGroupTP2_Trail)or(strategy.position_size[1]!=0andFLAT)?nottakeProfit2_Hit[2]?takeProfit2_id+1:takeProfit2_id:takeProfit2_id
takeProfit2_Src=src(notISLONGWAY,inputGroupTP2_Src,inputGroupTP2_Stick,inputGroupTP2_HL,inputGroupTP2_LB)
takeProfit2_CurrentPrice=getPrice(notISLONGWAY,takeProfit2_Src,inputGroupTP2_Meth,inputGroupTP2_Val,inputGroupTP2_Len)
takeProfit2_ExecCondition=nottakeProfit2_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupTP2_When=="ON"))
takeProfit2_Price:=getTargetPrice(notISLONGWAY,takeProfit2_CurrentPrice,takeProfit2_Price[1],inputGroupTP2_Type=='Fixed',takeProfit2_ExecCondition)
takeProfit2_Hit:=inputGroupTP2_Trail?takeProfit2_Hit[1]andnotFLAT:(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit2_Name))ortakeProfit2_Hit[1])andnotFLAT
takeProfit2_ExecCondition:=takeProfit2_ExecConditionandnottakeProfit2_Hit
//---TakeProfit2-TrailingStop
if(ISLONGWAY?math.max(open,close,low,high)>=takeProfit2_Price[1]:math.min(open,close,low,high)<=takeProfit2_Price[1])andtakeProfit2_ExecCondition
takeProfit2_Hit:=true
variptakeProfit2TS_id=0
stringtakeProfit2TS_Name='TakeProfit2-TrailingStop-'+str.tostring(takeProfit2TS_id)
floattakeProfit2TS_Price=na
booltakeProfit2TS_Hit=false
takeProfit2TS_id:=takeProfit2TS_Hit[1]or(strategy.position_size[1]!=0andFLAT)?nottakeProfit2TS_Hit[2]?takeProfit2TS_id+1:takeProfit2TS_id:takeProfit2TS_id
takeProfit2TS_CurrentPrice=getPrice(ISLONGWAY,nz(takeProfit2_Price[1],close),inputGroupTP2_TS_Meth,inputGroupTP2_TS_Val,inputGroupTP2_TS_Len)
takeProfit2TS_ExecCondition=nottakeProfit2TS_Hit[1]and((notFLAT)andCONFIRMEDandinputGroupTP2_TrailandtakeProfit2_Hit)
takeProfit2TS_Price:=getTargetPrice(ISLONGWAY,takeProfit2TS_CurrentPrice,takeProfit2TS_Price[1],false,takeProfit2TS_ExecCondition)
takeProfit2TS_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit2TS_Name))ortakeProfit2TS_Hit[1])andnotFLAT
takeProfit2TS_ExecCondition:=takeProfit2TS_ExecConditionandnottakeProfit2TS_Hit
//---TakeProfit3---
variptakeProfit3_id=0
stringtakeProfit3_Name='TakeProfit3-'+str.tostring(takeProfit3_id)
floattakeProfit3_Price=na
booltakeProfit3_Hit=false
takeProfit3_id:=(takeProfit3_Hit[1]andnotinputGroupTP3_Trail)or(strategy.position_size[1]!=0andFLAT)?nottakeProfit3_Hit[2]?takeProfit3_id+1:takeProfit3_id:takeProfit3_id
takeProfit3_Src=src(notISLONGWAY,inputGroupTP3_Src,inputGroupTP3_Stick,inputGroupTP3_HL,inputGroupTP3_LB)
takeProfit3_CurrentPrice=getPrice(notISLONGWAY,takeProfit3_Src,inputGroupTP3_Meth,inputGroupTP3_Val,inputGroupTP3_Len)
takeProfit3_ExecCondition=nottakeProfit3_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupTP3_When=="ON"))
takeProfit3_Price:=getTargetPrice(notISLONGWAY,takeProfit3_CurrentPrice,takeProfit3_Price[1],inputGroupTP3_Type=='Fixed',takeProfit3_ExecCondition)
takeProfit3_Hit:=inputGroupTP3_Trail?takeProfit3_Hit[1]andnotFLAT:(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit3_Name))ortakeProfit3_Hit[1])andnotFLAT
takeProfit3_ExecCondition:=takeProfit3_ExecConditionandnottakeProfit3_Hit
//---TakeProfit3-TrailingStop
if(ISLONGWAY?math.max(open,close,low,high)>=takeProfit3_Price[1]:math.min(open,close,low,high)<=takeProfit3_Price[1])andtakeProfit3_ExecCondition
takeProfit3_Hit:=true
variptakeProfit3TS_id=0
stringtakeProfit3TS_Name='TakeProfit3-TrailingStop-'+str.tostring(takeProfit3TS_id)
floattakeProfit3TS_Price=na
booltakeProfit3TS_Hit=false
takeProfit3TS_id:=takeProfit3TS_Hit[1]or(strategy.position_size[1]!=0andFLAT)?nottakeProfit3TS_Hit[2]?takeProfit3TS_id+1:takeProfit3TS_id:takeProfit3TS_id
takeProfit3TS_CurrentPrice=getPrice(ISLONGWAY,nz(takeProfit3_Price[1],close),inputGroupTP3_TS_Meth,inputGroupTP3_TS_Val,inputGroupTP3_TS_Len)
takeProfit3TS_ExecCondition=nottakeProfit3TS_Hit[1]and((notFLAT)andCONFIRMEDandinputGroupTP3_TrailandtakeProfit3_Hit)
takeProfit3TS_Price:=getTargetPrice(ISLONGWAY,takeProfit3TS_CurrentPrice,takeProfit3TS_Price[1],false,takeProfit3TS_ExecCondition)
takeProfit3TS_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit3TS_Name))ortakeProfit3TS_Hit[1])andnotFLAT
takeProfit3TS_ExecCondition:=takeProfit3TS_ExecConditionandnottakeProfit3TS_Hit
//---TakeProfit4---
variptakeProfit4_id=0
stringtakeProfit4_Name='TakeProfit4-'+str.tostring(takeProfit4_id)
floattakeProfit4_Price=na
booltakeProfit4_Hit=false
takeProfit4_id:=(takeProfit4_Hit[1]andnotinputGroupTP4_Trail)or(strategy.position_size[1]!=0andFLAT)?nottakeProfit4_Hit[2]?takeProfit4_id+1:takeProfit4_id:takeProfit4_id
takeProfit4_Src=src(notISLONGWAY,inputGroupTP4_Src,inputGroupTP4_Stick,inputGroupTP4_HL,inputGroupTP4_LB)
takeProfit4_CurrentPrice=getPrice(notISLONGWAY,takeProfit4_Src,inputGroupTP4_Meth,inputGroupTP4_Val,inputGroupTP4_Len)
takeProfit4_ExecCondition=nottakeProfit4_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupTP4_When=="ON"))
takeProfit4_Price:=getTargetPrice(notISLONGWAY,takeProfit4_CurrentPrice,takeProfit4_Price[1],inputGroupTP4_Type=='Fixed',takeProfit4_ExecCondition)
takeProfit4_Hit:=inputGroupTP4_Trail?takeProfit4_Hit[1]andnotFLAT:(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit4_Name))ortakeProfit4_Hit[1])andnotFLAT
takeProfit4_ExecCondition:=takeProfit4_ExecConditionandnottakeProfit4_Hit
//---TakeProfit4-TrailingStop
if(ISLONGWAY?math.max(open,close,low,high)>=takeProfit4_Price[1]:math.min(open,close,low,high)<=takeProfit4_Price[1])andtakeProfit4_ExecCondition
takeProfit4_Hit:=true
variptakeProfit4TS_id=0
stringtakeProfit4TS_Name='TakeProfit4-TrailingStop-'+str.tostring(takeProfit4TS_id)
floattakeProfit4TS_Price=na
booltakeProfit4TS_Hit=false
takeProfit4TS_id:=takeProfit4TS_Hit[1]or(strategy.position_size[1]!=0andFLAT)?nottakeProfit4TS_Hit[2]?takeProfit4TS_id+1:takeProfit4TS_id:takeProfit4TS_id
takeProfit4TS_CurrentPrice=getPrice(ISLONGWAY,nz(takeProfit4_Price[1],close),inputGroupTP4_TS_Meth,inputGroupTP4_TS_Val,inputGroupTP4_TS_Len)
takeProfit4TS_ExecCondition=nottakeProfit4TS_Hit[1]and((notFLAT)andCONFIRMEDandinputGroupTP4_TrailandtakeProfit4_Hit)
takeProfit4TS_Price:=getTargetPrice(ISLONGWAY,takeProfit4TS_CurrentPrice,takeProfit4TS_Price[1],false,takeProfit4TS_ExecCondition)
takeProfit4TS_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit4TS_Name))ortakeProfit4TS_Hit[1])andnotFLAT
takeProfit4TS_ExecCondition:=takeProfit4TS_ExecConditionandnottakeProfit4TS_Hit
//---TakeProfit5---
variptakeProfit5_id=0
stringtakeProfit5_Name='TakeProfit5-'+str.tostring(takeProfit5_id)
floattakeProfit5_Price=na
booltakeProfit5_Hit=false
takeProfit5_id:=(takeProfit5_Hit[1]andnotinputGroupTP5_Trail)or(strategy.position_size[1]!=0andFLAT)?nottakeProfit5_Hit[2]?takeProfit5_id+1:takeProfit5_id:takeProfit5_id
takeProfit5_Src=src(notISLONGWAY,inputGroupTP5_Src,inputGroupTP5_Stick,inputGroupTP5_HL,inputGroupTP5_LB)
takeProfit5_CurrentPrice=getPrice(notISLONGWAY,takeProfit5_Src,inputGroupTP5_Meth,inputGroupTP5_Val,inputGroupTP5_Len)
takeProfit5_ExecCondition=nottakeProfit5_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupTP5_When=="ON"))
takeProfit5_Price:=getTargetPrice(notISLONGWAY,takeProfit5_CurrentPrice,takeProfit5_Price[1],inputGroupTP5_Type=='Fixed',takeProfit5_ExecCondition)
takeProfit5_Hit:=inputGroupTP5_Trail?takeProfit5_Hit[1]andnotFLAT:(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit5_Name))ortakeProfit5_Hit[1])andnotFLAT
takeProfit5_ExecCondition:=takeProfit5_ExecConditionandnottakeProfit5_Hit
//---TakeProfit5-TrailingStop
if(ISLONGWAY?math.max(open,close,low,high)>=takeProfit5_Price[1]:math.min(open,close,low,high)<=takeProfit5_Price[1])andtakeProfit5_ExecCondition
takeProfit5_Hit:=true
variptakeProfit5TS_id=0
stringtakeProfit5TS_Name='TakeProfit5-TrailingStop-'+str.tostring(takeProfit5TS_id)
floattakeProfit5TS_Price=na
booltakeProfit5TS_Hit=false
takeProfit5TS_id:=takeProfit5TS_Hit[1]or(strategy.position_size[1]!=0andFLAT)?nottakeProfit5TS_Hit[2]?takeProfit5TS_id+1:takeProfit5TS_id:takeProfit5TS_id
takeProfit5TS_CurrentPrice=getPrice(ISLONGWAY,nz(takeProfit5_Price[1],close),inputGroupTP5_TS_Meth,inputGroupTP5_TS_Val,inputGroupTP5_TS_Len)
takeProfit5TS_ExecCondition=nottakeProfit5TS_Hit[1]and((notFLAT)andCONFIRMEDandinputGroupTP5_TrailandtakeProfit5_Hit)
takeProfit5TS_Price:=getTargetPrice(ISLONGWAY,takeProfit5TS_CurrentPrice,takeProfit5TS_Price[1],false,takeProfit5TS_ExecCondition)
takeProfit5TS_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==takeProfit5TS_Name))ortakeProfit5TS_Hit[1])andnotFLAT
takeProfit5TS_ExecCondition:=takeProfit5TS_ExecConditionandnottakeProfit5TS_Hit
//=======================================================//
//------------------>DefineSTOPLOSS<---------------//
//=======================================================//
//---StopLoss1---
varipstopLoss1_id=0
stringstopLoss1_Name='StopLoss1-'+str.tostring(stopLoss1_id)
floatstopLoss1_Price=na
boolstopLoss1_Hit=false
stopLoss1_id:=stopLoss1_Hit[1]or(strategy.position_size[1]!=0andFLAT)?notstopLoss1_Hit[2]?stopLoss1_id+1:stopLoss1_id:stopLoss1_id
stopLoss1_Src=src(ISLONGWAY,inputGroupSL1_Src,inputGroupSL1_Stick,inputGroupSL1_HL,inputGroupSL1_LB)
stopLoss1_CurrentPrice=getPrice(ISLONGWAY,stopLoss1_Src,inputGroupSL1_Meth,inputGroupSL1_Val,inputGroupSL1_Len)
stopLoss1_ExecCondition=notstopLoss1_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupSL1_When=="ON")or(inputGroupSL1_When=="TP1"andtakeProfit1_Hit)or(inputGroupSL1_When=="TP1TS"andtakeProfit1TS_Hit)or(inputGroupSL1_When=="TP2"andtakeProfit2_Hit)or(inputGroupSL1_When=="TP2TS"andtakeProfit2TS_Hit)or(inputGroupSL1_When=="TP3"andtakeProfit3_Hit)or(inputGroupSL1_When=="TP3TS"andtakeProfit3TS_Hit)or(inputGroupSL1_When=="TP4"andtakeProfit4_Hit)or(inputGroupSL1_When=="TP4TS"andtakeProfit4TS_Hit)or(inputGroupSL1_When=="TP5"andtakeProfit5_Hit)or(inputGroupSL1_When=="TP5TS"andtakeProfit5TS_Hit))
stopLoss1_Price:=getTargetPrice(ISLONGWAY,stopLoss1_CurrentPrice,stopLoss1_Price[1],inputGroupSL1_Type=='Fixed',stopLoss1_ExecCondition)
stopLoss1_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==stopLoss1_Name))orstopLoss1_Hit[1])andnotFLAT
stopLoss1_ExecCondition:=stopLoss1_ExecConditionandnotstopLoss1_Hit
//---StopLoss2---
varipstopLoss2_id=0
stringstopLoss2_Name='StopLoss2-'+str.tostring(stopLoss2_id)
floatstopLoss2_Price=na
boolstopLoss2_Hit=false
stopLoss2_id:=stopLoss2_Hit[1]or(strategy.position_size[1]!=0andFLAT)?notstopLoss2_Hit[2]?stopLoss2_id+1:stopLoss2_id:stopLoss2_id
stopLoss2_Src=src(ISLONGWAY,inputGroupSL2_Src,inputGroupSL2_Stick,inputGroupSL2_HL,inputGroupSL2_LB)
stopLoss2_CurrentPrice=getPrice(ISLONGWAY,stopLoss2_Src,inputGroupSL2_Meth,inputGroupSL2_Val,inputGroupSL2_Len)
stopLoss2_ExecCondition=notstopLoss2_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupSL2_When=="ON")or(inputGroupSL2_When=="TP1"andtakeProfit1_Hit)or(inputGroupSL2_When=="TP1TS"andtakeProfit1TS_Hit)or(inputGroupSL2_When=="TP2"andtakeProfit2_Hit)or(inputGroupSL2_When=="TP2TS"andtakeProfit2TS_Hit)or(inputGroupSL2_When=="TP3"andtakeProfit3_Hit)or(inputGroupSL2_When=="TP3TS"andtakeProfit3TS_Hit)or(inputGroupSL2_When=="TP4"andtakeProfit4_Hit)or(inputGroupSL2_When=="TP4TS"andtakeProfit4TS_Hit)or(inputGroupSL2_When=="TP5"andtakeProfit5_Hit)or(inputGroupSL2_When=="TP5TS"andtakeProfit5TS_Hit))
stopLoss2_Price:=getTargetPrice(ISLONGWAY,stopLoss2_CurrentPrice,stopLoss2_Price[1],inputGroupSL2_Type=='Fixed',stopLoss2_ExecCondition)
stopLoss2_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==stopLoss2_Name))orstopLoss2_Hit[1])andnotFLAT
stopLoss2_ExecCondition:=stopLoss2_ExecConditionandnotstopLoss2_Hit
//---StopLoss3---
varipstopLoss3_id=0
stringstopLoss3_Name='StopLoss3-'+str.tostring(stopLoss3_id)
floatstopLoss3_Price=na
boolstopLoss3_Hit=false
stopLoss3_id:=stopLoss3_Hit[1]or(strategy.position_size[1]!=0andFLAT)?notstopLoss3_Hit[2]?stopLoss3_id+1:stopLoss3_id:stopLoss3_id
stopLoss3_Src=src(ISLONGWAY,inputGroupSL3_Src,inputGroupSL3_Stick,inputGroupSL3_HL,inputGroupSL3_LB)
stopLoss3_CurrentPrice=getPrice(ISLONGWAY,stopLoss3_Src,inputGroupSL3_Meth,inputGroupSL3_Val,inputGroupSL3_Len)
stopLoss3_ExecCondition=notstopLoss3_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupSL3_When=="ON")or(inputGroupSL3_When=="TP1"andtakeProfit1_Hit)or(inputGroupSL3_When=="TP1TS"andtakeProfit1TS_Hit)or(inputGroupSL3_When=="TP2"andtakeProfit2_Hit)or(inputGroupSL3_When=="TP2TS"andtakeProfit2TS_Hit)or(inputGroupSL3_When=="TP3"andtakeProfit3_Hit)or(inputGroupSL3_When=="TP3TS"andtakeProfit3TS_Hit)or(inputGroupSL3_When=="TP4"andtakeProfit4_Hit)or(inputGroupSL3_When=="TP4TS"andtakeProfit4TS_Hit)or(inputGroupSL3_When=="TP5"andtakeProfit5_Hit)or(inputGroupSL3_When=="TP5TS"andtakeProfit5TS_Hit))
stopLoss3_Price:=getTargetPrice(ISLONGWAY,stopLoss3_CurrentPrice,stopLoss3_Price[1],inputGroupSL3_Type=='Fixed',stopLoss3_ExecCondition)
stopLoss3_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==stopLoss3_Name))orstopLoss3_Hit[1])andnotFLAT
stopLoss3_ExecCondition:=stopLoss3_ExecConditionandnotstopLoss3_Hit
//---StopLoss4---
varipstopLoss4_id=0
stringstopLoss4_Name='StopLoss4-'+str.tostring(stopLoss4_id)
floatstopLoss4_Price=na
boolstopLoss4_Hit=false
stopLoss4_id:=stopLoss4_Hit[1]or(strategy.position_size[1]!=0andFLAT)?notstopLoss4_Hit[2]?stopLoss4_id+1:stopLoss4_id:stopLoss4_id
stopLoss4_Src=src(ISLONGWAY,inputGroupSL4_Src,inputGroupSL4_Stick,inputGroupSL4_HL,inputGroupSL4_LB)
stopLoss4_CurrentPrice=getPrice(ISLONGWAY,stopLoss4_Src,inputGroupSL4_Meth,inputGroupSL4_Val,inputGroupSL4_Len)
stopLoss4_ExecCondition=notstopLoss4_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupSL4_When=="ON")or(inputGroupSL4_When=="TP1"andtakeProfit1_Hit)or(inputGroupSL4_When=="TP1TS"andtakeProfit1TS_Hit)or(inputGroupSL4_When=="TP2"andtakeProfit2_Hit)or(inputGroupSL4_When=="TP2TS"andtakeProfit2TS_Hit)or(inputGroupSL4_When=="TP3"andtakeProfit3_Hit)or(inputGroupSL4_When=="TP3TS"andtakeProfit3TS_Hit)or(inputGroupSL4_When=="TP4"andtakeProfit4_Hit)or(inputGroupSL4_When=="TP4TS"andtakeProfit4TS_Hit)or(inputGroupSL4_When=="TP5"andtakeProfit5_Hit)or(inputGroupSL4_When=="TP5TS"andtakeProfit5TS_Hit))
stopLoss4_Price:=getTargetPrice(ISLONGWAY,stopLoss4_CurrentPrice,stopLoss4_Price[1],inputGroupSL4_Type=='Fixed',stopLoss4_ExecCondition)
stopLoss4_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==stopLoss4_Name))orstopLoss4_Hit[1])andnotFLAT
stopLoss4_ExecCondition:=stopLoss4_ExecConditionandnotstopLoss4_Hit
//---StopLoss5---
varipstopLoss5_id=0
stringstopLoss5_Name='StopLoss5-'+str.tostring(stopLoss5_id)
floatstopLoss5_Price=na
boolstopLoss5_Hit=false
stopLoss5_id:=stopLoss5_Hit[1]or(strategy.position_size[1]!=0andFLAT)?notstopLoss5_Hit[2]?stopLoss5_id+1:stopLoss5_id:stopLoss5_id
stopLoss5_Src=src(ISLONGWAY,inputGroupSL5_Src,inputGroupSL5_Stick,inputGroupSL5_HL,inputGroupSL5_LB)
stopLoss5_CurrentPrice=getPrice(ISLONGWAY,stopLoss5_Src,inputGroupSL5_Meth,inputGroupSL5_Val,inputGroupSL5_Len)
stopLoss5_ExecCondition=notstopLoss5_Hit[1]and((notFLAT)andCONFIRMEDand(inputGroupSL5_When=="ON")or(inputGroupSL5_When=="TP1"andtakeProfit1_Hit)or(inputGroupSL5_When=="TP1TS"andtakeProfit1TS_Hit)or(inputGroupSL5_When=="TP2"andtakeProfit2_Hit)or(inputGroupSL5_When=="TP2TS"andtakeProfit2TS_Hit)or(inputGroupSL5_When=="TP3"andtakeProfit3_Hit)or(inputGroupSL5_When=="TP3TS"andtakeProfit3TS_Hit)or(inputGroupSL5_When=="TP4"andtakeProfit4_Hit)or(inputGroupSL5_When=="TP4TS"andtakeProfit4TS_Hit)or(inputGroupSL5_When=="TP5"andtakeProfit5_Hit)or(inputGroupSL5_When=="TP5TS"andtakeProfit5TS_Hit))
stopLoss5_Price:=getTargetPrice(ISLONGWAY,stopLoss5_CurrentPrice,stopLoss5_Price[1],inputGroupSL5_Type=='Fixed',stopLoss5_ExecCondition)
stopLoss5_Hit:=(((strategy.closedtrades.exit_id(strategy.closedtrades-1)==stopLoss5_Name))orstopLoss5_Hit[1])andnotFLAT
stopLoss5_ExecCondition:=stopLoss5_ExecConditionandnotstopLoss5_Hit
//=======================================================//
//----------------->StrategyExecution<---------------//
//=======================================================//
strategy.cancel_all()
strategy.close(id='Open',when=validCloseCondition)
strategy.entry(id='Open',direction=ISLONGWAY?strategy.long:strategy.short,when=validOpenCondition)
if(LONGandISLONGWAY)
strategy.order(takeProfit1_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit1_ExecConditionandnotinputGroupTP1_Trail,limit=takeProfit1_Price,qty=inputGroupTP1_QtyPer*0.01*POSITION)
strategy.order(takeProfit1TS_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit1TS_ExecConditionandinputGroupTP1_Trail,stop=takeProfit1TS_Price,qty=inputGroupTP1_QtyPer*0.01*POSITION)
strategy.order(takeProfit2_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit2_ExecConditionandnotinputGroupTP2_Trail,limit=takeProfit2_Price,qty=inputGroupTP2_QtyPer*0.01*POSITION)
strategy.order(takeProfit2TS_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit2TS_ExecConditionandinputGroupTP2_Trail,stop=takeProfit2TS_Price,qty=inputGroupTP2_QtyPer*0.01*POSITION)
strategy.order(takeProfit3_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit3_ExecConditionandnotinputGroupTP3_Trail,limit=takeProfit3_Price,qty=inputGroupTP3_QtyPer*0.01*POSITION)
strategy.order(takeProfit3TS_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit3TS_ExecConditionandinputGroupTP3_Trail,stop=takeProfit3TS_Price,qty=inputGroupTP3_QtyPer*0.01*POSITION)
strategy.order(takeProfit4_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit4_ExecConditionandnotinputGroupTP4_Trail,limit=takeProfit4_Price,qty=inputGroupTP4_QtyPer*0.01*POSITION)
strategy.order(takeProfit4TS_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit4TS_ExecConditionandinputGroupTP4_Trail,stop=takeProfit4TS_Price,qty=inputGroupTP4_QtyPer*0.01*POSITION)
strategy.order(takeProfit5_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit5_ExecConditionandnotinputGroupTP5_Trail,limit=takeProfit5_Price,qty=inputGroupTP5_QtyPer*0.01*POSITION)
strategy.order(takeProfit5TS_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit5TS_ExecConditionandinputGroupTP5_Trail,stop=takeProfit5TS_Price,qty=inputGroupTP5_QtyPer*0.01*POSITION)
strategy.order(stopLoss1_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss1_ExecCondition,stop=stopLoss1_Price,qty=inputGroupSL1_QtyPer*0.01*POSITION)
strategy.order(stopLoss2_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss2_ExecCondition,stop=stopLoss2_Price,qty=inputGroupSL2_QtyPer*0.01*POSITION)
strategy.order(stopLoss3_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss3_ExecCondition,stop=stopLoss3_Price,qty=inputGroupSL3_QtyPer*0.01*POSITION)
strategy.order(stopLoss4_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss4_ExecCondition,stop=stopLoss4_Price,qty=inputGroupSL4_QtyPer*0.01*POSITION)
strategy.order(stopLoss5_Name,strategy.short,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss5_ExecCondition,stop=stopLoss5_Price,qty=inputGroupSL5_QtyPer*0.01*POSITION)
if(SHORTandnotISLONGWAY)
strategy.order(takeProfit1_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit1_ExecConditionandnotinputGroupTP1_Trail,limit=takeProfit1_Price,qty=-inputGroupTP1_QtyPer*0.01*POSITION)
strategy.order(takeProfit1TS_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit1TS_ExecConditionandinputGroupTP1_Trail,stop=takeProfit1TS_Price,qty=-inputGroupTP1_QtyPer*0.01*POSITION)
strategy.order(takeProfit2_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit2_ExecConditionandnotinputGroupTP2_Trail,limit=takeProfit2_Price,qty=-inputGroupTP2_QtyPer*0.01*POSITION)
strategy.order(takeProfit2TS_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit2TS_ExecConditionandinputGroupTP2_Trail,stop=takeProfit2TS_Price,qty=-inputGroupTP2_QtyPer*0.01*POSITION)
strategy.order(takeProfit3_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit3_ExecConditionandnotinputGroupTP3_Trail,limit=takeProfit3_Price,qty=-inputGroupTP3_QtyPer*0.01*POSITION)
strategy.order(takeProfit3TS_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit3TS_ExecConditionandinputGroupTP3_Trail,stop=takeProfit3TS_Price,qty=-inputGroupTP3_QtyPer*0.01*POSITION)
strategy.order(takeProfit4_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit4_ExecConditionandnotinputGroupTP4_Trail,limit=takeProfit4_Price,qty=-inputGroupTP4_QtyPer*0.01*POSITION)
strategy.order(takeProfit4TS_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit4TS_ExecConditionandinputGroupTP4_Trail,stop=takeProfit4TS_Price,qty=-inputGroupTP4_QtyPer*0.01*POSITION)
strategy.order(takeProfit5_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit5_ExecConditionandnotinputGroupTP5_Trail,limit=takeProfit5_Price,qty=-inputGroupTP5_QtyPer*0.01*POSITION)
strategy.order(takeProfit5TS_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=takeProfit5TS_ExecConditionandinputGroupTP5_Trail,stop=takeProfit5TS_Price,qty=-inputGroupTP5_QtyPer*0.01*POSITION)
strategy.order(stopLoss1_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss1_ExecCondition,stop=stopLoss1_Price,qty=-inputGroupSL1_QtyPer*0.01*POSITION)
strategy.order(stopLoss2_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss2_ExecCondition,stop=stopLoss2_Price,qty=-inputGroupSL2_QtyPer*0.01*POSITION)
strategy.order(stopLoss3_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss3_ExecCondition,stop=stopLoss3_Price,qty=-inputGroupSL3_QtyPer*0.01*POSITION)
strategy.order(stopLoss4_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss4_ExecCondition,stop=stopLoss4_Price,qty=-inputGroupSL4_QtyPer*0.01*POSITION)
strategy.order(stopLoss5_Name,strategy.long,oca_name='TPSL',oca_type=strategy.oca.cancel,when=stopLoss5_ExecCondition,stop=stopLoss5_Price,qty=-inputGroupSL5_QtyPer*0.01*POSITION)
//=======================================================//
//-------------------->StrategyResults<--------------//
//=======================================================//
variprealTrade_NB=0
variplastTrade_Bar=0
variprealTrade_Profit=0.0
variprealTrade_initialPS=0.0
realTrade_NB:=(strategy.position_size[1]==0andnotFLAT)?realTrade_NB+1:realTrade_NB
lastTrade_Bar:=(strategy.position_size[1]==0andnotFLAT)?bar_index+1:lastTrade_Bar
realTrade_initialPS:=(strategy.position_size[1]==0andnotFLAT)?strategy.position_size*strategy.position_avg_price:realTrade_initialPS
if(strategy.position_size[1]!=0andFLAT)
realTrade_Profit:=0
fori=0tostrategy.closedtrades-1
ifstrategy.closedtrades.exit_bar_index(i)>=lastTrade_Bar
realTrade_Profit:=realTrade_Profit+strategy.closedtrades.profit(i)
//=======================================================//
//------------------------>Drawing<-------------------//
//=======================================================//
//---StopLoss1---
close_PlotSL1=plot(stopLoss1_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='StopLoss1-BaseLine')
stopLoss1_Plot=plot(stopLoss1_ExecCondition?stopLoss1_Price:na,style=plot.style_linebr,color=color.new(color.red,10),title='StopLoss1-Price')
fill(close_PlotSL1,stopLoss1_Plot,color.new(#e0999a,50),title='StopLoss1-Background')
//---StopLoss2---
close_PlotSL2=plot(stopLoss2_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='StopLoss2-BaseLine')
stopLoss2_Plot=plot(stopLoss2_ExecCondition?stopLoss2_Price:na,style=plot.style_linebr,color=color.new(color.red,30),title='StopLoss2-Price')
fill(close_PlotSL2,stopLoss2_Plot,color.new(#e0999a,65),title='StopLoss2-Background')
//---StopLoss3---
close_PlotSL3=plot(stopLoss3_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='StopLoss3-BaseLine')
stopLoss3_Plot=plot(stopLoss3_ExecCondition?stopLoss3_Price:na,style=plot.style_linebr,color=color.new(color.red,50),title='StopLoss3-Price')
fill(close_PlotSL3,stopLoss3_Plot,color.new(#e0999a,80),title='StopLoss3-Background')
//---StopLoss4---
close_PlotSL4=plot(stopLoss4_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='StopLoss4-BaseLine')
stopLoss4_Plot=plot(stopLoss4_ExecCondition?stopLoss4_Price:na,style=plot.style_linebr,color=color.new(color.red,50),title='StopLoss4-Price')
fill(close_PlotSL4,stopLoss4_Plot,color.new(#e0999a,80),title='StopLoss4-Background')
//---StopLoss5---
close_PlotSL5=plot(stopLoss5_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='StopLoss5-BaseLine')
stopLoss5_Plot=plot(stopLoss5_ExecCondition?stopLoss5_Price:na,style=plot.style_linebr,color=color.new(color.red,50),title='StopLoss5-Price')
fill(close_PlotSL5,stopLoss5_Plot,color.new(#e0999a,80),title='StopLoss5-Background')
//---TakeProfit1---
close_PlotTP1=plot(takeProfit1_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit1-BaseLine')
takeProfit1_Plot=plot(takeProfit1_ExecCondition?takeProfit1_Price:na,style=plot.style_linebr,color=color.new(color.green,10),title='TakeProfit1-Price')
fill(close_PlotTP1,takeProfit1_Plot,color.new(#99e0ac,50),title='TakeProfit1-Background')
//---TakeProfitTrailTP1---
close_PlotTPT1=plot(takeProfit1TS_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit1-TrailingStop-BaseLine')
takeProfitTP1_Plot=plot(takeProfit1TS_ExecCondition?takeProfit1TS_Price:na,style=plot.style_linebr,color=color.new(color.silver,50),title='TakeProfit1-TrailingStop-Price')
fill(close_PlotTPT1,takeProfitTP1_Plot,color.new(#b22833,50),title='TakeProfit1-TrailingStop-Background')
//---TakeProfit2---
close_PlotTP2=plot(takeProfit2_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit2-BaseLine')
takeProfit2_Plot=plot(takeProfit2_ExecCondition?takeProfit2_Price:na,style=plot.style_linebr,color=color.new(color.green,20),title='TakeProfit2-Price')
fill(close_PlotTP2,takeProfit2_Plot,color.new(#99e0ac,50),title='TakeProfit2-Background')
//---TakeProfitTrailTP2---
close_PlotTPT2=plot(takeProfit2TS_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit2-TrailingStop-BaseLine')
takeProfitTP2_Plot=plot(takeProfit2TS_ExecCondition?takeProfit2TS_Price:na,style=plot.style_linebr,color=color.new(color.silver,50),title='TakeProfit2-TrailingStop-Price')
fill(close_PlotTPT2,takeProfitTP2_Plot,color.new(#b22833,50),title='TakeProfit2-TrailingStop-Background')
//---TakeProfit3---
close_PlotTP3=plot(takeProfit3_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit3-BaseLine')
takeProfit3_Plot=plot(takeProfit3_ExecCondition?takeProfit3_Price:na,style=plot.style_linebr,color=color.new(color.green,30),title='TakeProfit3-Price')
fill(close_PlotTP3,takeProfit3_Plot,color.new(#99e0ac,50),title='TakeProfit3-Background')
//---TakeProfitTrailTP3---
close_PlotTPT3=plot(takeProfit3TS_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit3-TrailingStop-BaseLine')
takeProfitTP3_Plot=plot(takeProfit3TS_ExecCondition?takeProfit3TS_Price:na,style=plot.style_linebr,color=color.new(color.silver,50),title='TakeProfit3-TrailingStop-Price')
fill(close_PlotTPT3,takeProfitTP3_Plot,color.new(#b33833,50),title='TakeProfit3-TrailingStop-Background')
//---TakeProfit4---
close_PlotTP4=plot(takeProfit4_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit4-BaseLine')
takeProfit4_Plot=plot(takeProfit4_ExecCondition?takeProfit4_Price:na,style=plot.style_linebr,color=color.new(color.green,40),title='TakeProfit4-Price')
fill(close_PlotTP4,takeProfit4_Plot,color.new(#99e0ac,50),title='TakeProfit4-Background')
//---TakeProfitTrailTP4---
close_PlotTPT4=plot(takeProfit4TS_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit4-TrailingStop-BaseLine')
takeProfitTP4_Plot=plot(takeProfit4TS_ExecCondition?takeProfit4TS_Price:na,style=plot.style_linebr,color=color.new(color.silver,50),title='TakeProfit4-TrailingStop-Price')
fill(close_PlotTPT4,takeProfitTP4_Plot,color.new(#b44844,50),title='TakeProfit4-TrailingStop-Background')
//---TakeProfit5---
close_PlotTP5=plot(takeProfit5_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit5-BaseLine')
takeProfit5_Plot=plot(takeProfit5_ExecCondition?takeProfit5_Price:na,style=plot.style_linebr,color=color.new(color.green,50),title='TakeProfit5-Price')
fill(close_PlotTP5,takeProfit5_Plot,color.new(#99e0ac,50),title='TakeProfit5-Background')
//---TakeProfitTrailTP5---
close_PlotTPT5=plot(takeProfit5TS_ExecCondition?close:na,style=plot.style_linebr,color=color.new(color.gray,100),title='TakeProfit5-TrailingStop-BaseLine')
takeProfitTP5_Plot=plot(takeProfit5TS_ExecCondition?takeProfit5TS_Price:na,style=plot.style_linebr,color=color.new(color.silver,50),title='TakeProfit5-TrailingStop-Price')
fill(close_PlotTPT5,takeProfitTP5_Plot,color.new(#b55855,50),title='TakeProfit5-TrailingStop-Background')
//---Showlastrealtrade---
if(strategy.position_size[1]!=0andFLAT)andshowTradeResult
label.new(bar_index+1,na,size=size.normal,textalign=text.align_right,text=str.tostring(math.round(realTrade_Profit,2))+"\n"+str.tostring((math.round(100*(realTrade_Profit/realTrade_initialPS),2)))+"%",color=realTrade_Profit>0?color.green:color.red,style=label.style_label_upper_left,yloc=yloc.belowbar,textcolor=color.black)
//----ShowWinningTrades---
ifstrategy.wintrades!=strategy.wintrades[1]andshowWinOrder
label.new(bar_index+1,na,size=size.tiny,textalign=text.align_right,text=str.tostring(math.round(strategy.closedtrades.profit(strategy.closedtrades-1),2))+"\n"+str.tostring((ISLONGWAY?-1:1)*(100-math.round(100*(strategy.closedtrades.exit_price(strategy.closedtrades-1)/strategy.closedtrades.entry_price(strategy.closedtrades-1)),2)))+"%",color=color.green,style=label.style_xcross,yloc=yloc.belowbar,textcolor=ISLONGWAY?color.green:color.red)
//----ShowLosingTrades---
ifstrategy.losstrades!=strategy.losstrades[1]andshowLoosOrder
label.new(bar_index+1,na,size=size.tiny,textalign=text.align_right,text=str.tostring(math.round(strategy.closedtrades.profit(strategy.closedtrades-1),2))+"\n"+str.tostring((ISLONGWAY?-1:1)*(100-math.round(100*(strategy.closedtrades.exit_price(strategy.closedtrades-1)/strategy.closedtrades.entry_price(strategy.closedtrades-1)),2)))+"%",color=color.red,style=label.style_xcross,yloc=yloc.belowbar,textcolor=notISLONGWAY?color.green:color.red)
//----ShowTableResults
tableBgcolor=#696969
ifbarstate.islastconfirmedhistoryandshowTableResult
vartbl=table.new(position.top_center,4,2,bgcolor=tableBgcolor,frame_width=2,frame_color=color.black,border_width=2,border_color=color.black)
table.cell(tbl,0,0,"TotalTrades:"+str.tostring(strategy.closedtrades),bgcolor=strategy.netprofit>strategy.initial_capital?color.green:color.red,text_size=size.small,text_color=strategy.netprofit>strategy.initial_capital?color.black:color.white,text_valign=text.align_center,width=10,height=8)
table.cell(tbl,0,1,"WinRate:"+str.tostring(math.round(strategy.wintrades/strategy.closedtrades*100,2))+"%",bgcolor=strategy.netprofit>strategy.initial_capital?color.green:color.red,text_size=size.small,text_color=strategy.netprofit>strategy.initial_capital?color.black:color.white,text_valign=text.align_center,width=10,height=8)
table.cell(tbl,1,0,"Starting:"+str.tostring(strategy.initial_capital),bgcolor=strategy.netprofit>strategy.initial_capital?color.green:color.red,text_size=size.small,text_color=strategy.netprofit>strategy.initial_capital?color.black:color.white,text_valign=text.align_center,width=10,height=8)
table.cell(tbl,1,1,"Ending:"+str.tostring(math.round(strategy.netprofit,2)),bgcolor=strategy.netprofit>strategy.initial_capital?color.green:color.red,text_size=size.small,text_color=strategy.netprofit>strategy.initial_capital?color.black:color.white,text_valign=text.align_center,width=10,height=8)
table.cell(tbl,2,0,"NetProfit:"+str.tostring(math.round(strategy.netprofit/strategy.initial_capital*100,2))+"%",bgcolor=strategy.netprofit>strategy.initial_capital?color.green:color.red,text_size=size.small,text_color=strategy.netprofit>strategy.initial_capital?color.black:color.white,text_valign=text.align_center,width=10,height=8)
table.cell(tbl,2,1,"MaxDD:"+str.tostring(math.round(strategy.max_drawdown/strategy.initial_capital*100,2))+"%",bgcolor=strategy.netprofit>strategy.initial_capital?color.green:color.red,text_size=size.small,text_color=strategy.netprofit>strategy.initial_capital?color.black:color.white,text_valign=text.align_center,width=10,height=8)
Expand (591 lines)
