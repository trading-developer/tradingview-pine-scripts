Script Name: RSI Overbought Oversold Divergence Strategy w- Buy-Sell Signals
Author: imal_max
Description: This indicator is a copy of my RSI Overbought/Oversold Divergence Indicator with-Alerts


Only difference is that the alerts are disabled, instead it uses tradingviews strategy tester signals
If you want alerts just use the other indicator
PineScript code:

Pine Script™ strategy
RSI Overbought Oversold Divergence Strategy w/ Buy/Sell Signals
//  This  source  code  is  subject  to  the  terms  of  the  Mozilla  Public  License  2.0  at  https://mozilla.org/MPL/2.0/
//  made  by  Imal_Max
//  thanks  to  The1IamNeo's  and  brandons  idea
//
//  thanks  to  JayTradingCharts  RSI  Divergence  /w  Alerts  indicator  for  the  base  code.
//@version=5
//
//  🔥  uncomment  the  line  below  to  enable  the  alerts  and  disable  the  backtester
//indicator(title="Ultimate  Bullish  Divergence  for  RSI  MFI  RVSI  OBV  TRIXRSI  w/  Buy  Alerts",  shorttitle="Ultimate  Bull  Divergence",  format=format.price)//,  timeframe="")
//  🔥  comment  the  line  below  to  disable  the  backtester  +  uncomment  the  lines  slightly  below  and  at  the  bottom  of  the  script
strategy(title="Ultimate  Bullish  Divergence  for  RSI  MFI  RVSI  OBV  TRIXRSI  w/  Buy  Signals",  shorttitle="Ultimate  Bull  Divergence  Backtester",  overlay=false,  pyramiding=1,  process_orders_on_close=true,  calc_on_every_tick=true,  initial_capital=1000,  currency  =  currency.USD,  default_qty_value=100,  default_qty_type=strategy.percent_of_equity,  commission_type=strategy.commission.percent,  commission_value=0.05,  slippage=2)
selectOsc  =  input.string("RSI",  title="Select  Oscillator",  group='═════════  Oscillator  settings  ══════════',  options=["RSI","OBV","RVSI","MFI","TRIX  RSI"],  tooltip="RSI  =  Relative  Strengh  Index;  OBV  =  On  Balance  Volume;  RVSI  =  Relative  Volume  Strengh  Index;  MFI  Money  Flow  Index;  TRIX  RSI  =  Tripple  Exponetial  Relative  Strength")
src  =  input.source(title='Oscillator  Source',  defval=low,  group='═════════  Oscillator  settings  ══════════',  tooltip="RSI,  RVSI,  OBV  and  TRIX  RSI  default  Source:  Close;  MFI  default  Source:  hlc3")
len  =  input.int(title='Oscillator  Length',  minval=1,  defval=14,  group='═════════  Oscillator  settings  ══════════',  tooltip="RSI/MFI  default  Period  =  14;  RVSI  =  10;  TRIX  RSI  =  9;  OBV  has  no  period.")
seclen  =  input.int(9,  minval=1,  title="Oscillator  secondary  length",  group="═════════  Oscillator  settings  ══════════",  tooltip="affects  only  RVSI  and  Trix  RSI.  For  the  TRIX  RSI  this  defines  the  length  of  the  TRIX.  default  value  =  9  and  for  the  RVSI  it  defines  the  Volume  moving  average  length,  default  value  =  5")
emalen  =  input(9,  'Oscillator  Moving  Average  Length',  group='═════════  Oscillator  settings  ══════════',  tooltip="defines  the  length  of  the  of  the  Oscillator  moving  average")
rangeLower  =  input.int(title='Min  Lookback  Range',  defval=0,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  0')
rangeUpper  =  input.int(title='Max  Lookback',  defval=200,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  0',  tooltip="reduces  the  Lookback  range  that  you  define  with  Pivot  Lookback  Left  1-30  ")
enableonlyOneLB  =  input.bool(title='Only  use  the  first  look  back  period',  defval=false,  group='═════  Oscillator  Divergence  Settings  ══════')

lbL1  =  input.int(title='Pivot  Lookback  Left-1',  defval=2,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  1',  tooltip="Amount  of  bars  to  look  back  to  find  pivot  lows  on  the  Oscillator  and  Price")
lbL2  =  input.int(title='Lookback  Left-2',  defval=3,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  1')
lbL3  =  input.int(title='Pivot  Lookback  Left-3',  defval=4,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL4  =  input.int(title='Lookback  Left-4',  defval=5,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL5  =  input.int(title='Pivot  Lookback  Left-5',  defval=6,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL6  =  input.int(title='Lookback  Left-6',  defval=7,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL7  =  input.int(title='Pivot  Lookback  Left-7',  defval=9,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL8  =  input.int(title='Lookback  Left-8',  defval=10,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL9  =  input.int(title='Pivot  Lookback  Left-9',  defval=11,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL10  =  input.int(title='Lookback  Left-10',  defval=12,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL11  =  input.int(title='Pivot  Lookback  Left-11',  defval=13,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL12  =  input.int(title='Lookback  Left-12',  defval=14,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL13  =  input.int(title='Pivot  Lookback  Left-13',  defval=15,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL14  =  input.int(title='Lookback  Left-14',  defval=16,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL15  =  input.int(title='Pivot  Lookback  Left-15',  defval=17,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL16  =  input.int(title='Lookback  Left-16',  defval=18,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL17  =  input.int(title='Pivot  Lookback  Left-17',  defval=19,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL18  =  input.int(title='Lookback  Left-18',  defval=20,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL19  =  input.int(title='Pivot  Lookback  Left-19',  defval=22,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL20  =  input.int(title='Lookback  Left-20',  defval=25,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL21  =  input.int(title='Pivot  Lookback  Left-21',  defval=28,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL22  =  input.int(title='Lookback  Left-22',  defval=31,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL23  =  input.int(title='Pivot  Lookback  Left-23',  defval=34,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL24  =  input.int(title='Lookback  Left-24',  defval=37,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL25  =  input.int(title='Pivot  Lookback  Left-25',  defval=39,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL26  =  input.int(title='Lookback  Left-26',  defval=42,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL27  =  input.int(title='Pivot  Lookback  Left-27',  defval=45,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL28  =  input.int(title='Lookback  Left-28',  defval=48,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL29  =  input.int(title='Pivot  Lookback  Left-29',  defval=51,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
lbL30  =  input.int(title='Lookback  Left-30',  defval=54,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  2')
plotBull  =  input.bool(title='Plot  Bullish',  defval=true,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  4',  tooltip="Price  makes  a  lower  low  while  the  Oscillator  is  making  a  higher  low")
plotHiddenBull  =  input.bool(title='Plot  Hidden  Bullish',  defval=false,  group='═════  Oscillator  Divergence  Settings  ══════',  inline='Input  4',  tooltip="Price  makes  a  higher  low  while  Oscillator  is  making  a  lower  low")
/////////////  Delay  inputs
//  Price  bounce  delay
enablepriceBounceNeeded  =  input.bool(title='enable  $  bounce  delay',  defval=false,  group='═══════════  Signal  Delays    ═══════════')
priceBounceNeeded  =  input.int(title='min  $  bounce  needed  to  flash  buy',  defval=35,  group='═══════════  Signal  Delays    ═══════════')
priceBounceNeededLbL  =  input.int(title='Amount  of  Candles  until  giving  up',  defval=3,  minval=0,  maxval=10,  group='═══════════  Signal  Delays    ═══════════')
//  bars  delay
lbR  =  input.int(title='Confirmation  Time  (bars)  needed',  minval=0,  defval=0,  group='Time  Delay',  tooltip='0  means  the  first  candle  -  no  candle  close  needed  to  flash  a  signal.  Wait  for  a  candle  close  to  be  sure  (for  alerts  on  the  first  cadle  close  set  it  to  0  and  set  the  to  "once  per  bar  close")')
//  EMA  break  delay
enableWaitForEmaBreak  =    input.bool(title='enable  wait  for  moving  average  break',  defval=false,  group='EMA  break  Delay',  tooltip="waits  for  a  break  of  the  moving  average  to  flash  a  signal")
WaitForEmaBreakLen  =  input(5,  'EMA  Length',  group='EMA  break  Delay',  tooltip="defines  the  length  of  the  moving  average  which  it  needs  to  break  before  a  signal  flashes")
//  wait  Oscillator  and  Oscillator  EMA  cross
enableOscCross  =  input.bool(title='enable  wait  for  Oscillator  and  Oscillator  EMA  Cross',  defval=false,  group='Oscillator  EMA  Cross  Delay',  tooltip="")
oscCrosslookback  =  input.int(title='Amount  of  Candles  until  giving  up',  defval=3,  minval=0,  maxval=10,  group='Oscillator  EMA  Cross  Delay')
//  ranges  and  filter
//  only  long  on  rising  EMA  inputs
enableOnlyLongUptrend  =    input.bool(title='only  long  on  in  an  uptrend  (rising  moving  average)',  defval=false,  group='═══════════  Ranges  &  Filter  ═══════════',  tooltip="")
OnlyLongUptrendEmaLen  =  input(200,  'EMA  Length  to  determine  an  uptrend',  group='═══════════  Ranges  &  Filter  ═══════════',  tooltip="defines  the  length  of  the  of  the  moving  average")
EmaUptrend  =  ta.ema(src,  OnlyLongUptrendEmaLen)
isInEMAUptrend  =  ta.change(EmaUptrend)  >  0  or  not  enableOnlyLongUptrend
//  ob/os  divergence  settings
enableRsiLimit  =  input.bool(title='enable  Oversold  limits',  defval=false,  group='divergence  below  OverSold',  tooltip="only  works  with  RSI,  MFI  and  RVSI")
osvalue  =  input.int(title='only  show  Signals  if  the  Oscillator  was  below',  defval=30,  group='divergence  below  OverSold',  inline='Input  1')
oslookback  =  input.int(title='within  the  last  (x  candles)',  defval=2,  group='divergence  below  OverSold',  inline='Input  1')
maxBullRSI  =  input.int(title='only  show  signals  if  the  Oscillator  is',  defval=35,  group='divergence  below  OverSold')
//  manual  ranges  for  divergence
enableManualbull1  =  input.bool(title='enable  manual  Bullish  Range-1',  defval=false,  group='══════  manual  Range  for  divergence  signal')
manualbullHigh1  =  input.int(title='Range  1  -  Bullish  high',  defval=10000000,  group='══════  manual  Range  for  divergence  signal',  inline='Input  0')
manualbullLow1  =  input.int(title='Range  1  -  Bullish  low',  defval=0,  group='══════  manual  Range  for  divergence  signal',  inline='Input  0')
enableManualbull2  =  input.bool(title='enable  manual  Bullish  Range-2',  defval=false,  group='══════  manual  Range  for  divergence  signal')
manualbullHigh2  =  input.int(title='Range  2  -  Bullish  high',  defval=10000000,  group='══════  manual  Range  for  divergence  signal',  inline='Input  1')
manualbullLow2  =  input.int(title='Range  2  -  Bullish  low',  defval=0,  group='══════  manualRangefordivergencesignal',inline='Input1')
enableManualbull3=input.bool(title='enablemanualBullishRange-1',defval=false,group='══════manualRangefordivergencesignal')
manualbullHigh3=input.int(title='Range3-Bullishhigh',defval=10000000,group='══════manualRangefordivergencesignal',inline='Input2')
manualbullLow3=input.int(title='Range3-Bullishlow',defval=0,group='══════manualRangefordivergencesignal',inline='Input2')
enableManualbull4=input.bool(title='enablemanualBullishRange-2',defval=false,group='══════manualRangefordivergencesignal')
manualbullHigh4=input.int(title='Range4-Bullishhigh',defval=10000000,group='══════manualRangefordivergencesignal',inline='Input3')
manualbullLow4=input.int(title='Range4-Bullishlow',defval=0,group='══════manualRangefordivergencesignal',inline='Input3')
//checkifdivergencehappendwithinmanuallevels
isWithinLongRange1=(close<manualbullHigh1andclose>manualbullLow1)
isWithinLongRange2=(close<manualbullHigh2andclose>manualbullLow2)
isWithinLongRange3=(close<manualbullHigh3andclose>manualbullLow3)
isWithinLongRange4=(close<manualbullHigh4andclose>manualbullLow4)
isWithinLongRange=true
ifenableManualbull1orenableManualbull2orenableManualbull3orenableManualbull4
isWithinLongRange:=(isWithinLongRange1andenableManualbull1)or(isWithinLongRange2andenableManualbull2)or(isWithinLongRange3andenableManualbull3)or(isWithinLongRange4andenableManualbull4)
///////////////////////////Getrangestolookfordivergencesfromindicators
//EMA
//EMABullrangehigh
enableEmaBullHigh=input.bool(title='enableEMAasHighoftheLongRange',defval=false,group='══════EMARangefordivergencesignal')
emaBullHighLen=input.int(9,minval=1,title='Length',group='══════EMARangefordivergencesignal',inline='Input4')
emaBullHighSrc=input(close,title='Source',group='══════EMARangefordivergencesignal',inline='Input4')
emaBullHighDevi=input.int(title='deviation',defval=0,minval=-500,maxval=500,group='══════EMARangefordivergencesignal',inline='Input4')
emaBullHighOut=ta.sma(emaBullHighSrc,emaBullHighLen)
isBelowEmaBullHigh=close<emaBullHighOutornotenableEmaBullHigh
//EMABullrangelow
enableEmaBullLow=input.bool(title='enableEMAasLowoftheLongRange',defval=false,group='══════EMARangefordivergencesignal')
emaBullLowLen=input.int(55,minval=1,title='Length',group='══════EMARangefordivergencesignal',inline='Input5')
emaBullLowSrc=input(close,title='Source',group='══════EMARangefordivergencesignal',inline='Input5')
emaBullLowOffset=input.int(title='deviation',defval=0,minval=-500,maxval=500,group='══════EMARangefordivergencesignal',inline='Input5')
emaBullLowOut=ta.sma(emaBullLowSrc,emaBullLowLen)
isBelowEmaBullLow=close>emaBullLowOutornotenableEmaBullLow
iswithinEmaRange=isBelowEmaBullHighandisBelowEmaBullLow
//EMAEND
//VWAP
enableVwapBullHigh=input.bool(title='enableVWAPasHighoftheLongRange',defval=false,group='════VWAPRangefordivergencesignal')
enableVwapBullLow=input.bool(title='enableVWAPasLowoftheLongRange',defval=false,group='════VWAPRangefordivergencesignal')
enableVwapDiviBullHigh=input.bool(title='enableVWAPUpperDiviationasHighoftheLongRange',defval=false,group='════VWAPRangefordivergencesignal')
enableVwapDiviBullLow=input.bool(title='enableVWAPLowerDiviationasLowoftheLongRange',defval=false,group='════VWAPRangefordivergencesignal')
computeVWAP(src,isNewPeriod,stDevMultiplier)=>
varfloatsumSrcVol=na
varfloatsumVol=na
varfloatsumSrcSrcVol=na
sumSrcVol:=isNewPeriod?src*volume:src*volume+sumSrcVol[1]
sumVol:=isNewPeriod?volume:volume+sumVol[1]
//sumSrcSrcVolcalculatesthedividendoftheequationthatislaterusedtocalculatethestandarddeviation
sumSrcSrcVol:=isNewPeriod?volume*math.pow(src,2):volume*math.pow(src,2)+sumSrcSrcVol[1]
_vwap=sumSrcVol/sumVol
variance=sumSrcSrcVol/sumVol-math.pow(_vwap,2)
variance:=variance<0?0:variance
stDev=math.sqrt(variance)
lowerBand=_vwap-stDev*stDevMultiplier
upperBand=_vwap+stDev*stDevMultiplier
[_vwap,lowerBand,upperBand]
hideonDWM=false
varanchor=input.string(defval='Session',title='AnchorPeriod',options=['Session','Week','Month','Quarter','Year','Decade','Century','Earnings','Dividends','Splits'],group='VWAPSettings')
vsrc=input.source(title='Source',defval=hlc3,group='VWAPSettings')
offset=input.int(0,title='Offset',group='VWAPSettings')
stdevMult=input.float(1.0,title='BandsStandardDiviationMultiplier',group='VWAPSettings')
timeChange(period)=>
ta.change(time(period))
new_earnings=request.earnings(syminfo.tickerid,earnings.actual,barmerge.gaps_on,barmerge.lookahead_on)
new_dividends=request.dividends(syminfo.tickerid,dividends.gross,barmerge.gaps_on,barmerge.lookahead_on)
new_split=request.splits(syminfo.tickerid,splits.denominator,barmerge.gaps_on,barmerge.lookahead_on)
isNewPeriod=anchor=='Earnings'?new_earnings:anchor=='Dividends'?new_dividends:anchor=='Splits'?new_split:na(vsrc[1])?true:anchor=='Session'?timeChange('D'):anchor=='Week'?timeChange('W'):anchor=='Month'?timeChange('M'):anchor=='Quarter'?timeChange('3M'):anchor=='Year'?timeChange('12M'):anchor=='Decade'?timeChange('12M')andyear%10==0:anchor=='Century'?timeChange('12M')andyear%100==0:false
floatvwapValue=na
floatstd=na
floatupperBandValue=na
floatlowerBandValue=na
showBands=true
ifnot(hideonDWMandtimeframe.isdwm)
[_vwap,bottom,top]=computeVWAP(vsrc,isNewPeriod,stdevMult)
vwapValue:=_vwap
upperBandValue:=showBands?top:na
lowerBandValue:=showBands?bottom:na

//checkifinsideVWAPRange
isBelowVwap=vwapValue<closeornotenableVwapBullHigh
isAboveVwap=vwapValue>closeornotenableVwapBullLow
isAboveVwapLowerDivi=lowerBandValue<closeornotenableVwapDiviBullLow
isBelowVwapUpperDivi=upperBandValue>closeornotenableVwapDiviBullHigh
isWithinVwapRange=isBelowVwapandisAboveVwapandisAboveVwapLowerDiviandisBelowVwapUpperDivi
//VWAPEND
//autofibranges
//fibfibbullrangehigh
enablefibbullHigh=input.bool(title='enableAutofibasHighoftheLongRange',defval=false,group='════autofibrangefordivergencesignal',inline='Input0')
selectfibbullHigh=input.float(0.5,'fibLevel',options=[0,0.236,0.382,0.5,0.618,0.702,0.71,0.786,0.83,0.886,1],group='══autofibrangefordivergencesignal')
fibbullHighLookback=input.int(title='AutoFibLookback',minval=1,defval=200,group='════autofibrangefordivergencesignal',inline='Input1')
//fibbullHighDivi=input.int(title='diviationin%',defval=5,group='══autofibrangefordivergencesignal',inline='Input1')
//fibfibbullrangelow
enablefibbullLow=input.bool(title='enableAutofibasLowoftheLongRange',defval=false,group='════autofibrangefordivergencesignal',inline='Input2')
selectfibbullLow=input.float(0.886,'fibLevel',options=[0,0.236,0.382,0.5,0.618,0.702,0.71,0.786,0.83,0.886,1],group='════autofibrangefordivergencesignal')
fibbullLowhLookback=input.int(title='AutoFibLookback',minval=1,defval=200,group='════autofibrangefordivergencesignal',inline='Input3')
//fibbullLowhDivi=input.int(title='diviationin%',defval=5,group='══autofibrangefordivergencesignal',inline='Input3')
isBelowfibbullHigh=true
isBelowfibbullLow=true
fibLowPrice=0.1
fibHighPrice=0.1
fibHighLow=0.1
fibHighHigh=0.1
fibLowHigh=0.1
fibLowLow=0.1
ifenablefibbullHigh
fibHighHigh:=ta.highest(high,fibbullHighLookback)
fibHighLow:=ta.lowest(low,fibbullHighLookback)
fibHighPrice:=(fibHighHigh-fibHighLow)*(1-selectfibbullHigh)+fibHighLow//+fibbullHighDivi
isBelowfibbullHigh:=fibHighPrice>ta.lowest(low,2)ornotenablefibbullHigh
ifenablefibbullLow
fibLowHigh:=ta.highest(high,fibbullLowhLookback)
fibLowLow:=ta.lowest(low,fibbullLowhLookback)
fibLowPrice:=(fibLowHigh-fibLowLow)*(1-selectfibbullLow)+fibLowLow//+fibbullLowhDivi
isBelowfibbullLow:=fibLowPrice<ta.highest(low,2)ornotenablefibbullLow

//plot(fibHighHigh)
//plot(fibHighLow)
//plot(fibHighPrice,color=color.orange)
//plot(fibLowPrice,color=color.orange)
isWithinFibRange=isBelowfibbullHighandisBelowfibbullLow
///////autofibEND
///Rangeschecks
isWithinLongRanges=isWithinLongRangeandiswithinEmaRangeandisWithinVwapRangeandisWithinFibRangeandisInEMAUptrend
//divergencelabelcolors
bullColor=color.purple
bullColor1=color.aqua
bullColor2=color.black
bullColor3=color.blue
bullColor4=color.fuchsia
bullColor5=color.gray
bullColor6=color.green
bullColor7=color.lime
bullColor8=color.maroon
bullColor9=color.navy
bullColor10=color.olive
bullColor11=color.orange
bullColor12=color.purple
bullColor13=color.red
bullColor14=color.silver
bullColor15=color.teal
bullColor16=color.blue
bullColor17=color.navy
bullColor18=color.purple
bullColor19=color.purple
bullColor20=color.red
bullColor21=color.orange
bullColor22=color.purple
bullColor23=color.red
bullColor24=color.silver
bullColor25=color.teal
bullColor26=color.lime
bullColor27=color.fuchsia
bullColor28=color.lime
bullColor29=color.purple
bullColor30=color.red
bullColor31=color.aqua
bullColor32=color.black
bullColor33=color.blue
bullColor34=color.fuchsia
bullColor35=color.gray
hiddenBullColor=color.new(color.purple,80)
textColor=color.white
noneColor=color.new(color.white,100)
////Oscillators
//setthevartoRSItomakeitwork
osc=ta.rsi(src,len)
//calculateRSI
ifselectOsc=="RSI"
osc:=ta.rsi(src,len)
//calculateRVSI
ifselectOsc=="RVSI"
nv=ta.cum(ta.change(src)*volume)
av=ta.ema(nv,seclen)
RVSI=ta.rsi(av,len)
osc:=RVSI

//gettingOBV
ifselectOsc=="OBV"
osc:=ta.obv

//calculateMFI
ifselectOsc=="MFI"
upper=math.sum(volume*(ta.change(src)<=0?0:src),len)
lower=math.sum(volume*(ta.change(src)>=0?0:src),len)
osc:=100.0-100.0/(1.0+upper/lower)

ifselectOsc=="TRIXRSI"
trix=10000*ta.change(ta.ema(ta.ema(ta.ema(math.log(src),seclen),seclen),seclen))
osc:=ta.rsi(trix,len)
oscema=ta.ema(osc,emalen)
////Oscillators
////////////////OscillatorConditions
//checkifRSIwasOSorOBrecently
osLowestRsi=ta.lowest(osc,oslookback)
RSIwasBelowOS=osLowestRsi<osvalueornotenableRsiLimit
//checkifRSIisbelowmaxBullRSIandaboveminBearRSI
isBelowRsiBull=osc<maxBullRSIornotenableRsiLimit
///////////////////plotoboslevels
osLevel=hline(osvalue,title='Oversold',linestyle=hline.style_dotted)
maxRSIline=hline(maxBullRSI,title='maxRSIforBulldivergence',linestyle=hline.style_dotted)
//fill(osLevel,maxRSIline,title='BullZoneBackground',color=color.new(#4caf50,90))
//RSI0line=hline(0,title='RSI0Line',linestyle=hline.style_dotted)
//RSI100line=hline(100,title='RSI100Line',linestyle=hline.style_dotted)
//fill(osLevel,RSI0line,title='OversoldZoneBackground',color=color.new(#4caf50,75))
//////////////////////plotOscillator,histogramandOscillatorema
plot(osc,title='Oscillator',linewidth=2,color=color.new(#00bcd4,0))
plot(oscema,color=color.purple,title='OscillatorEMA',style=plot.style_circles)
//hist=osc-oscema
//plot(hist,title='OscillatorHistogram',style=plot.style_columns,color=hist>=0?hist[1]<hist?color.lime:color.purple:hist[1]<hist?color.orange:color.red)
////////////////////plotOscillator,histogramandOscillatoremaEND

////////////////divergencestuffstart
//////divergenceLookbackperiod#1
//getpivots
plFound1=na(ta.pivotlow(osc,lbL1,lbR))?false:true
_inRange1(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL1=osc[lbR]>ta.valuewhen(plFound1,osc[lbR],1)and_inRange1(plFound1[1])
//Price:LowerLow
priceLL1=low[lbR]<ta.valuewhen(plFound1,low[lbR],1)
bullCond1=plotBullandpriceLL1andoscHL1andplFound1andRSIwasBelowOSandisWithinLongRanges
//plot(plFound1?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond1?bullColor:noneColor)
plotshape(bullCond1?osc[lbR]:na,offset=-lbR,title='RegularBullish1Label',text='B1',style=shape.labelup,location=location.absolute,color=bullColor1,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL1=osc[lbR]<ta.valuewhen(plFound1,osc[lbR],1)and_inRange1(plFound1[1])
//Price:HigherLow
priceHL1=low[lbR]>ta.valuewhen(plFound1,low[lbR],1)
hiddenBullCond1=plotHiddenBullandpriceHL1andoscLL1andplFound1andRSIwasBelowOSandisWithinLongRanges
//plot(plFound1?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond1?hiddenBullColor:noneColor)
plotshape(hiddenBullCond1?osc[lbR]:na,offset=-lbR,title='HiddenBullish1Label',text='HB1',style=shape.labelup,location=location.absolute,color=bullColor1,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#1END
//////divergenceLookbackperiod#2
//getpivots
plFound2=na(ta.pivotlow(osc,lbL2,lbR))?false:true
_inRange2(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL2=osc[lbR]>ta.valuewhen(plFound2,osc[lbR],1)and_inRange2(plFound2[1])
//Price:LowerLow
priceLL2=low[lbR]<ta.valuewhen(plFound2,low[lbR],1)
bullCond2=plotBullandpriceLL2andoscHL2andplFound2andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound2?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond2?bullColor:noneColor)
plotshape(bullCond2?osc[lbR]:na,offset=-lbR,title='RegularBullish2Label',text='B2',style=shape.labelup,location=location.absolute,color=bullColor2,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL2=osc[lbR]<ta.valuewhen(plFound2,osc[lbR],1)and_inRange2(plFound2[1])
//Price:HigherLow
priceHL2=low[lbR]>ta.valuewhen(plFound2,low[lbR],1)
hiddenBullCond2=plotHiddenBullandpriceHL2andoscLL2andplFound2andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound2?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond2?hiddenBullColor:noneColor)
plotshape(hiddenBullCond2?osc[lbR]:na,offset=-lbR,title='HiddenBullish2Label',text='HB2',style=shape.labelup,location=location.absolute,color=bullColor2,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#3
//getpivots
plFound3=na(ta.pivotlow(osc,lbL3,lbR))?false:true
_inRange3(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL3=osc[lbR]>ta.valuewhen(plFound3,osc[lbR],1)and_inRange3(plFound3[1])
//Price:LowerLow
priceLL3=low[lbR]<ta.valuewhen(plFound3,low[lbR],1)
bullCond3=plotBullandpriceLL3andoscHL3andplFound3andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound3?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond3?bullColor:noneColor)
plotshape(bullCond3?osc[lbR]:na,offset=-lbR,title='RegularBullish3Label',text='B3',style=shape.labelup,location=location.absolute,color=bullColor3,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL3=osc[lbR]<ta.valuewhen(plFound3,osc[lbR],1)and_inRange3(plFound3[1])
//Price:HigherLow
priceHL3=low[lbR]>ta.valuewhen(plFound3,low[lbR],1)
hiddenBullCond3=plotHiddenBullandpriceHL3andoscLL3andplFound3andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound3?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond3?hiddenBullColor:noneColor)
plotshape(hiddenBullCond3?osc[lbR]:na,offset=-lbR,title='HiddenBullish3Label',text='HB3',style=shape.labelup,location=location.absolute,color=bullColor3,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#3END
//////divergenceLookbackperiod#4
//getpivots
plFound4=na(ta.pivotlow(osc,lbL4,lbR))?false:true
_inRange4(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL4=osc[lbR]>ta.valuewhen(plFound4,osc[lbR],1)and_inRange4(plFound4[1])
//Price:LowerLow
priceLL4=low[lbR]<ta.valuewhen(plFound4,low[lbR],1)
bullCond4=plotBullandpriceLL4andoscHL4andplFound4andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound4?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond4?bullColor:noneColor)
plotshape(bullCond4?osc[lbR]:na,offset=-lbR,title='RegularBullish4Label',text='B4',style=shape.labelup,location=location.absolute,color=bullColor4,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL4=osc[lbR]<ta.valuewhen(plFound4,osc[lbR],1)and_inRange4(plFound4[1])
//Price:HigherLow
priceHL4=low[lbR]>ta.valuewhen(plFound4,low[lbR],1)
hiddenBullCond4=plotHiddenBullandpriceHL4andoscLL4andplFound4andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound4?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond4?hiddenBullColor:noneColor)
plotshape(hiddenBullCond4?osc[lbR]:na,offset=-lbR,title='HiddenBullish4Label',text='HB4',style=shape.labelup,location=location.absolute,color=bullColor4,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#4END
//////divergenceLookbackperiod#5
//getpivots
plFound5=na(ta.pivotlow(osc,lbL5,lbR))?false:true
_inRange5(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL5=osc[lbR]>ta.valuewhen(plFound5,osc[lbR],1)and_inRange5(plFound5[1])
//Price:LowerLow
priceLL5=low[lbR]<ta.valuewhen(plFound5,low[lbR],1)
bullCond5=plotBullandpriceLL5andoscHL5andplFound5andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound5?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond5?bullColor:noneColor)
plotshape(bullCond5?osc[lbR]:na,offset=-lbR,title='RegularBullish5Label',text='B5',style=shape.labelup,location=location.absolute,color=bullColor5,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL5=osc[lbR]<ta.valuewhen(plFound5,osc[lbR],1)and_inRange5(plFound5[1])
//Price:HigherLow
priceHL5=low[lbR]>ta.valuewhen(plFound5,low[lbR],1)
hiddenBullCond5=plotHiddenBullandpriceHL5andoscLL5andplFound5andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound5?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond5?hiddenBullColor:noneColor)
plotshape(hiddenBullCond5?osc[lbR]:na,offset=-lbR,title='HiddenBullish5Label',text='HB5',style=shape.labelup,location=location.absolute,color=bullColor5,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#5END
//////divergenceLookbackperiod#6
//getpivots
plFound6=na(ta.pivotlow(osc,lbL6,lbR))?false:true
_inRange6(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL6=osc[lbR]>ta.valuewhen(plFound6,osc[lbR],1)and_inRange6(plFound6[1])
//Price:LowerLow
priceLL6=low[lbR]<ta.valuewhen(plFound6,low[lbR],1)
bullCond6=plotBullandpriceLL6andoscHL6andplFound6andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound6?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond6?bullColor:noneColor)
plotshape(bullCond6?osc[lbR]:na,offset=-lbR,title='RegularBullish6Label',text='B6',style=shape.labelup,location=location.absolute,color=bullColor6,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL6=osc[lbR]<ta.valuewhen(plFound6,osc[lbR],1)and_inRange6(plFound6[1])
//Price:HigherLow
priceHL6=low[lbR]>ta.valuewhen(plFound6,low[lbR],1)
hiddenBullCond6=plotHiddenBullandpriceHL6andoscLL6andplFound6andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound6?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond6?hiddenBullColor:noneColor)
plotshape(hiddenBullCond6?osc[lbR]:na,offset=-lbR,title='HiddenBullish6Label',text='HB6',style=shape.labelup,location=location.absolute,color=bullColor6,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#6END
//////divergenceLookbackperiod#7
//getpivots
plFound7=na(ta.pivotlow(osc,lbL7,lbR))?false:true
_inRange7(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL7=osc[lbR]>ta.valuewhen(plFound7,osc[lbR],1)and_inRange7(plFound7[1])
//Price:LowerLow
priceLL7=low[lbR]<ta.valuewhen(plFound7,low[lbR],1)
bullCond7=plotBullandpriceLL7andoscHL7andplFound7andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound7?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond7?bullColor:noneColor)
plotshape(bullCond7?osc[lbR]:na,offset=-lbR,title='RegularBullish7Label',text='B7',style=shape.labelup,location=location.absolute,color=bullColor7,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL7=osc[lbR]<ta.valuewhen(plFound7,osc[lbR],1)and_inRange7(plFound7[1])
//Price:HigherLow
priceHL7=low[lbR]>ta.valuewhen(plFound7,low[lbR],1)
hiddenBullCond7=plotHiddenBullandpriceHL7andoscLL7andplFound7andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound7?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond7?hiddenBullColor:noneColor)
plotshape(hiddenBullCond7?osc[lbR]:na,offset=-lbR,title='HiddenBullish7Label',text='HB7',style=shape.labelup,location=location.absolute,color=bullColor7,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#7END
//////divergenceLookbackperiod#8
//getpivots
plFound8=na(ta.pivotlow(osc,lbL8,lbR))?false:true
_inRange8(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL8=osc[lbR]>ta.valuewhen(plFound8,osc[lbR],1)and_inRange8(plFound8[1])
//Price:LowerLow
priceLL8=low[lbR]<ta.valuewhen(plFound8,low[lbR],1)
bullCond8=plotBullandpriceLL8andoscHL8andplFound8andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound8?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond8?bullColor:noneColor)
plotshape(bullCond8?osc[lbR]:na,offset=-lbR,title='RegularBullish8Label',text='B8',style=shape.labelup,location=location.absolute,color=bullColor8,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL8=osc[lbR]<ta.valuewhen(plFound8,osc[lbR],1)and_inRange8(plFound8[1])
//Price:HigherLow
priceHL8=low[lbR]>ta.valuewhen(plFound8,low[lbR],1)
hiddenBullCond8=plotHiddenBullandpriceHL8andoscLL8andplFound8andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound8?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond8?hiddenBullColor:noneColor)
plotshape(hiddenBullCond8?osc[lbR]:na,offset=-lbR,title='HiddenBullish8Label',text='HB8',style=shape.labelup,location=location.absolute,color=bullColor8,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#8END
//////divergenceLookbackperiod#9
//getpivots
plFound9=na(ta.pivotlow(osc,lbL9,lbR))?false:true
_inRange9(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL9=osc[lbR]>ta.valuewhen(plFound9,osc[lbR],1)and_inRange9(plFound9[1])
//Price:LowerLow
priceLL9=low[lbR]<ta.valuewhen(plFound9,low[lbR],1)
bullCond9=plotBullandpriceLL9andoscHL9andplFound9andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound9?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond9?bullColor:noneColor)
plotshape(bullCond9?osc[lbR]:na,offset=-lbR,title='RegularBullish9Label',text='B9',style=shape.labelup,location=location.absolute,color=bullColor9,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL9=osc[lbR]<ta.valuewhen(plFound9,osc[lbR],1)and_inRange9(plFound9[1])
//Price:HigherLow
priceHL9=low[lbR]>ta.valuewhen(plFound9,low[lbR],1)
hiddenBullCond9=plotHiddenBullandpriceHL9andoscLL9andplFound9andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound9?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond9?hiddenBullColor:noneColor)
plotshape(hiddenBullCond9?osc[lbR]:na,offset=-lbR,title='HiddenBullish9Label',text='HB9',style=shape.labelup,location=location.absolute,color=bullColor9,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#9END
//////divergenceLookbackperiod#10
//getpivots
plFound10=na(ta.pivotlow(osc,lbL10,lbR))?false:true
_inRange10(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL10=osc[lbR]>ta.valuewhen(plFound10,osc[lbR],1)and_inRange10(plFound10[1])
//Price:LowerLow
priceLL10=low[lbR]<ta.valuewhen(plFound10,low[lbR],1)
bullCond10=plotBullandpriceLL10andoscHL10andplFound10andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound10?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond10?bullColor:noneColor)
plotshape(bullCond10?osc[lbR]:na,offset=-lbR,title='RegularBullish10Label',text='B10',style=shape.labelup,location=location.absolute,color=bullColor10,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL10=osc[lbR]<ta.valuewhen(plFound10,osc[lbR],1)and_inRange10(plFound10[1])
//Price:HigherLow
priceHL10=low[lbR]>ta.valuewhen(plFound10,low[lbR],1)
hiddenBullCond10=plotHiddenBullandpriceHL10andoscLL10andplFound10andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound10?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond10?hiddenBullColor:noneColor)
plotshape(hiddenBullCond10?osc[lbR]:na,offset=-lbR,title='HiddenBullish10Label',text='HB10',style=shape.labelup,location=location.absolute,color=bullColor10,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#10END
//////divergenceLookbackperiod#11
//getpivots
plFound11=na(ta.pivotlow(osc,lbL11,lbR))?false:true
_inRange11(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL11=osc[lbR]>ta.valuewhen(plFound11,osc[lbR],1)and_inRange11(plFound11[1])
//Price:LowerLow
priceLL11=low[lbR]<ta.valuewhen(plFound11,low[lbR],1)
bullCond11=plotBullandpriceLL11andoscHL11andplFound11andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound11?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond11?bullColor:noneColor)
plotshape(bullCond11?osc[lbR]:na,offset=-lbR,title='RegularBullish11Label',text='B11',style=shape.labelup,location=location.absolute,color=bullColor11,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL11=osc[lbR]<ta.valuewhen(plFound11,osc[lbR],1)and_inRange11(plFound11[1])
//Price:HigherLow
priceHL11=low[lbR]>ta.valuewhen(plFound11,low[lbR],1)
hiddenBullCond11=plotHiddenBullandpriceHL11andoscLL11andplFound11andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound11?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond11?hiddenBullColor:noneColor)
plotshape(hiddenBullCond11?osc[lbR]:na,offset=-lbR,title='HiddenBullish11Label',text='HB11',style=shape.labelup,location=location.absolute,color=bullColor11,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#11END
//////divergenceLookbackperiod#12
//getpivots
plFound12=na(ta.pivotlow(osc,lbL12,lbR))?false:true
_inRange12(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL12=osc[lbR]>ta.valuewhen(plFound12,osc[lbR],1)and_inRange12(plFound12[1])
//Price:LowerLow
priceLL12=low[lbR]<ta.valuewhen(plFound12,low[lbR],1)
bullCond12=plotBullandpriceLL12andoscHL12andplFound12andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound12?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond12?bullColor:noneColor)
plotshape(bullCond12?osc[lbR]:na,offset=-lbR,title='RegularBullish12Label',text='B12',style=shape.labelup,location=location.absolute,color=bullColor12,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL12=osc[lbR]<ta.valuewhen(plFound12,osc[lbR],1)and_inRange12(plFound12[1])
//Price:HigherLow
priceHL12=low[lbR]>ta.valuewhen(plFound12,low[lbR],1)
hiddenBullCond12=plotHiddenBullandpriceHL12andoscLL12andplFound12andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound12?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond12?hiddenBullColor:noneColor)
plotshape(hiddenBullCond12?osc[lbR]:na,offset=-lbR,title='HiddenBullish12Label',text='HB12',style=shape.labelup,location=location.absolute,color=bullColor12,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#12END
//////divergenceLookbackperiod#13
//getpivots
plFound13=na(ta.pivotlow(osc,lbL13,lbR))?false:true
_inRange13(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL13=osc[lbR]>ta.valuewhen(plFound13,osc[lbR],1)and_inRange13(plFound13[1])
//Price:LowerLow
priceLL13=low[lbR]<ta.valuewhen(plFound13,low[lbR],1)
bullCond13=plotBullandpriceLL13andoscHL13andplFound13andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound13?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond13?bullColor:noneColor)
plotshape(bullCond13?osc[lbR]:na,offset=-lbR,title='RegularBullish13Label',text='B13',style=shape.labelup,location=location.absolute,color=bullColor13,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL13=osc[lbR]<ta.valuewhen(plFound13,osc[lbR],1)and_inRange13(plFound13[1])
//Price:HigherLow
priceHL13=low[lbR]>ta.valuewhen(plFound13,low[lbR],1)
hiddenBullCond13=plotHiddenBullandpriceHL13andoscLL13andplFound13andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound13?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond13?hiddenBullColor:noneColor)
plotshape(hiddenBullCond13?osc[lbR]:na,offset=-lbR,title='HiddenBullish13Label',text='HB13',style=shape.labelup,location=location.absolute,color=bullColor13,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#13END
//////divergenceLookbackperiod#14
//getpivots
plFound14=na(ta.pivotlow(osc,lbL14,lbR))?false:true
_inRange14(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL14=osc[lbR]>ta.valuewhen(plFound14,osc[lbR],1)and_inRange14(plFound14[1])
//Price:LowerLow
priceLL14=low[lbR]<ta.valuewhen(plFound14,low[lbR],1)
bullCond14=plotBullandpriceLL14andoscHL14andplFound14andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound14?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond14?bullColor:noneColor)
plotshape(bullCond14?osc[lbR]:na,offset=-lbR,title='RegularBullish14Label',text='B14',style=shape.labelup,location=location.absolute,color=bullColor14,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL14=osc[lbR]<ta.valuewhen(plFound14,osc[lbR],1)and_inRange14(plFound14[1])
//Price:HigherLow
priceHL14=low[lbR]>ta.valuewhen(plFound14,low[lbR],1)
hiddenBullCond14=plotHiddenBullandpriceHL14andoscLL14andplFound14andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound14?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond14?hiddenBullColor:noneColor)
plotshape(hiddenBullCond14?osc[lbR]:na,offset=-lbR,title='HiddenBullish14Label',text='HB14',style=shape.labelup,location=location.absolute,color=bullColor14,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#14END
//////divergenceLookbackperiod#15
//getpivots
plFound15=na(ta.pivotlow(osc,lbL15,lbR))?false:true
_inRange15(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL15=osc[lbR]>ta.valuewhen(plFound15,osc[lbR],1)and_inRange15(plFound15[1])
//Price:LowerLow
priceLL15=low[lbR]<ta.valuewhen(plFound15,low[lbR],1)
bullCond15=plotBullandpriceLL15andoscHL15andplFound15andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound15?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond15?bullColor:noneColor)
plotshape(bullCond15?osc[lbR]:na,offset=-lbR,title='RegularBullish15Label',text='B15',style=shape.labelup,location=location.absolute,color=bullColor15,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL15=osc[lbR]<ta.valuewhen(plFound15,osc[lbR],1)and_inRange15(plFound15[1])
//Price:HigherLow
priceHL15=low[lbR]>ta.valuewhen(plFound15,low[lbR],1)
hiddenBullCond15=plotHiddenBullandpriceHL15andoscLL15andplFound15andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound15?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond15?hiddenBullColor:noneColor)
plotshape(hiddenBullCond15?osc[lbR]:na,offset=-lbR,title='HiddenBullish15Label',text='HB15',style=shape.labelup,location=location.absolute,color=bullColor15,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#15END
//////divergenceLookbackperiod#16
//getpivots
plFound16=na(ta.pivotlow(osc,lbL16,lbR))?false:true
_inRange16(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL16=osc[lbR]>ta.valuewhen(plFound16,osc[lbR],1)and_inRange16(plFound16[1])
//Price:LowerLow
priceLL16=low[lbR]<ta.valuewhen(plFound16,low[lbR],1)
bullCond16=plotBullandpriceLL16andoscHL16andplFound16andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound16?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond16?bullColor:noneColor)
plotshape(bullCond16?osc[lbR]:na,offset=-lbR,title='RegularBullish16Label',text='B16',style=shape.labelup,location=location.absolute,color=bullColor16,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL16=osc[lbR]<ta.valuewhen(plFound16,osc[lbR],1)and_inRange16(plFound16[1])
//Price:HigherLow
priceHL16=low[lbR]>ta.valuewhen(plFound16,low[lbR],1)
hiddenBullCond16=plotHiddenBullandpriceHL16andoscLL16andplFound16andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound16?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond16?hiddenBullColor:noneColor)
plotshape(hiddenBullCond16?osc[lbR]:na,offset=-lbR,title='HiddenBullish16Label',text='HB16',style=shape.labelup,location=location.absolute,color=bullColor16,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#16END
//////divergenceLookbackperiod#17
//getpivots
plFound17=na(ta.pivotlow(osc,lbL17,lbR))?false:true
_inRange17(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL17=osc[lbR]>ta.valuewhen(plFound17,osc[lbR],1)and_inRange17(plFound17[1])
//Price:LowerLow
priceLL17=low[lbR]<ta.valuewhen(plFound17,low[lbR],1)
bullCond17=plotBullandpriceLL17andoscHL17andplFound17andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound17?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond17?bullColor:noneColor)
plotshape(bullCond17?osc[lbR]:na,offset=-lbR,title='RegularBullish17Label',text='B17',style=shape.labelup,location=location.absolute,color=bullColor17,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL17=osc[lbR]<ta.valuewhen(plFound17,osc[lbR],1)and_inRange17(plFound17[1])
//Price:HigherLow
priceHL17=low[lbR]>ta.valuewhen(plFound17,low[lbR],1)
hiddenBullCond17=plotHiddenBullandpriceHL17andoscLL17andplFound17andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound17?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond17?hiddenBullColor:noneColor)
plotshape(hiddenBullCond17?osc[lbR]:na,offset=-lbR,title='HiddenBullish17Label',text='HB17',style=shape.labelup,location=location.absolute,color=bullColor17,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#17END
//////divergenceLookbackperiod#18
//getpivots
plFound18=na(ta.pivotlow(osc,lbL18,lbR))?false:true
_inRange18(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL18=osc[lbR]>ta.valuewhen(plFound18,osc[lbR],1)and_inRange18(plFound18[1])
//Price:LowerLow
priceLL18=low[lbR]<ta.valuewhen(plFound18,low[lbR],1)
bullCond18=plotBullandpriceLL18andoscHL18andplFound18andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound18?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond18?bullColor:noneColor)
plotshape(bullCond18?osc[lbR]:na,offset=-lbR,title='RegularBullish18Label',text='B18',style=shape.labelup,location=location.absolute,color=bullColor18,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL18=osc[lbR]<ta.valuewhen(plFound18,osc[lbR],1)and_inRange18(plFound18[1])
//Price:HigherLow
priceHL18=low[lbR]>ta.valuewhen(plFound18,low[lbR],1)
hiddenBullCond18=plotHiddenBullandpriceHL18andoscLL18andplFound18andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound18?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond18?hiddenBullColor:noneColor)
plotshape(hiddenBullCond18?osc[lbR]:na,offset=-lbR,title='HiddenBullish18Label',text='HB18',style=shape.labelup,location=location.absolute,color=bullColor18,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#18END
//////divergenceLookbackperiod#19
//getpivots
plFound19=na(ta.pivotlow(osc,lbL19,lbR))?false:true
_inRange19(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL19=osc[lbR]>ta.valuewhen(plFound19,osc[lbR],1)and_inRange19(plFound19[1])
//Price:LowerLow
priceLL19=low[lbR]<ta.valuewhen(plFound19,low[lbR],1)
bullCond19=plotBullandpriceLL19andoscHL19andplFound19andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound19?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond19?bullColor:noneColor)
plotshape(bullCond19?osc[lbR]:na,offset=-lbR,title='RegularBullish19Label',text='B19',style=shape.labelup,location=location.absolute,color=bullColor19,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL19=osc[lbR]<ta.valuewhen(plFound19,osc[lbR],1)and_inRange19(plFound19[1])
//Price:HigherLow
priceHL19=low[lbR]>ta.valuewhen(plFound19,low[lbR],1)
hiddenBullCond19=plotHiddenBullandpriceHL19andoscLL19andplFound19andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound19?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond19?hiddenBullColor:noneColor)
plotshape(hiddenBullCond19?osc[lbR]:na,offset=-lbR,title='HiddenBullish19Label',text='HB19',style=shape.labelup,location=location.absolute,color=bullColor19,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#19END
//////divergenceLookbackperiod#20
//getpivots
plFound20=na(ta.pivotlow(osc,lbL20,lbR))?false:true
_inRange20(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL20=osc[lbR]>ta.valuewhen(plFound20,osc[lbR],1)and_inRange20(plFound20[1])
//Price:LowerLow
priceLL20=low[lbR]<ta.valuewhen(plFound20,low[lbR],1)
bullCond20=plotBullandpriceLL20andoscHL20andplFound20andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound20?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond20?bullColor:noneColor)
plotshape(bullCond20?osc[lbR]:na,offset=-lbR,title='RegularBullish20Label',text='B20',style=shape.labelup,location=location.absolute,color=bullColor20,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL20=osc[lbR]<ta.valuewhen(plFound20,osc[lbR],1)and_inRange20(plFound20[1])
//Price:HigherLow
priceHL20=low[lbR]>ta.valuewhen(plFound20,low[lbR],1)
hiddenBullCond20=plotHiddenBullandpriceHL20andoscLL20andplFound20andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound20?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond20?hiddenBullColor:noneColor)
plotshape(hiddenBullCond20?osc[lbR]:na,offset=-lbR,title='HiddenBullish20Label',text='HB20',style=shape.labelup,location=location.absolute,color=bullColor20,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#20END
//////divergenceLookbackperiod#21
//getpivots
plFound21=na(ta.pivotlow(osc,lbL21,lbR))?false:true
_inRange21(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL21=osc[lbR]>ta.valuewhen(plFound21,osc[lbR],1)and_inRange21(plFound21[1])
//Price:LowerLow
priceLL21=low[lbR]<ta.valuewhen(plFound21,low[lbR],1)
bullCond21=plotBullandpriceLL21andoscHL21andplFound21andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound21?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond21?bullColor:noneColor)
plotshape(bullCond21?osc[lbR]:na,offset=-lbR,title='RegularBullish21Label',text='B21',style=shape.labelup,location=location.absolute,color=bullColor21,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL21=osc[lbR]<ta.valuewhen(plFound21,osc[lbR],1)and_inRange21(plFound21[1])
//Price:HigherLow
priceHL21=low[lbR]>ta.valuewhen(plFound21,low[lbR],1)
hiddenBullCond21=plotHiddenBullandpriceHL21andoscLL21andplFound21andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound21?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond21?hiddenBullColor:noneColor)
plotshape(hiddenBullCond21?osc[lbR]:na,offset=-lbR,title='HiddenBullish21Label',text='HB21',style=shape.labelup,location=location.absolute,color=bullColor21,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#21END
//////divergenceLookbackperiod#22
//getpivots
plFound22=na(ta.pivotlow(osc,lbL22,lbR))?false:true
_inRange22(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL22=osc[lbR]>ta.valuewhen(plFound22,osc[lbR],1)and_inRange22(plFound22[1])
//Price:LowerLow
priceLL22=low[lbR]<ta.valuewhen(plFound22,low[lbR],1)
bullCond22=plotBullandpriceLL22andoscHL22andplFound22andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound22?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond22?bullColor:noneColor)
plotshape(bullCond22?osc[lbR]:na,offset=-lbR,title='RegularBullish22Label',text='B22',style=shape.labelup,location=location.absolute,color=bullColor22,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL22=osc[lbR]<ta.valuewhen(plFound22,osc[lbR],1)and_inRange22(plFound22[1])
//Price:HigherLow
priceHL22=low[lbR]>ta.valuewhen(plFound22,low[lbR],1)
hiddenBullCond22=plotHiddenBullandpriceHL22andoscLL22andplFound22andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound22?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond22?hiddenBullColor:noneColor)
plotshape(hiddenBullCond22?osc[lbR]:na,offset=-lbR,title='HiddenBullish22Label',text='HB22',style=shape.labelup,location=location.absolute,color=bullColor22,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#22END
//////divergenceLookbackperiod#23
//getpivots
plFound23=na(ta.pivotlow(osc,lbL23,lbR))?false:true
_inRange23(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL23=osc[lbR]>ta.valuewhen(plFound23,osc[lbR],1)and_inRange23(plFound23[1])
//Price:LowerLow
priceLL23=low[lbR]<ta.valuewhen(plFound23,low[lbR],1)
bullCond23=plotBullandpriceLL23andoscHL23andplFound23andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound23?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond23?bullColor:noneColor)
plotshape(bullCond23?osc[lbR]:na,offset=-lbR,title='RegularBullish23Label',text='B23',style=shape.labelup,location=location.absolute,color=bullColor23,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL23=osc[lbR]<ta.valuewhen(plFound23,osc[lbR],1)and_inRange23(plFound23[1])
//Price:HigherLow
priceHL23=low[lbR]>ta.valuewhen(plFound23,low[lbR],1)
hiddenBullCond23=plotHiddenBullandpriceHL23andoscLL23andplFound23andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound23?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond23?hiddenBullColor:noneColor)
plotshape(hiddenBullCond23?osc[lbR]:na,offset=-lbR,title='HiddenBullish23Label',text='HB23',style=shape.labelup,location=location.absolute,color=bullColor23,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#23END
//////divergenceLookbackperiod#24
//getpivots
plFound24=na(ta.pivotlow(osc,lbL24,lbR))?false:true
_inRange24(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL24=osc[lbR]>ta.valuewhen(plFound24,osc[lbR],1)and_inRange24(plFound24[1])
//Price:LowerLow
priceLL24=low[lbR]<ta.valuewhen(plFound24,low[lbR],1)
bullCond24=plotBullandpriceLL24andoscHL24andplFound24andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound24?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond24?bullColor:noneColor)
plotshape(bullCond24?osc[lbR]:na,offset=-lbR,title='RegularBullish24Label',text='B24',style=shape.labelup,location=location.absolute,color=bullColor24,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL24=osc[lbR]<ta.valuewhen(plFound24,osc[lbR],1)and_inRange24(plFound24[1])
//Price:HigherLow
priceHL24=low[lbR]>ta.valuewhen(plFound24,low[lbR],1)
hiddenBullCond24=plotHiddenBullandpriceHL24andoscLL24andplFound24andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound24?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond24?hiddenBullColor:noneColor)
plotshape(hiddenBullCond24?osc[lbR]:na,offset=-lbR,title='HiddenBullish24Label',text='HB24',style=shape.labelup,location=location.absolute,color=bullColor24,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#24END
//////divergenceLookbackperiod#25
//getpivots
plFound25=na(ta.pivotlow(osc,lbL25,lbR))?false:true
_inRange25(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL25=osc[lbR]>ta.valuewhen(plFound25,osc[lbR],1)and_inRange25(plFound25[1])
//Price:LowerLow
priceLL25=low[lbR]<ta.valuewhen(plFound25,low[lbR],1)
bullCond25=plotBullandpriceLL25andoscHL25andplFound25andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound25?osc[lbR]:na,offset=-lbR,title='RegularBullish',linewidth=2,color=bullCond25?bullColor:noneColor)
plotshape(bullCond25?osc[lbR]:na,offset=-lbR,title='RegularBullish25Label',text='B25',style=shape.labelup,location=location.absolute,color=bullColor25,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL25=osc[lbR]<ta.valuewhen(plFound25,osc[lbR],1)and_inRange25(plFound25[1])
//Price:HigherLow
priceHL25=low[lbR]>ta.valuewhen(plFound25,low[lbR],1)
hiddenBullCond25=plotHiddenBullandpriceHL25andoscLL25andplFound25andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound25?osc[lbR]:na,offset=-lbR,title='HiddenBullish',linewidth=2,color=hiddenBullCond25?hiddenBullColor:noneColor)
plotshape(hiddenBullCond25?osc[lbR]:na,offset=-lbR,title='HiddenBullish25Label',text='HB25',style=shape.labelup,location=location.absolute,color=bullColor25,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#25END
//////divergenceLookbackperiod#26
//getpivots
plFound26=na(ta.pivotlow(osc,lbL26,lbR))?false:true
_inRange26(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL26=osc[lbR]>ta.valuewhen(plFound26,osc[lbR],1)and_inRange26(plFound26[1])
//Price:LowerLow
priceLL26=low[lbR]<ta.valuewhen(plFound26,low[lbR],1)
bullCond26=plotBullandpriceLL26andoscHL26andplFound26andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound26?osc[lbR]:na,offset=-lbR,title='RegularBullish26',linewidth=2,color=bullCond26?bullColor:noneColor)
plotshape(bullCond26?osc[lbR]:na,offset=-lbR,title='RegularBullish26Label',text='B26',style=shape.labelup,location=location.absolute,color=bullColor26,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL26=osc[lbR]<ta.valuewhen(plFound26,osc[lbR],1)and_inRange26(plFound26[1])
//Price:HigherLow
priceHL26=low[lbR]>ta.valuewhen(plFound26,low[lbR],1)
hiddenBullCond26=plotHiddenBullandpriceHL26andoscLL26andplFound26andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound26?osc[lbR]:na,offset=-lbR,title='HiddenBullish26',linewidth=2,color=hiddenBullCond26?hiddenBullColor:noneColor)
plotshape(hiddenBullCond26?osc[lbR]:na,offset=-lbR,title='HiddenBullish26Label',text='HB26',style=shape.labelup,location=location.absolute,color=bullColor26,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#26END
//////divergenceLookbackperiod#27
//getpivots
plFound27=na(ta.pivotlow(osc,lbL27,lbR))?false:true
_inRange27(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL27=osc[lbR]>ta.valuewhen(plFound27,osc[lbR],1)and_inRange27(plFound27[1])
//Price:LowerLow
priceLL27=low[lbR]<ta.valuewhen(plFound27,low[lbR],1)
bullCond27=plotBullandpriceLL27andoscHL27andplFound27andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound27?osc[lbR]:na,offset=-lbR,title='RegularBullish27',linewidth=2,color=bullCond27?bullColor:noneColor)
plotshape(bullCond27?osc[lbR]:na,offset=-lbR,title='RegularBullish27Label',text='B27',style=shape.labelup,location=location.absolute,color=bullColor27,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL27=osc[lbR]<ta.valuewhen(plFound27,osc[lbR],1)and_inRange27(plFound27[1])
//Price:HigherLow
priceHL27=low[lbR]>ta.valuewhen(plFound27,low[lbR],1)
hiddenBullCond27=plotHiddenBullandpriceHL27andoscLL27andplFound27andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound27?osc[lbR]:na,offset=-lbR,title='HiddenBullish27',linewidth=2,color=hiddenBullCond27?hiddenBullColor:noneColor)
plotshape(hiddenBullCond27?osc[lbR]:na,offset=-lbR,title='HiddenBullish27Label',text='HB27',style=shape.labelup,location=location.absolute,color=bullColor27,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#27END
//////divergenceLookbackperiod#28
//getpivots
plFound28=na(ta.pivotlow(osc,lbL28,lbR))?false:true
_inRange28(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL28=osc[lbR]>ta.valuewhen(plFound28,osc[lbR],1)and_inRange28(plFound28[1])
//Price:LowerLow
priceLL28=low[lbR]<ta.valuewhen(plFound28,low[lbR],1)
bullCond28=plotBullandpriceLL28andoscHL28andplFound28andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound28?osc[lbR]:na,offset=-lbR,title='RegularBullish28',linewidth=2,color=bullCond28?bullColor:noneColor)
plotshape(bullCond28?osc[lbR]:na,offset=-lbR,title='RegularBullish28Label',text='B28',style=shape.labelup,location=location.absolute,color=bullColor28,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL28=osc[lbR]<ta.valuewhen(plFound28,osc[lbR],1)and_inRange28(plFound28[1])
//Price:HigherLow
priceHL28=low[lbR]>ta.valuewhen(plFound28,low[lbR],1)
hiddenBullCond28=plotHiddenBullandpriceHL28andoscLL28andplFound28andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound28?osc[lbR]:na,offset=-lbR,title='HiddenBullish28',linewidth=2,color=hiddenBullCond28?hiddenBullColor:noneColor)
plotshape(hiddenBullCond28?osc[lbR]:na,offset=-lbR,title='HiddenBullish28Label',text='HB28',style=shape.labelup,location=location.absolute,color=bullColor28,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#28END
//////divergenceLookbackperiod#29
//getpivots
plFound29=na(ta.pivotlow(osc,lbL29,lbR))?false:true
_inRange29(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL29=osc[lbR]>ta.valuewhen(plFound29,osc[lbR],1)and_inRange29(plFound29[1])
//Price:LowerLow
priceLL29=low[lbR]<ta.valuewhen(plFound29,low[lbR],1)
bullCond29=plotBullandpriceLL29andoscHL29andplFound29andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound29?osc[lbR]:na,offset=-lbR,title='RegularBullish29',linewidth=2,color=bullCond29?bullColor:noneColor)
plotshape(bullCond29?osc[lbR]:na,offset=-lbR,title='RegularBullish29Label',text='B29',style=shape.labelup,location=location.absolute,color=bullColor29,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL29=osc[lbR]<ta.valuewhen(plFound29,osc[lbR],1)and_inRange29(plFound29[1])
//Price:HigherLow
priceHL29=low[lbR]>ta.valuewhen(plFound29,low[lbR],1)
hiddenBullCond29=plotHiddenBullandpriceHL29andoscLL29andplFound29andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound29?osc[lbR]:na,offset=-lbR,title='HiddenBullish29',linewidth=2,color=hiddenBullCond29?hiddenBullColor:noneColor)
plotshape(hiddenBullCond29?osc[lbR]:na,offset=-lbR,title='HiddenBullish29Label',text='HB29',style=shape.labelup,location=location.absolute,color=bullColor29,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#29END
//////divergenceLookbackperiod#30
//getpivots
plFound30=na(ta.pivotlow(osc,lbL30,lbR))?false:true
_inRange30(cond)=>
bars=ta.barssince(cond==true)
rangeLower<=barsandbars<=rangeUpper
//------------------------------------------------------------------------------
//RegularBullish
//Osc:HigherLow
oscHL30=osc[lbR]>ta.valuewhen(plFound30,osc[lbR],1)and_inRange30(plFound30[1])
//Price:LowerLow
priceLL30=low[lbR]<ta.valuewhen(plFound30,low[lbR],1)
bullCond30=plotBullandpriceLL30andoscHL30andplFound30andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound30?osc[lbR]:na,offset=-lbR,title='RegularBullish30',linewidth=2,color=bullCond30?bullColor:noneColor)
plotshape(bullCond30?osc[lbR]:na,offset=-lbR,title='RegularBullish30Label',text='B30',style=shape.labelup,location=location.absolute,color=bullColor30,textcolor=textColor)
//------------------------------------------------------------------------------
//HiddenBullish
//Osc:LowerLow
oscLL30=osc[lbR]<ta.valuewhen(plFound30,osc[lbR],1)and_inRange30(plFound30[1])
//Price:HigherLow
priceHL30=low[lbR]>ta.valuewhen(plFound30,low[lbR],1)
hiddenBullCond30=plotHiddenBullandpriceHL30andoscLL30andplFound30andRSIwasBelowOSandisWithinLongRangesandnotenableonlyOneLB
//plot(plFound30?osc[lbR]:na,offset=-lbR,title='HiddenBullish30',linewidth=2,color=hiddenBullCond30?hiddenBullColor:noneColor)
plotshape(hiddenBullCond30?osc[lbR]:na,offset=-lbR,title='HiddenBullish30Label',text='HB30',style=shape.labelup,location=location.absolute,color=bullColor30,textcolor=textColor)
//------------------------------------------------------------------------------
//////divergenceLookbackperiod#30END
//combinedivergencealertsintwobullishandhidden
combibullCond=(bullCond1orbullCond2orbullCond3orbullCond4orbullCond5orbullCond6orbullCond7orbullCond8orbullCond9orbullCond10orbullCond11orbullCond12orbullCond13orbullCond14orbullCond15orbullCond16orbullCond17orbullCond18orbullCond19orbullCond20orbullCond21orbullCond22orbullCond23orbullCond24orbullCond25orbullCond26orbullCond27orbullCond28orbullCond29orbullCond30)
combihiddenBullCond=(hiddenBullCond1orhiddenBullCond2orhiddenBullCond3orhiddenBullCond4orhiddenBullCond5orhiddenBullCond6orhiddenBullCond7orhiddenBullCond8orhiddenBullCond9orhiddenBullCond10orhiddenBullCond11orhiddenBullCond12orhiddenBullCond13orhiddenBullCond14orhiddenBullCond15orhiddenBullCond16orhiddenBullCond17orhiddenBullCond18orhiddenBullCond19orhiddenBullCond20orhiddenBullCond21orhiddenBullCond22orhiddenBullCond23orhiddenBullCond24orhiddenBullCond25orhiddenBullCond26orhiddenBullCond27orhiddenBullCond28orhiddenBullCond29orhiddenBullCond30)
/////////////////////////Delays
//waitforaOscillatorandOscillatorEMAcross
oscCross=((1<(osc-oscema))and(ta.barssince(combihiddenBullCondorcombibullCond)<=oscCrosslookback))ornotenableOscCross
//waitforpricetogoaboveema
EmaIsBroken=(ta.ema(src,WaitForEmaBreakLen)<close)ornotenableWaitForEmaBreak
/////////////checkifpricebouncedbeforethealert
priceBounced=priceBounceNeeded<(ta.highest(high,1)-ta.lowest(low,priceBounceNeededLbL))ornotenablepriceBounceNeeded
delaysEnabled=enablepriceBounceNeededorenableOscCrossorenableWaitForEmaBreak
DelayState=oscCrossandEmaIsBrokenandpriceBounced
//dirtyworkaroundtodontreprintthefinalhiddenbullalert
HiddenBullAndBounce0=DelayStateand(ta.barssince(combihiddenBullCond)==0)
HiddenBullAndBounce1=DelayStateand(ta.barssince(combihiddenBullCond)==1)andnot(ta.barssince(HiddenBullAndBounce0)<1)
HiddenBullAndBounce2=DelayStateand(ta.barssince(combihiddenBullCond)==2)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0)<2)
HiddenBullAndBounce3=DelayStateand(ta.barssince(combihiddenBullCond)==3)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2)<3)
HiddenBullAndBounce4=DelayStateand(ta.barssince(combihiddenBullCond)==4)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3)<5)
HiddenBullAndBounce5=DelayStateand(ta.barssince(combihiddenBullCond)==5)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4)<6)
HiddenBullAndBounce6=DelayStateand(ta.barssince(combihiddenBullCond)==6)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4orHiddenBullAndBounce5)<7)
HiddenBullAndBounce7=DelayStateand(ta.barssince(combihiddenBullCond)==7)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4orHiddenBullAndBounce5orHiddenBullAndBounce6)<8)
HiddenBullAndBounce8=DelayStateand(ta.barssince(combihiddenBullCond)==8)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4orHiddenBullAndBounce5orHiddenBullAndBounce6orHiddenBullAndBounce7)<9)
HiddenBullAndBounce9=DelayStateand(ta.barssince(combihiddenBullCond)==9)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4orHiddenBullAndBounce5orHiddenBullAndBounce6orHiddenBullAndBounce7orHiddenBullAndBounce8)<10)
HiddenBullAndBounce10=DelayStateand(ta.barssince(combihiddenBullCond)==10)andnot(ta.barssince(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4orHiddenBullAndBounce5orHiddenBullAndBounce6orHiddenBullAndBounce7orHiddenBullAndBounce8orHiddenBullAndBounce9)<11)
FinalHiddenBullDelayAlert=delaysEnabledand(HiddenBullAndBounce1orHiddenBullAndBounce0orHiddenBullAndBounce2orHiddenBullAndBounce3orHiddenBullAndBounce4orHiddenBullAndBounce5orHiddenBullAndBounce6orHiddenBullAndBounce7orHiddenBullAndBounce8orHiddenBullAndBounce9orHiddenBullAndBounce10)
FinalHiddenBullAlert=false
FinalHiddenBullAlert2=false
ifdelaysEnabled
FinalHiddenBullAlert:=FinalHiddenBullDelayAlert
FinalHiddenBullAlert2:=false
ifnotdelaysEnabled
FinalHiddenBullAlert:=false
FinalHiddenBullAlert2:=combihiddenBullCond
//dirtyworkaroundtodontreprintthefinalbullalert
BullAndBounce0=DelayStateand(ta.barssince(combibullCond)==0)
BullAndBounce1=DelayStateand(ta.barssince(combibullCond)==1)andnot(ta.barssince(BullAndBounce0)<2)
BullAndBounce2=DelayStateand(ta.barssince(combibullCond)==2)andnot(ta.barssince(BullAndBounce1orBullAndBounce0)<3)
BullAndBounce3=DelayStateand(ta.barssince(combibullCond)==3)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2)<4)
BullAndBounce4=DelayStateand(ta.barssince(combibullCond)==4)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3)<5)
BullAndBounce5=DelayStateand(ta.barssince(combibullCond)==5)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4)<6)
BullAndBounce6=DelayStateand(ta.barssince(combibullCond)==6)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4orBullAndBounce5)<7)
BullAndBounce7=DelayStateand(ta.barssince(combibullCond)==7)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4orBullAndBounce5orBullAndBounce6)<8)
BullAndBounce8=DelayStateand(ta.barssince(combibullCond)==8)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4orBullAndBounce5orBullAndBounce6orBullAndBounce7)<9)
BullAndBounce9=DelayStateand(ta.barssince(combibullCond)==9)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4orBullAndBounce5orBullAndBounce6orBullAndBounce7orBullAndBounce8)<10)
BullAndBounce10=DelayStateand(ta.barssince(combibullCond)==10)andnot(ta.barssince(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4orBullAndBounce5orBullAndBounce6orBullAndBounce7orBullAndBounce8orBullAndBounce9)<11)
FinalBullDelayAlert=delaysEnabledand(BullAndBounce1orBullAndBounce0orBullAndBounce2orBullAndBounce3orBullAndBounce4orBullAndBounce5orBullAndBounce6orBullAndBounce7orBullAndBounce8orBullAndBounce9orBullAndBounce10)
FinalBullAlert=false
FinalBullAlert2=false
ifdelaysEnabled
FinalBullAlert:=FinalBullDelayAlert
FinalBullAlert2:=false
ifnotdelaysEnabled
FinalBullAlert:=false
FinalBullAlert2:=combibullCond
/////////////checkifpricebouncedbeforethealertEND
//plotdelaybuy
plotshape(FinalBullAlert?osc:na,offset=0,title='Buy',text="buy",style=shape.labelup,location=location.absolute,color=color.lime,textcolor=textColor)
//////////////////StopLoss
//Stoploss
enableSL=input.bool(true,title='enableStopLoss',group='══════════StopLossSettings══════════')
whichSL=input.string(defval='usethelowasSL',title='SLbasedonstatic%orbasedonthelow',options=['usethelowasSL','usethestatic%asSL'],group='══════════StopLossSettings══════════')
whichOffset=input.string(defval='use%asoffset',title='chooseoffsetfromthelow',options=['use$asoffset','use%asoffset'],group='StopLossatthelow')
lowPBuffer=input.float(0.35,title='SLOffsetfromtheLowin%',group='StopLossatthelow')/100
lowDBuffer=input.float(100,title='SLOffsetfromtheLowin$',group='StopLossatthelow')
SlLowLookback=input.int(title='SLlookbackforLow',defval=5,minval=1,maxval=50,group='StopLossatthelow')
longSlLow=float(na)
ifwhichOffset=="use%asoffset"andwhichSL=="usethelowasSL"andenableSL
longSlLow:=ta.lowest(low,SlLowLookback)*(1-lowPBuffer)
ifwhichOffset=="use$asoffset"andwhichSL=="usethelowasSL"andenableSL
longSlLow:=ta.lowest(low,SlLowLookback)-lowDBuffer
//plot(longSlLow,title="stoploss",color=color.new(#00bcd4,0))
//longsettings-🔥uncommentthe6linesbelowtodisablethealertsandenablethebacktester
longStopLoss=input.float(0.5,title='StopLossin%',group='static%StopLoss',inline='Input1')/100
///////Takeprofit
longTakeProfit1=input.float(2,title='TakeProfitin%',group='TakeProfit',inline='Input1')/100
//longTakeProfit2=input.float(2,title='25%TakeProfitin%',group='TakeProfit',inline='Input1')/100
//longTakeProfit3=input.float(2,title='25%TakeProfitin%',group='TakeProfit',inline='Input1')/100
//longTakeProfit4=input.float(2,title='25%TakeProfitin%',group='TakeProfit',inline='Input1')/100
//////////////////SLTPEND
///////////////////alerts
///////////////verfinalalertvariable
veryFinalAlert=FinalHiddenBullAlert2orFinalHiddenBullAlertorFinalBullAlertorFinalBullAlert2
///////////////////alerts
selectalertFreq=input.string(defval='onceperbarclose',title='AlertOptions',options=['onceperbar','onceperbarclose','all'],group='═══════════alertsettings═══════════')
BuyAlertMessage=input.string(defval="BullishDivergencedetected,putyourSL@",title='BuyAlertMessage',group='═══════════alertsettings═══════════')
enableSlMessage=input.bool(true,title='enableStopLossValueattheendof"buyAlertmessage"',group='═══════════alertsettings═══════════')
AfterSLMessage=input.string(defval="",title='BuyAlertmessageafterSLValue',group='═══════════alertsettings═══════════')
alertFreq=selectalertFreq=="onceperbar"?alert.freq_once_per_bar:selectalertFreq=="onceperbarclose"?alert.freq_once_per_bar_close:selectalertFreq=="all"?alert.freq_all:na
ifnotenableSlMessageandveryFinalAlert
alert(str.tostring(BuyAlertMessage),alertFreq)
ifenableSlMessageandveryFinalAlert
alert(str.tostring(BuyAlertMessage)+str.tostring(longSlLow)+str.tostring(AfterSLMessage),alertFreq)
ifenableSlMessage
alert(str.tostring(BuyAlertMessage)+str.tostring(longSlLow)+str.tostring(AfterSLMessage),alertFreq)
alertcondition(veryFinalAlert,title='Bullishdivergence',message='BullDiv{{ticker}}')
//////////////////Backtester
//////////////////Backtesterinputstuff
//BacktestingRangesettings-🔥uncommentthe6linesbelowtodisablethealertsandenablethebacktester
//startDate=input.int(title='StartDate',defval=1,minval=1,maxval=31,group='Backtestingrange')
//startMonth=input.int(title='StartMonth',defval=1,minval=1,maxval=12,group='Backtestingrange')
//startYear=input.int(title='StartYear',defval=2016,minval=1800,maxval=2100,group='Backtestingrange')
//endDate=input.int(title='EndDate',defval=1,minval=1,maxval=31,group='Backtestingrange')
//endMonth=input.int(title='EndMonth',defval=1,minval=1,maxval=12,group='Backtestingrange')
//endYear=input.int(title='EndYear',defval=2040,minval=1800,maxval=2100,group='Backtestingrange')

//////////////////Backtester
//🔥uncommentthealllinesbelowforthebacktesterandrevertforalerts
shortTrading=false
longTrading=plotBullorplotHiddenBull
longTP1=strategy.position_size>0?strategy.position_avg_price*(1+longTakeProfit1):strategy.position_size<0?strategy.position_avg_price*(1-longTakeProfit1):na
//longTP2=strategy.position_size>0?strategy.position_avg_price*(1+longTakeProfit2):strategy.position_size<0?strategy.position_avg_price*(1-longTakeProfit2):na
//longTP3=strategy.position_size>0?strategy.position_avg_price*(1+longTakeProfit3):strategy.position_size<0?strategy.position_avg_price*(1-longTakeProfit3):na
//longTP4=strategy.position_size>0?strategy.position_avg_price*(1+longTakeProfit4):strategy.position_size<0?strategy.position_avg_price*(1-longTakeProfit4):na
longSL=strategy.position_size>0?strategy.position_avg_price*(1-longStopLoss):strategy.position_size<0?strategy.position_avg_price*(1+longStopLoss):na
strategy.risk.allow_entry_in(longTrading==trueandshortTrading==true?strategy.direction.all:longTrading==true?strategy.direction.long:shortTrading==true?strategy.direction.short:na)
strategy.entry('Bull',strategy.long,comment='BLong',when=FinalBullAlertorFinalBullAlert2)
strategy.entry('Bull',strategy.long,comment='HBLong',when=FinalHiddenBullAlert2orFinalHiddenBullAlert)
//checkwhichSLtouse
ifenableSLandwhichSL=='usethestatic%asSL'
strategy.exit(id='longTP-SL',from_entry='Bull',limit=longTP1,stop=longSL)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP2,stop=longSlLow)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP3,stop=longSlLow)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP4,stop=longSlLow)
//getbarssincelastentryfortheSLatlowtowork
barsSinceLastEntry()=>
strategy.opentrades>0?(bar_index-strategy.opentrades.entry_bar_index(strategy.opentrades-1)):na

ifenableSLandwhichSL=='usethelowasSL'andta.barssince(veryFinalAlert)<2andbarsSinceLastEntry()<2
strategy.exit(id='longTP-SL',from_entry='Bull',limit=longTP1,stop=longSlLow)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP2,stop=longSlLow)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP3,stop=longSlLow)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP4,stop=longSlLow)
ifnotenableSL
strategy.exit(id='longTP-SL',from_entry='Bull',limit=longTP1)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP2)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP3)
//strategy.exit(id='longTP-SL',qty_percent=25,from_entry='Bull',limit=longTP4)
Expand (1778 lines)
